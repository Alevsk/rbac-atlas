---
id: 1014
title: "Node proxy access (Kubelet API)"
description: "Provides direct access to the Kubelet API on any node in the cluster. This is equivalent to cluster admin access, allowing an attacker to run commands on nodes, access pod logs, execute commands in containers, and retrieve sensitive information directly from the nodes, leading to full cluster compromise."
category: Elevation of Privilege
risk_level: RiskLevelCritical
date: ""
---

## Overview

| Field                   | Value                                                                                                                                                    |
| ----------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ID                      | 1014                                                                                                                                                     |
| Name                    | Node proxy access (Kubelet API)                                                                                                                          |
| Risk Category           | Elevation of Privilege                                                                                                                                   |
| Risk Level              | {{< risk Critical >}}                                                                                                                                    |
| Role Type               | ClusterRole                                                                                                                                              |
| API Groups              | core                                                                                                                                                     |
| Resources               | nodes/proxy                                                                                                                                              |
| Risky Verb Combinations | [get] 路 [create] 路 [update] 路 [patch] 路 [delete]                                                                                                         |
| Tags                    | {{< tag "ClusterAdminAccess" >}} {{< tag "CodeExecution" >}} {{< tag "DataExposure" >}} {{< tag "LateralMovement" >}} {{< tag "NodeAccess" >}} (+1 more) |

## Description

Provides direct access to the Kubelet API on any node in the cluster. This is equivalent to cluster admin access, allowing an attacker to run commands on nodes, access pod logs, execute commands in containers, and retrieve sensitive information directly from the nodes, leading to full cluster compromise.

## Abuse Scenarios

1. Access Kubelet healthz endpoint on a node via proxy.

```bash
kubectl proxy &
curl -s http://localhost:8001/api/v1/nodes/<node-name>/proxy/healthz
# Example: curl -s http://localhost:8001/api/v1/nodes/minikube/proxy/healthz

```

2. List all pods running on a specific node via Kubelet API.

```bash
kubectl proxy &
curl -s http://localhost:8001/api/v1/nodes/<node-name>/proxy/pods/
# Example: curl -s http://localhost:8001/api/v1/nodes/minikube/proxy/pods/

```

3. Retrieve logs from a specific container on a node via Kubelet API.

```bash
kubectl proxy &
curl -s http://localhost:8001/api/v1/nodes/<node-name>/proxy/containerLogs/<namespace>/<pod-name>/<container-name>
# Example: curl -s http://localhost:8001/api/v1/nodes/minikube/proxy/containerLogs/kube-system/coredns-xxxx-yyyy/coredns

```
