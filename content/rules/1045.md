---
id: 1045
title: "Manage CustomResourceDefinitions"
description: "Permits creating, updating, or deleting CustomResourceDefinitions (CRDs). CRDs extend the Kubernetes API. Modifying CRDs can lead to tampering with custom controllers, potentially causing unexpected behavior, privilege escalation if controllers manage sensitive resources, or denial of service."
category: Tampering
risk_level: RiskLevelCritical
date: ""
---

## Overview

| Field         | Value                                                                                            |
| ------------- | ------------------------------------------------------------------------------------------------ |
| ID            | 1045                                                                                             |
| Name          | Manage CustomResourceDefinitions                                                                 |
| Risk Category | Tampering                                                                                        |
| Risk Level    | {{< risk Critical >}}                                                                            |
| Role Type     | ClusterRole                                                                                      |
| API Groups    | apiextensions.k8s.io                                                                             |
| Resources     | customresourcedefinitions                                                                        |
| Verbs         | create, update, patch, delete                                                                    |
| Tags          | {{< tag "CRDManipulation" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}} |

## Description

Permits creating, updating, or deleting CustomResourceDefinitions (CRDs). CRDs extend the Kubernetes API. Modifying CRDs can lead to tampering with custom controllers, potentially causing unexpected behavior, privilege escalation if controllers manage sensitive resources, or denial of service.

## Abuse Scenarios

1. Create a new CustomResourceDefinition for a malicious custom resource.

```bash {copy=true}
kubectl create -f - <<EOF
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: maliciousconfigs.attacker.com
spec:
  group: attacker.com
  versions:
    - name: v1
      served: true
      storage: true
      schema:
        openAPIV3Schema:
          type: object
          properties:
            spec:
              type: object
              x-kubernetes-preserve-unknown-fields: true
  scope: Namespaced
  names:
    plural: maliciousconfigs
    singular: maliciousconfig
    kind: MaliciousConfig
    shortNames: ["mc"]
EOF
# Example: kubectl create -f - <<EOF ... EOF

```

2. Delete an existing CustomResourceDefinition, disrupting custom controllers.

```bash {copy=true}
kubectl delete crd <crd-name>
# Example: kubectl delete crd applications.argoproj.io

```
