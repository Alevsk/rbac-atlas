---
id: 1066
title: "Impersonate users, groups, or service accounts (cluster-wide)"
description: "Allows impersonating any user, group, or service account across the entire cluster via impersonation headers. This can be used to escalate privileges to the level of the impersonated identity, potentially gaining cluster-admin access."
category: Elevation of Privilege
risk_level: RiskLevelCritical
date: ""
---

## Overview

| Field         | Value                                                                                                                 |
| ------------- | --------------------------------------------------------------------------------------------------------------------- |
| ID            | 1066                                                                                                                  |
| Name          | Impersonate users, groups, or service accounts (cluster-wide)                                                         |
| Risk Category | Elevation of Privilege                                                                                                |
| Risk Level    | {{< risk Critical >}}                                                                                                 |
| Role Type     | ClusterRole                                                                                                           |
| API Groups    | core                                                                                                                  |
| Resources     | users, groups, serviceaccounts, userextras, uids                                                                      |
| Verbs         | impersonate                                                                                                           |
| Tags          | {{< tag "ClusterAdminAccess" >}} {{< tag "Impersonation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Spoofing" >}} |

## Description

Allows impersonating any user, group, or service account across the entire cluster via impersonation headers. This can be used to escalate privileges to the level of the impersonated identity, potentially gaining cluster-admin access.

## Abuse Scenarios

1. Impersonate a service account to list secrets in kube-system.

```bash
kubectl get secrets -n kube-system --as=system:serviceaccount:kube-system:default
# Example: kubectl get secrets -n kube-system --as=system:serviceaccount:kube-system:kube-controller-manager

```

2. Impersonate a user in the 'system:masters' group to gain cluster-admin.

```bash
kubectl get nodes --as=admin --as-group=system:masters
# Example: kubectl get nodes --as=pwned-admin --as-group=system:masters

```
