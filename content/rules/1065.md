---
id: 1065
title: "Manage ETCDSnapshotFiles (k3s.cattle.io)"
description: "Grants access to manage ETCD snapshot files, typically in a K3s environment. ETCD snapshots contain the entire state of the Kubernetes cluster, including all secrets, configurations, and resource definitions. Access allows complete data exposure, credential harvesting, and potentially restoring a compromised state or tampering with backups."
category: Information Disclosure
risk_level: RiskLevelCritical
date: ""
---

## Overview

| Field                   | Value                                                                                                                                         |
| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| ID                      | 1065                                                                                                                                          |
| Name                    | Manage ETCDSnapshotFiles (k3s.cattle.io)                                                                                                      |
| Risk Category           | Information Disclosure                                                                                                                        |
| Risk Level              | {{< risk Critical >}}                                                                                                                         |
| Role Type               | ClusterRole                                                                                                                                   |
| API Groups              | k3s.cattle.io                                                                                                                                 |
| Resources               | etcdsnapshotfiles                                                                                                                             |
| Risky Verb Combinations | [get] 路 [list] 路 [create] 路 [update] 路 [delete]                                                                                               |
| Tags                    | {{< tag "BackupAccess" >}} {{< tag "ClusterAdminAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "Tampering" >}} |

## Description

Grants access to manage ETCD snapshot files, typically in a K3s environment. ETCD snapshots contain the entire state of the Kubernetes cluster, including all secrets, configurations, and resource definitions. Access allows complete data exposure, credential harvesting, and potentially restoring a compromised state or tampering with backups.

## Abuse Scenarios

1. List all ETCD snapshot files.

```bash
kubectl get etcdsnapshotfiles

```

2. Delete an ETCD snapshot file, potentially hindering recovery or causing data loss.

```bash
kubectl delete etcdsnapshotfile <snapshot-file-name>
# Example: kubectl delete etcdsnapshotfile etcd-snapshot-12345

```
