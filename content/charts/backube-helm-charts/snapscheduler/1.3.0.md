---
title: "snapscheduler"
description: "An operator to take scheduled snapshots of Kubernetes persistent volumes"
version: v1.3.0
version_order: f0001f0003f0000
date: ""
service_accounts: 1
workloads: 1
bindings: 9
critical_findings: 0
high_findings: 1
medium_findings: 2
low_findings: 6
categories: [csi, scheduler, snapshot, storage]
tags:
  [
    ConfigMapAccess,
    CredentialAccess,
    DataExposure,
    InformationDisclosure,
    PotentialPrivilegeEscalation,
    RBACQuery,
    Tampering,
    letter-S,
  ]
---

## Description

An operator to take scheduled snapshots of Kubernetes persistent volumes

- https://github.com/backube/snapscheduler

## Overview

| Identity                             | Namespace | Automount | Secrets | Permissions | Workloads | Risk                |
| ------------------------------------ | --------- | --------- | ------- | ----------- | --------- | ------------------- |
| [`snapscheduler`](#sa-snapscheduler) | default   | âŒ        | â€”       | 9           | 1         | {{< risk "High" >}} |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### ğŸ¤– `snapscheduler` {#sa-snapscheduler}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (9)

| Role                              | Resource                                       | Verbs                                                 | Risk                | Tags                                                                                                                                                            |
| --------------------------------- | ---------------------------------------------- | ----------------------------------------------------- | ------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Role `snapscheduler-leader`       | core/configmaps                                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}   | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}} |
| ClusterRole `snapscheduler-proxy` | authorization.k8s.io/subjectaccessreviews      | create                                                | {{< risk Medium >}} | {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                                                                     |
| ClusterRole `snapscheduler-proxy` | authentication.k8s.io/tokenreviews             | create                                                | {{< risk Medium >}} | {{< tag "CredentialAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                                      |
| Role `snapscheduler-leader`       | core/configmaps/status                         | get Â· patch Â· update                                  | {{< risk Low >}}    |                                                                                                                                                                 |
| Role `snapscheduler-leader`       | core/events                                    | create Â· patch                                        | {{< risk Low >}}    |                                                                                                                                                                 |
| ClusterRole `snapscheduler`       | core/persistentvolumeclaims                    | get Â· list Â· watch                                    | {{< risk Low >}}    |                                                                                                                                                                 |
| ClusterRole `snapscheduler`       | snapscheduler.backube/snapshotschedules        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}    |                                                                                                                                                                 |
| ClusterRole `snapscheduler`       | snapscheduler.backube/snapshotschedules/status | get Â· patch Â· update                                  | {{< risk Low >}}    |                                                                                                                                                                 |
| ClusterRole `snapscheduler`       | snapshot.storage.k8s.io/volumesnapshots        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}    |                                                                                                                                                                 |

#### âš ï¸ Potential Abuse (5)

The following security risks were found based on the above permissions:

- [Read ConfigMaps in a namespace](/rules/1023)
- [Modify ConfigMaps in a namespace](/rules/1025)
- [Create TokenReviews (validate arbitrary tokens)](/rules/1049)
- [Create SubjectAccessReviews (check arbitrary permissions)](/rules/1050)

#### ğŸ“¦ Workloads (1)

| Kind       | Name          | Container     | Image                               |
| ---------- | ------------- | ------------- | ----------------------------------- |
| Deployment | snapscheduler | snapscheduler | quay.io/backube/snapscheduler:1.2.0 |

---
