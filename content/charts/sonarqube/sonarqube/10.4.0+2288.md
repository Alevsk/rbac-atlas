---
title: "sonarqube"
description: "SonarQube is a self-managed, automatic code review tool that systematically helps you deliver clean code. As a core element of our Sonar solution, SonarQube integrates into your existing workflow and detects issues in your code to help you perform continuous code inspections of your projects. The tool analyses 30+ different programming languages and integrates into your CI pipeline and DevOps platform to ensure that your code meets high-quality standards."
version: v10.4.0+2288
version_order: f0000f0000f0000
date: ""
service_accounts: 2
workloads: 4
bindings: 28
critical_findings: 2
high_findings: 1
medium_findings: 1
low_findings: 24
categories: [coverage, security, code, quality]
tags:
  [
    ClusterStructure,
    ClusterWideSecretAccess,
    ConfigMapAccess,
    CredentialAccess,
    DataExposure,
    InformationDisclosure,
    Reconnaissance,
    ResourceNameRestricted,
    SecretAccess,
    letter-S,
  ]
---

## Description

SonarQube is a self-managed, automatic code review tool that systematically helps you deliver clean code. As a core element of our Sonar solution, SonarQube integrates into your existing workflow and detects issues in your code to help you perform continuous code inspections of your projects. The tool analyses 30+ different programming languages and integrates into your CI pipeline and DevOps platform to ensure that your code meets high-quality standards.

- https://github.com/SonarSource/helm-chart-sonarqube
- https://github.com/SonarSource/docker-sonarqube
- https://github.com/SonarSource/sonarqube

## Overview

| Identity                                                                     | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| ---------------------------------------------------------------------------- | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`sonarqube-ingress-nginx`](#sa-sonarqube-ingress-nginx)                     | default   | âœ…        | â€”       | 26          | 1         | {{< risk "Critical" >}} |
| [`sonarqube-ingress-nginx-admission`](#sa-sonarqube-ingress-nginx-admission) | default   | âŒ        | â€”       | 2           | 2         | {{< risk "Low" >}}      |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### ğŸ¤– `sonarqube-ingress-nginx` {#sa-sonarqube-ingress-nginx}

**Namespace:** `default` Â |Â  **Automount:** âœ…

#### ğŸ”‘ Permissions (26)

| Role                                  | Resource                                                                       | Verbs              | Risk                  | Tags                                                                                                                                                           |
| ------------------------------------- | ------------------------------------------------------------------------------ | ------------------ | --------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `sonarqube-ingress-nginx` | core/secrets                                                                   | list Â· watch       | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}} |
| Role `sonarqube-ingress-nginx`        | core/secrets                                                                   | get Â· list Â· watch | {{< risk Critical >}} | {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}}                                       |
| ClusterRole `sonarqube-ingress-nginx` | core/configmaps                                                                | list Â· watch       | {{< risk High >}}     | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}}                                                                   |
| Role `sonarqube-ingress-nginx`        | core/configmaps                                                                | get Â· list Â· watch | {{< risk Medium >}}   | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}}                                                                   |
| ClusterRole `sonarqube-ingress-nginx` | core/endpoints                                                                 | list Â· watch       | {{< risk Low >}}      |                                                                                                                                                                |
| Role `sonarqube-ingress-nginx`        | core/endpoints                                                                 | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `sonarqube-ingress-nginx` | discovery.k8s.io/endpointslices                                                | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| Role `sonarqube-ingress-nginx`        | discovery.k8s.io/endpointslices                                                | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `sonarqube-ingress-nginx` | core/events                                                                    | create Â· patch     | {{< risk Low >}}      |                                                                                                                                                                |
| Role `sonarqube-ingress-nginx`        | core/events                                                                    | create Â· patch     | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `sonarqube-ingress-nginx` | networking.k8s.io/ingressclasses                                               | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| Role `sonarqube-ingress-nginx`        | networking.k8s.io/ingressclasses                                               | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `sonarqube-ingress-nginx` | networking.k8s.io/ingresses                                                    | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| Role `sonarqube-ingress-nginx`        | networking.k8s.io/ingresses                                                    | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `sonarqube-ingress-nginx` | networking.k8s.io/ingresses/status                                             | update             | {{< risk Low >}}      |                                                                                                                                                                |
| Role `sonarqube-ingress-nginx`        | networking.k8s.io/ingresses/status                                             | update             | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `sonarqube-ingress-nginx` | coordination.k8s.io/leases                                                     | list Â· watch       | {{< risk Low >}}      |                                                                                                                                                                |
| Role `sonarqube-ingress-nginx`        | coordination.k8s.io/leases                                                     | create             | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `sonarqube-ingress-nginx` | core/namespaces                                                                | list Â· watch       | {{< risk Low >}}      | {{< tag "ClusterStructure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}}                                                                |
| Role `sonarqube-ingress-nginx`        | core/namespaces                                                                | get                | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `sonarqube-ingress-nginx` | core/nodes                                                                     | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `sonarqube-ingress-nginx` | core/pods                                                                      | list Â· watch       | {{< risk Low >}}      |                                                                                                                                                                |
| Role `sonarqube-ingress-nginx`        | core/pods                                                                      | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `sonarqube-ingress-nginx` | core/services                                                                  | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| Role `sonarqube-ingress-nginx`        | core/services                                                                  | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| Role `sonarqube-ingress-nginx`        | coordination.k8s.io/leases **(restricted to: sonarqube-ingress-nginx-leader)** | get Â· update       | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                           |

#### âš ï¸ Potential Abuse (6)

The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)

#### ğŸ“¦ Workloads (1)

| Kind       | Name                               | Container  | Image                                                                                                                   |
| ---------- | ---------------------------------- | ---------- | ----------------------------------------------------------------------------------------------------------------------- |
| Deployment | sonarqube-ingress-nginx-controller | controller | registry.k8s.io/ingress-nginx/controller:v1.9.4@sha256:5b161f051d017e55d358435f295f5e9a297e66158f136321d9b04520ec6c48a3 |

---

### ğŸ¤– `sonarqube-ingress-nginx-admission` {#sa-sonarqube-ingress-nginx-admission}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (2)

| Role                                            | Resource                                                     | Verbs        | Risk             | Tags |
| ----------------------------------------------- | ------------------------------------------------------------ | ------------ | ---------------- | ---- |
| Role `sonarqube-ingress-nginx-admission`        | core/secrets                                                 | create Â· get | {{< risk Low >}} |      |
| ClusterRole `sonarqube-ingress-nginx-admission` | admissionregistration.k8s.io/validatingwebhookconfigurations | get Â· update | {{< risk Low >}} |      |

#### âš ï¸ Potential Abuse (1)

The following security risks were found based on the above permissions:

#### ğŸ“¦ Workloads (2)

| Kind | Name                                     | Container | Image                                                                                                                                          |
| ---- | ---------------------------------------- | --------- | ---------------------------------------------------------------------------------------------------------------------------------------------- |
| Job  | sonarqube-ingress-nginx-admission-create | create    | registry.k8s.io/ingress-nginx/kube-webhook-certgen:v20231011-8b53cabe0@sha256:a7943503b45d552785aa3b5e457f169a5661fb94d82b8a3373bcd9ebaf9aac80 |
| Job  | sonarqube-ingress-nginx-admission-patch  | patch     | registry.k8s.io/ingress-nginx/kube-webhook-certgen:v20231011-8b53cabe0@sha256:a7943503b45d552785aa3b5e457f169a5661fb94d82b8a3373bcd9ebaf9aac80 |

---
