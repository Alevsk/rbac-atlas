---
title: kube-prometheus-stack
description: 72.9.1
date: 2025-06-03 06:41:53
categories: [operator, prometheus, kube-prometheus]
tags: [ClusterStructure, ClusterWideSecretAccess, ConfigMapAccess, CredentialAccess, DataExposure, InformationDisclosure, Persistence, PotentialPrivilegeEscalation, PrivilegeEscalation, Reconnaissance, Tampering, WorkloadLifecycle]
---

## Overview

|ServiceAccount|Namespace|Automount|Secrets|Permissions|Workloads|
|---|---|---|---|---|---|
|[`kube-prometheus-stack-grafana-test`](#sa-kube-prometheus-stack-grafana-test)|default|❌|—|0|1|
|[`kube-prometheus-stack-kube-state-metrics`](#sa-kube-prometheus-stack-kube-state-metrics)|default|✅|—|32|1|
|[`kube-prometheus-stack-prometheus-windows-exporter`](#sa-kube-prometheus-stack-prometheus-windows-exporter)|default|❌|—|0|1|
|[`kube-prometheus-stack-prometheus`](#sa-kube-prometheus-stack-prometheus)|default|✅|—|7|0|
|[`kube-prometheus-stack-alertmanager`](#sa-kube-prometheus-stack-alertmanager)|default|✅|—|0|0|
|[`kube-prometheus-stack-prometheus-node-exporter`](#sa-kube-prometheus-stack-prometheus-node-exporter)|default|❌|—|0|1|
|[`kube-prometheus-stack-admission`](#sa-kube-prometheus-stack-admission)|default|✅|—|3|2|
|[`kube-prometheus-stack-operator`](#sa-kube-prometheus-stack-operator)|default|✅|—|30|1|
|[`kube-prometheus-stack-grafana`](#sa-kube-prometheus-stack-grafana)|default|✅|—|2|3|


> *Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount.*

---

## Identities

### `kube-prometheus-stack-operator` {#sa-kube-prometheus-stack-operator}
**Namespace:** `default` &nbsp;|&nbsp; **Automount:** ✅

#### Permissions (30)
|Role|Resource|Verbs|Risk|
|---|---|---|---|
|ClusterRole `kube-prometheus-stack-operator`|apps/statefulsets|*|Critical|
|ClusterRole `kube-prometheus-stack-operator`|core/secrets|*|Critical|
|ClusterRole `kube-prometheus-stack-operator`|core/configmaps|*|Critical|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/probes|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/thanosrulers/status|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/alertmanagers|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/alertmanagers/finalizers|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/alertmanagers/status|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/alertmanagerconfigs|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/prometheuses/status|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/prometheusagents|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/prometheusagents/status|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/prometheuses/finalizers|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/prometheusagents/finalizers|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/thanosrulers/finalizers|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/servicemonitors|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/scrapeconfigs|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/thanosrulers|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/podmonitors|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/prometheusrules|*|High|
|ClusterRole `kube-prometheus-stack-operator`|monitoring.coreos.com/prometheuses|*|High|
|ClusterRole `kube-prometheus-stack-operator`|core/pods|delete · list|Low|
|ClusterRole `kube-prometheus-stack-operator`|core/services|create · delete · get · update|Low|
|ClusterRole `kube-prometheus-stack-operator`|core/endpoints|create · delete · get · update|Low|
|ClusterRole `kube-prometheus-stack-operator`|core/nodes|list · watch|Low|
|ClusterRole `kube-prometheus-stack-operator`|core/namespaces|get · list · watch|Low|
|ClusterRole `kube-prometheus-stack-operator`|core/events|create · patch|Low|
|ClusterRole `kube-prometheus-stack-operator`|core/services/finalizers|create · delete · get · update|Low|
|ClusterRole `kube-prometheus-stack-operator`|networking.k8s.io/ingresses|get · list · watch|Low|
|ClusterRole `kube-prometheus-stack-operator`|storage.k8s.io/storageclasses|get|Low|

#### Workloads (1)
|Kind|Name|Container|Image|
|---|---|---|---|
|Deployment|kube-prometheus-stack-operator|kube-prometheus-stack|quay.io/prometheus-operator/prometheus-operator:v0.82.2|

---

### `kube-prometheus-stack-grafana` {#sa-kube-prometheus-stack-grafana}
**Namespace:** `default` &nbsp;|&nbsp; **Automount:** ✅

#### Permissions (2)
|Role|Resource|Verbs|Risk|
|---|---|---|---|
|ClusterRole `kube-prometheus-stack-grafana-clusterrole`|core/secrets|get · list · watch|Critical|
|ClusterRole `kube-prometheus-stack-grafana-clusterrole`|core/configmaps|get · list · watch|High|

#### Workloads (3)
|Kind|Name|Container|Image|
|---|---|---|---|
|Deployment|kube-prometheus-stack-grafana|grafana-sc-dashboard|quay.io/kiwigrid/k8s-sidecar:1.30.0|
|Deployment|kube-prometheus-stack-grafana|grafana-sc-datasources|quay.io/kiwigrid/k8s-sidecar:1.30.0|
|Deployment|kube-prometheus-stack-grafana|grafana|docker.io/grafana/grafana:12.0.0-security-01|

---

### `kube-prometheus-stack-kube-state-metrics` {#sa-kube-prometheus-stack-kube-state-metrics}
**Namespace:** `default` &nbsp;|&nbsp; **Automount:** ✅

#### Permissions (32)
|Role|Resource|Verbs|Risk|
|---|---|---|---|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|certificates.k8s.io/certificatesigningrequests|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|core/persistentvolumeclaims|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|core/pods|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|core/replicationcontrollers|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|core/persistentvolumes|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|core/resourcequotas|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|core/secrets|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|core/services|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|core/configmaps|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|core/endpoints|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|core/limitranges|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|core/namespaces|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|core/nodes|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|batch/cronjobs|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|batch/jobs|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|networking.k8s.io/ingresses|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|networking.k8s.io/networkpolicies|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|policy/poddisruptionbudgets|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|storage.k8s.io/storageclasses|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|storage.k8s.io/volumeattachments|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|extensions/daemonsets|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|extensions/deployments|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|extensions/ingresses|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|extensions/replicasets|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|apps/daemonsets|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|apps/deployments|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|apps/replicasets|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|apps/statefulsets|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|autoscaling/horizontalpodautoscalers|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|coordination.k8s.io/leases|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|admissionregistration.k8s.io/mutatingwebhookconfigurations|list · watch|Low|
|ClusterRole `kube-prometheus-stack-kube-state-metrics`|admissionregistration.k8s.io/validatingwebhookconfigurations|list · watch|Low|

#### Workloads (1)
|Kind|Name|Container|Image|
|---|---|---|---|
|Deployment|kube-prometheus-stack-kube-state-metrics|kube-state-metrics|registry.k8s.io/kube-state-metrics/kube-state-metrics:v2.15.0|

---

### `kube-prometheus-stack-prometheus` {#sa-kube-prometheus-stack-prometheus}
**Namespace:** `default` &nbsp;|&nbsp; **Automount:** ✅

#### Permissions (7)
|Role|Resource|Verbs|Risk|
|---|---|---|---|
|ClusterRole `kube-prometheus-stack-prometheus`|networking.k8s.io/ingresses|get · list · watch|Low|
|ClusterRole `kube-prometheus-stack-prometheus`|core/services|get · list · watch|Low|
|ClusterRole `kube-prometheus-stack-prometheus`|core/endpoints|get · list · watch|Low|
|ClusterRole `kube-prometheus-stack-prometheus`|core/pods|get · list · watch|Low|
|ClusterRole `kube-prometheus-stack-prometheus`|core/nodes|get · list · watch|Low|
|ClusterRole `kube-prometheus-stack-prometheus`|core/nodes/metrics|get · list · watch|Low|
|ClusterRole `kube-prometheus-stack-prometheus`|discovery.k8s.io/endpointslices|get · list · watch|Low|

#### Workloads (0)
_No workloads use this ServiceAccount._

---

### `kube-prometheus-stack-admission` {#sa-kube-prometheus-stack-admission}
**Namespace:** `default` &nbsp;|&nbsp; **Automount:** ✅

#### Permissions (3)
|Role|Resource|Verbs|Risk|
|---|---|---|---|
|ClusterRole `kube-prometheus-stack-admission`|admissionregistration.k8s.io/validatingwebhookconfigurations|get · update|Low|
|ClusterRole `kube-prometheus-stack-admission`|admissionregistration.k8s.io/mutatingwebhookconfigurations|get · update|Low|
|Role `kube-prometheus-stack-admission`|core/secrets|create · get|Low|

#### Workloads (2)
|Kind|Name|Container|Image|
|---|---|---|---|
|Job|kube-prometheus-stack-admission-patch|patch|registry.k8s.io/ingress-nginx/kube-webhook-certgen:v1.5.3|
|Job|kube-prometheus-stack-admission-create|create|registry.k8s.io/ingress-nginx/kube-webhook-certgen:v1.5.3|

---

### `kube-prometheus-stack-alertmanager` {#sa-kube-prometheus-stack-alertmanager}
**Namespace:** `default` &nbsp;|&nbsp; **Automount:** ✅

#### Permissions (0)
_No explicit RBAC bindings._

#### Workloads (0)
_No workloads use this ServiceAccount._

---

### `kube-prometheus-stack-grafana-test` {#sa-kube-prometheus-stack-grafana-test}
**Namespace:** `default` &nbsp;|&nbsp; **Automount:** ❌

#### Permissions (0)
_No explicit RBAC bindings._

#### Workloads (1)
|Kind|Name|Container|Image|
|---|---|---|---|
|Pod|kube-prometheus-stack-grafana-test|kube-prometheus-stack-test|docker.io/bats/bats:v1.4.1|

---

### `kube-prometheus-stack-prometheus-node-exporter` {#sa-kube-prometheus-stack-prometheus-node-exporter}
**Namespace:** `default` &nbsp;|&nbsp; **Automount:** ❌

#### Permissions (0)
_No explicit RBAC bindings._

#### Workloads (1)
|Kind|Name|Container|Image|
|---|---|---|---|
|DaemonSet|kube-prometheus-stack-prometheus-node-exporter|node-exporter|quay.io/prometheus/node-exporter:v1.9.1|

---

### `kube-prometheus-stack-prometheus-windows-exporter` {#sa-kube-prometheus-stack-prometheus-windows-exporter}
**Namespace:** `default` &nbsp;|&nbsp; **Automount:** ❌

#### Permissions (0)
_No explicit RBAC bindings._

#### Workloads (1)
|Kind|Name|Container|Image|
|---|---|---|---|
|DaemonSet|kube-prometheus-stack-prometheus-windows-exporter|windows-exporter|ghcr.io/prometheus-community/windows-exporter:0.30.7|

---

