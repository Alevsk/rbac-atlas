---
title: "cilium"
description: "Helm chart for Cilium"
version: v1.6.9
version_order: f0001f0006f0009
date: ""
service_accounts: 4
workloads: 4
bindings: 51
critical_findings: 6
high_findings: 21
medium_findings: 1
low_findings: 23
categories: []
tags:
  [
    CRDManipulation,
    ClusterStructure,
    ClusterWideAccess,
    DenialOfService,
    InformationDisclosure,
    LateralMovement,
    ManInTheMiddle,
    NetworkManipulation,
    NodeAccess,
    OperationalData,
    Persistence,
    PotentialPrivilegeEscalation,
    PrivilegeEscalation,
    Reconnaissance,
    ServiceExposure,
    Tampering,
    TrafficRedirection,
    WildcardPermission,
    WorkloadExecution,
    WorkloadLifecycle,
    letter-C,
  ]
---

## Description

Helm chart for Cilium

- https://github.com/cilium/cilium

## Overview

| Identity                                           | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| -------------------------------------------------- | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`cilium`](#sa-cilium)                             | default   | âŒ        | â€”       | 17          | 3         | {{< risk "Critical" >}} |
| [`cilium-etcd-sa`](#sa-cilium-etcd-sa)             | default   | âŒ        | â€”       | 13          | 0         | {{< risk "Critical" >}} |
| [`cilium-operator`](#sa-cilium-operator)           | default   | âŒ        | â€”       | 13          | 1         | {{< risk "High" >}}     |
| [`cilium-etcd-operator`](#sa-cilium-etcd-operator) | default   | âŒ        | â€”       | 8           | 1         | {{< risk "Low" >}}      |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### ğŸ¤– `cilium` {#sa-cilium}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (17)

| Role                 | Resource                                       | Verbs                                | Risk                  | Tags                                                                                                                      |
| -------------------- | ---------------------------------------------- | ------------------------------------ | --------------------- | ------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `cilium` | core/nodes                                     | get Â· list Â· patch Â· update Â· watch  | {{< risk Critical >}} | {{< tag "DenialOfService" >}} {{< tag "NodeAccess" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}} |
| ClusterRole `cilium` | cilium.io/ciliumendpoints                      | \*                                   | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                          |
| ClusterRole `cilium` | cilium.io/ciliumendpoints/status               | \*                                   | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                          |
| ClusterRole `cilium` | cilium.io/ciliumidentities                     | \*                                   | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                          |
| ClusterRole `cilium` | cilium.io/ciliumidentities/status              | \*                                   | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                          |
| ClusterRole `cilium` | cilium.io/ciliumnetworkpolicies                | \*                                   | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                          |
| ClusterRole `cilium` | cilium.io/ciliumnetworkpolicies/status         | \*                                   | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                          |
| ClusterRole `cilium` | cilium.io/ciliumnodes                          | \*                                   | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                          |
| ClusterRole `cilium` | cilium.io/ciliumnodes/status                   | \*                                   | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                          |
| ClusterRole `cilium` | apiextensions.k8s.io/customresourcedefinitions | create Â· get Â· list Â· update Â· watch | {{< risk Low >}}      |                                                                                                                           |
| ClusterRole `cilium` | core/endpoints                                 | get Â· list Â· watch                   | {{< risk Low >}}      |                                                                                                                           |
| ClusterRole `cilium` | extensions/ingresses                           | create Â· get Â· list Â· watch          | {{< risk Low >}}      |                                                                                                                           |
| ClusterRole `cilium` | core/namespaces                                | get Â· list Â· watch                   | {{< risk Low >}}      | {{< tag "ClusterStructure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}}                           |
| ClusterRole `cilium` | networking.k8s.io/networkpolicies              | get Â· list Â· watch                   | {{< risk Low >}}      |                                                                                                                           |
| ClusterRole `cilium` | core/nodes/status                              | patch                                | {{< risk Low >}}      |                                                                                                                           |
| ClusterRole `cilium` | core/pods                                      | get Â· list Â· update Â· watch          | {{< risk Low >}}      |                                                                                                                           |
| ClusterRole `cilium` | core/services                                  | get Â· list Â· watch                   | {{< risk Low >}}      |                                                                                                                           |

#### âš ï¸ Potential Abuse (4)

The following security risks were found based on the above permissions:

- [Modify node configuration (labels, taints)](/rules/1015)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)

#### ğŸ“¦ Workloads (3)

| Kind       | Name                    | Container               | Image                          |
| ---------- | ----------------------- | ----------------------- | ------------------------------ |
| DaemonSet  | cilium                  | cilium-agent            | docker.io/cilium/cilium:v1.6.9 |
| DaemonSet  | cilium-pre-flight-check | cilium-pre-flight-check | docker.io/cilium/cilium:v1.6.9 |
| Deployment | cilium-pre-flight-check | cnp-validator           | docker.io/cilium/cilium:v1.6.9 |

---

### ğŸ¤– `cilium-etcd-sa` {#sa-cilium-etcd-sa}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (13)

| Role                        | Resource                                       | Verbs                                | Risk                  | Tags                                                                                                                                                                           |
| --------------------------- | ---------------------------------------------- | ------------------------------------ | --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| ClusterRole `etcd-operator` | apiextensions.k8s.io/customresourcedefinitions | \*                                   | {{< risk Critical >}} | {{< tag "CRDManipulation" >}} {{< tag "ClusterWideAccess" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WildcardPermission" >}}              |
| ClusterRole `etcd-operator` | apps/deployments                               | \*                                   | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} (+2 more)       |
| ClusterRole `etcd-operator` | core/endpoints                                 | \*                                   | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "DenialOfService" >}} {{< tag "ManInTheMiddle" >}} {{< tag "NetworkManipulation" >}} {{< tag "Tampering" >}} (+2 more)                 |
| ClusterRole `etcd-operator` | core/pods                                      | \*                                   | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "LateralMovement" >}} {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} (+3 more) |
| ClusterRole `etcd-operator` | core/services                                  | \*                                   | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "DenialOfService" >}} {{< tag "NetworkManipulation" >}} {{< tag "ServiceExposure" >}} {{< tag "Tampering" >}} (+1 more)                |
| ClusterRole `etcd-operator` | core/deployments                               | \*                                   | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                               |
| ClusterRole `etcd-operator` | etcd.database.coreos.com/etcdbackups           | \*                                   | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                               |
| ClusterRole `etcd-operator` | etcd.database.coreos.com/etcdclusters          | \*                                   | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                               |
| ClusterRole `etcd-operator` | etcd.database.coreos.com/etcdrestores          | \*                                   | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                               |
| ClusterRole `etcd-operator` | core/persistentvolumeclaims                    | \*                                   | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                               |
| ClusterRole `etcd-operator` | core/events                                    | \*                                   | {{< risk Medium >}}   | {{< tag "ClusterWideAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "OperationalData" >}} {{< tag "Reconnaissance" >}} {{< tag "WildcardPermission" >}}                |
| ClusterRole `etcd-operator` | extensions/deployments                         | create Â· get Â· list Â· patch Â· update | {{< risk Low >}}      |                                                                                                                                                                                |
| ClusterRole `etcd-operator` | core/secrets                                   | get                                  | {{< risk Low >}}      |                                                                                                                                                                                |

#### âš ï¸ Potential Abuse (14)

The following security risks were found based on the above permissions:

- [Create pods cluster-wide](/rules/1006)
- [Create pods in a namespace](/rules/1007)
- [Update/Patch pods cluster-wide](/rules/1008)
- [Update/Patch pods in a namespace](/rules/1009)
- [Manage Deployments cluster-wide (potential for privileged pod execution)](/rules/1033)
- [Manage Deployments in a namespace (potential for privileged pod execution)](/rules/1034)
- [Manage CustomResourceDefinitions](/rules/1045)
- [Read events cluster-wide](/rules/1070)
- [Manage Endpoints or EndpointSlices cluster-wide](/rules/1073)
- [Manage Endpoints or EndpointSlices in a namespace](/rules/1074)
- [Manage Services cluster-wide](/rules/1075)
- [Manage Services in a namespace](/rules/1076)

#### ğŸ“¦ Workloads (0)

_No workloads use this ServiceAccount._

---

### ğŸ¤– `cilium-operator` {#sa-cilium-operator}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (13)

| Role                          | Resource                               | Verbs                       | Risk              | Tags                                                                                            |
| ----------------------------- | -------------------------------------- | --------------------------- | ----------------- | ----------------------------------------------------------------------------------------------- |
| ClusterRole `cilium-operator` | cilium.io/ciliumendpoints              | \*                          | {{< risk High >}} | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                |
| ClusterRole `cilium-operator` | cilium.io/ciliumendpoints/status       | \*                          | {{< risk High >}} | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                |
| ClusterRole `cilium-operator` | cilium.io/ciliumidentities             | \*                          | {{< risk High >}} | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                |
| ClusterRole `cilium-operator` | cilium.io/ciliumidentities/status      | \*                          | {{< risk High >}} | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                |
| ClusterRole `cilium-operator` | cilium.io/ciliumnetworkpolicies        | \*                          | {{< risk High >}} | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                |
| ClusterRole `cilium-operator` | cilium.io/ciliumnetworkpolicies/status | \*                          | {{< risk High >}} | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                |
| ClusterRole `cilium-operator` | cilium.io/ciliumnodes                  | \*                          | {{< risk High >}} | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                |
| ClusterRole `cilium-operator` | cilium.io/ciliumnodes/status           | \*                          | {{< risk High >}} | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                |
| ClusterRole `cilium-operator` | core/endpoints                         | get Â· list Â· watch          | {{< risk Low >}}  |                                                                                                 |
| ClusterRole `cilium-operator` | core/namespaces                        | get Â· list Â· watch          | {{< risk Low >}}  | {{< tag "ClusterStructure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} |
| ClusterRole `cilium-operator` | core/nodes                             | get Â· list Â· watch          | {{< risk Low >}}  |                                                                                                 |
| ClusterRole `cilium-operator` | core/pods                              | delete Â· get Â· list Â· watch | {{< risk Low >}}  |                                                                                                 |
| ClusterRole `cilium-operator` | core/services                          | get Â· list Â· watch          | {{< risk Low >}}  |                                                                                                 |

#### âš ï¸ Potential Abuse (3)

The following security risks were found based on the above permissions:

- [List Namespaces (Cluster Reconnaissance)](/rules/1082)

#### ğŸ“¦ Workloads (1)

| Kind       | Name            | Container       | Image                            |
| ---------- | --------------- | --------------- | -------------------------------- |
| Deployment | cilium-operator | cilium-operator | docker.io/cilium/operator:v1.6.9 |

---

### ğŸ¤– `cilium-etcd-operator` {#sa-cilium-etcd-operator}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (8)

| Role                               | Resource                                       | Verbs                          | Risk             | Tags |
| ---------------------------------- | ---------------------------------------------- | ------------------------------ | ---------------- | ---- |
| ClusterRole `cilium-etcd-operator` | core/componentstatuses                         | get                            | {{< risk Low >}} |      |
| ClusterRole `cilium-etcd-operator` | apiextensions.k8s.io/customresourcedefinitions | create Â· delete Â· get          | {{< risk Low >}} |      |
| ClusterRole `cilium-etcd-operator` | apps/deployments                               | create Â· delete Â· get Â· update | {{< risk Low >}} |      |
| ClusterRole `cilium-etcd-operator` | core/deployments                               | create Â· delete Â· get Â· update | {{< risk Low >}} |      |
| ClusterRole `cilium-etcd-operator` | extensions/deployments                         | create Â· delete Â· get Â· update | {{< risk Low >}} |      |
| ClusterRole `cilium-etcd-operator` | etcd.database.coreos.com/etcdclusters          | create Â· delete Â· get Â· update | {{< risk Low >}} |      |
| ClusterRole `cilium-etcd-operator` | core/pods                                      | delete Â· get Â· list            | {{< risk Low >}} |      |
| ClusterRole `cilium-etcd-operator` | core/secrets                                   | create Â· delete Â· get          | {{< risk Low >}} |      |

#### âš ï¸ Potential Abuse (1)

The following security risks were found based on the above permissions:

#### ğŸ“¦ Workloads (1)

| Kind       | Name                 | Container            | Image                                        |
| ---------- | -------------------- | -------------------- | -------------------------------------------- |
| Deployment | cilium-etcd-operator | cilium-etcd-operator | docker.io/cilium/cilium-etcd-operator:v2.0.7 |

---
