---
title: "eg-universal-agent-operator"
description: "A Helm chart for Kubernetes installation of eG Universal agent Operator"
version: v0.0.4
version_order: f0000f0000f0004
date: ""
service_accounts: 5
workloads: 5
bindings: 112
critical_findings: 16
high_findings: 24
medium_findings: 8
low_findings: 64
categories: [eginnovations, egagent, cluster, kubernetes, openshift, monitoring, pod, deployment, apm, k8s, ocp]
tags:
  [
    BindingToPrivilegedRole,
    ClusterAdminAccess,
    ClusterStructure,
    ClusterWideAccess,
    ClusterWideSecretAccess,
    ConfigMapAccess,
    ControlPlaneDisruption,
    CredentialAccess,
    CriticalNamespace,
    DataExposure,
    DenialOfService,
    IdentityManagement,
    InformationDisclosure,
    LateralMovement,
    LeaderElectionAbuse,
    NamespaceLifecycle,
    NetworkManipulation,
    NodeAccess,
    OperationalData,
    Persistence,
    PotentialPrivilegeEscalation,
    PrivilegeEscalation,
    QuotaTampering,
    RBACManipulation,
    RBACQuery,
    Reconnaissance,
    ResourceConfiguration,
    ResourceDeletion,
    ResourceNameRestricted,
    SecretAccess,
    ServiceExposure,
    Tampering,
    WebhookManipulation,
    WebhookReconnaissance,
    WildcardPermission,
    WorkloadExecution,
    WorkloadLifecycle,
    letter-E,
  ]
---

## Description

A Helm chart for Kubernetes installation of eG Universal agent Operator

- https://eginnovations.github.io/eg-universal-agent-operator-helm

## Overview

| Identity                                                                                                                   | Namespace    | Automount | Secrets | Permissions | Workloads | Risk                    |
| -------------------------------------------------------------------------------------------------------------------------- | ------------ | --------- | ------- | ----------- | --------- | ----------------------- |
| [`eg-universal-agent-operator-cert-manager`](#sa-eg-universal-agent-operator-cert-manager)                                 | cert-manager | âœ…        | â€”       | 53          | 1         | {{< risk "Critical" >}} |
| [`eg-universal-agent-operator-cert-manager-cainjector`](#sa-eg-universal-agent-operator-cert-manager-cainjector)           | cert-manager | âœ…        | â€”       | 10          | 1         | {{< risk "Critical" >}} |
| [`eginnovations-operator-controller-manager`](#sa-eginnovations-operator-controller-manager)                               | egagent      | âŒ        | â€”       | 45          | 1         | {{< risk "Critical" >}} |
| [`eg-universal-agent-operator-cert-manager-webhook`](#sa-eg-universal-agent-operator-cert-manager-webhook)                 | cert-manager | âœ…        | â€”       | 3           | 1         | {{< risk "Medium" >}}   |
| [`eg-universal-agent-operator-cert-manager-startupapicheck`](#sa-eg-universal-agent-operator-cert-manager-startupapicheck) | cert-manager | âœ…        | â€”       | 1           | 1         | {{< risk "Low" >}}      |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### ğŸ¤– `eg-universal-agent-operator-cert-manager` {#sa-eg-universal-agent-operator-cert-manager}

**Namespace:** `cert-manager` Â |Â  **Automount:** âœ…

#### ğŸ”‘ Permissions (53)

| Role                                                                             | Resource                                                                                 | Verbs                                                 | Risk                  | Tags                                                                                                                                                                    |
| -------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------- | ----------------------------------------------------- | --------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-challenges`     | core/pods                                                                                | create Â· delete Â· get Â· list Â· watch                  | {{< risk Critical >}} | {{< tag "LateralMovement" >}} {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "WorkloadExecution" >}}    |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-certificates`   | core/secrets                                                                             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Persistence" >}} (+4 more) |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-challenges`     | core/secrets                                                                             | get Â· list Â· watch                                    | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}}          |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-clusterissuers` | core/secrets                                                                             | create Â· delete Â· get Â· list Â· update Â· watch         | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}}          |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-issuers`        | core/secrets                                                                             | create Â· delete Â· get Â· list Â· update Â· watch         | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}}          |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-orders`         | core/secrets                                                                             | get Â· list Â· watch                                    | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}}          |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-certificates`   | cert-manager.io/certificaterequests                                                      | get Â· list Â· patch Â· update Â· watch                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-ingress-shim`   | cert-manager.io/certificaterequests                                                      | create Â· delete Â· get Â· list Â· update Â· watch         | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-certificates`   | cert-manager.io/certificaterequests/finalizers                                           | update                                                | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-certificates`   | cert-manager.io/certificaterequests/status                                               | patch Â· update                                        | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-certificates`   | cert-manager.io/certificates                                                             | get Â· list Â· patch Â· update Â· watch                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-ingress-shim`   | cert-manager.io/certificates                                                             | create Â· delete Â· get Â· list Â· update Â· watch         | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-certificates`   | cert-manager.io/certificates/finalizers                                                  | update                                                | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-certificates`   | cert-manager.io/certificates/status                                                      | patch Â· update                                        | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-challenges`     | acme.cert-manager.io/challenges                                                          | get Â· list Â· patch Â· update Â· watch                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-orders`         | acme.cert-manager.io/challenges                                                          | create Â· delete Â· get Â· list Â· watch                  | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-challenges`     | acme.cert-manager.io/challenges/finalizers                                               | update                                                | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-challenges`     | acme.cert-manager.io/challenges/status                                                   | patch Â· update                                        | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-certificates`   | cert-manager.io/clusterissuers                                                           | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-challenges`     | cert-manager.io/clusterissuers                                                           | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-clusterissuers` | cert-manager.io/clusterissuers                                                           | get Â· list Â· patch Â· update Â· watch                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-ingress-shim`   | cert-manager.io/clusterissuers                                                           | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-orders`         | cert-manager.io/clusterissuers                                                           | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-clusterissuers` | cert-manager.io/clusterissuers/status                                                    | patch Â· update                                        | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-certificates`   | core/events                                                                              | create Â· patch                                        | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-challenges`     | core/events                                                                              | create Â· patch                                        | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-clusterissuers` | core/events                                                                              | create Â· patch                                        | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-ingress-shim`   | core/events                                                                              | create Â· patch                                        | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-issuers`        | core/events                                                                              | create Â· patch                                        | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-orders`         | core/events                                                                              | create Â· patch                                        | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-ingress-shim`   | gateway.networking.k8s.io/gateways                                                       | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-ingress-shim`   | gateway.networking.k8s.io/gateways/finalizers                                            | update                                                | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-challenges`     | gateway.networking.k8s.io/httproutes                                                     | create Â· delete Â· get Â· list Â· update Â· watch         | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-ingress-shim`   | gateway.networking.k8s.io/httproutes                                                     | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-ingress-shim`   | gateway.networking.k8s.io/httproutes/finalizers                                          | update                                                | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-challenges`     | networking.k8s.io/ingresses                                                              | create Â· delete Â· get Â· list Â· update Â· watch         | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-ingress-shim`   | networking.k8s.io/ingresses                                                              | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-ingress-shim`   | networking.k8s.io/ingresses/finalizers                                                   | update                                                | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-certificates`   | cert-manager.io/issuers                                                                  | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-challenges`     | cert-manager.io/issuers                                                                  | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-ingress-shim`   | cert-manager.io/issuers                                                                  | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-issuers`        | cert-manager.io/issuers                                                                  | get Â· list Â· patch Â· update Â· watch                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-orders`         | cert-manager.io/issuers                                                                  | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-issuers`        | cert-manager.io/issuers/status                                                           | patch Â· update                                        | {{< risk Low >}}      |                                                                                                                                                                         |
| Role `eg-universal-agent-operator-cert-manager:leaderelection`                   | coordination.k8s.io/leases                                                               | create                                                | {{< risk Low >}}      |                                                                                                                                                                         |
| Role `eg-universal-agent-operator-cert-manager:leaderelection`                   | coordination.k8s.io/leases **(restricted to: cert-manager-controller)**                  | get Â· patch Â· update                                  | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                    |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-certificates`   | acme.cert-manager.io/orders                                                              | create Â· delete Â· get Â· list Â· watch                  | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-orders`         | acme.cert-manager.io/orders                                                              | get Â· list Â· patch Â· update Â· watch                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-orders`         | acme.cert-manager.io/orders/finalizers                                                   | update                                                | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-orders`         | acme.cert-manager.io/orders/status                                                       | patch Â· update                                        | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-challenges`     | route.openshift.io/routes/custom-host                                                    | create                                                | {{< risk Low >}}      |                                                                                                                                                                         |
| Role `eg-universal-agent-operator-cert-manager-tokenrequest`                     | core/serviceaccounts/token **(restricted to: eg-universal-agent-operator-cert-manager)** | create                                                | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                    |
| ClusterRole `eg-universal-agent-operator-cert-manager-controller-challenges`     | core/services                                                                            | create Â· delete Â· get Â· list Â· watch                  | {{< risk Low >}}      |                                                                                                                                                                         |

#### âš ï¸ Potential Abuse (7)

The following security risks were found based on the above permissions:

- [Create pods cluster-wide](/rules/1006)
- [Create pods in a namespace](/rules/1007)
- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Modify secrets cluster-wide](/rules/1012)
- [Modify secrets in a namespace](/rules/1013)

#### ğŸ“¦ Workloads (1)

| Kind       | Name                                     | Container               | Image                                            |
| ---------- | ---------------------------------------- | ----------------------- | ------------------------------------------------ |
| Deployment | eg-universal-agent-operator-cert-manager | cert-manager-controller | quay.io/jetstack/cert-manager-controller:v1.17.0 |

---

### ğŸ¤– `eginnovations-operator-controller-manager` {#sa-eginnovations-operator-controller-manager}

**Namespace:** `egagent` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (45)

| Role                                                   | Resource                                                                         | Verbs                                                 | Risk                  | Tags                                                                                                                                                                                  |
| ------------------------------------------------------ | -------------------------------------------------------------------------------- | ----------------------------------------------------- | --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `eginnovations-operator-manager-role`      | rbac.authorization.k8s.io/clusterrolebindings                                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "BindingToPrivilegedRole" >}} {{< tag "ClusterAdminAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}} (+2 more) |
| ClusterRole `eginnovations-operator-manager-role`      | rbac.authorization.k8s.io/clusterroles                                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ClusterAdminAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}} {{< tag "RBACQuery" >}} (+1 more)               |
| ClusterRole `eginnovations-operator-manager-role`      | core/configmaps                                                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}                       |
| ClusterRole `eginnovations-operator-manager-role`      | apps/daemonsets                                                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "NodeAccess" >}} {{< tag "Persistence" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}                                          |
| ClusterRole `eginnovations-operator-manager-role`      | coordination.k8s.io/leases                                                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ControlPlaneDisruption" >}} {{< tag "CriticalNamespace" >}} {{< tag "DenialOfService" >}} {{< tag "LeaderElectionAbuse" >}} {{< tag "Tampering" >}}                          |
| Role `eginnovations-operator-leader-election-role`     | coordination.k8s.io/leases                                                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ControlPlaneDisruption" >}} {{< tag "CriticalNamespace" >}} {{< tag "DenialOfService" >}} {{< tag "Tampering" >}}                                                            |
| ClusterRole `eginnovations-operator-manager-role`      | admissionregistration.k8s.io/mutatingwebhookconfigurations                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "DenialOfService" >}} {{< tag "InformationDisclosure" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Reconnaissance" >}} {{< tag "Tampering" >}} (+2 more)                    |
| ClusterRole `eginnovations-operator-manager-role`      | core/secrets                                                                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Persistence" >}} (+4 more)               |
| ClusterRole `eginnovations-operator-manager-role`      | core/services                                                                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "DenialOfService" >}} {{< tag "NetworkManipulation" >}} {{< tag "ServiceExposure" >}} {{< tag "Tampering" >}}                                                                 |
| ClusterRole `eginnovations-operator-manager-role`      | \*/clusteroperators                                                              | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| Role `eginnovations-operator-leader-election-role`     | core/configmaps                                                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}                       |
| ClusterRole `eginnovations-operator-manager-role`      | \*/cronjobs                                                                      | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/deploymentconfigs                                                             | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/deployments                                                                   | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/endpoints                                                                     | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/horizontalpodautoscalers                                                      | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/ingresses                                                                     | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/jobs                                                                          | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | core/namespaces                                                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "ClusterStructure" >}} {{< tag "DenialOfService" >}} {{< tag "InformationDisclosure" >}} {{< tag "NamespaceLifecycle" >}} {{< tag "Reconnaissance" >}} (+1 more)              |
| ClusterRole `eginnovations-operator-manager-role`      | \*/nodes                                                                         | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/nodes/log                                                                     | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/nodes/metrics                                                                 | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/nodes/proxy                                                                   | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/nodes/spec                                                                    | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/nodes/stats                                                                   | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/persistentvolumeclaims                                                        | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/persistentvolumes                                                             | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/pods                                                                          | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/replicasets                                                                   | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/replicationcontrollers                                                        | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | core/serviceaccounts                                                             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "IdentityManagement" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}                                                                                   |
| ClusterRole `eginnovations-operator-manager-role`      | \*/services                                                                      | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/statefulsets                                                                  | get Â· list Â· watch                                    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                      |
| ClusterRole `eginnovations-operator-manager-role`      | \*/componentstatuses                                                             | get Â· list Â· watch                                    | {{< risk Medium >}}   | {{< tag "ClusterWideAccess" >}} {{< tag "ControlPlaneDisruption" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "WildcardPermission" >}}                |
| ClusterRole `eginnovations-operator-manager-role`      | \*/events                                                                        | get Â· list Â· watch                                    | {{< risk Medium >}}   | {{< tag "ClusterWideAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "OperationalData" >}} {{< tag "Reconnaissance" >}} {{< tag "WildcardPermission" >}}                       |
| ClusterRole `eginnovations-operator-manager-role`      | \*/resourcequotas                                                                | get Â· list Â· watch                                    | {{< risk Medium >}}   | {{< tag "ClusterWideAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "QuotaTampering" >}} {{< tag "Reconnaissance" >}} {{< tag "ResourceConfiguration" >}} (+1 more)           |
| ClusterRole `eginnovations-operator-metrics-auth-role` | authorization.k8s.io/subjectaccessreviews                                        | create                                                | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                                                                                           |
| ClusterRole `eginnovations-operator-metrics-auth-role` | authentication.k8s.io/tokenreviews                                               | create                                                | {{< risk Medium >}}   | {{< tag "CredentialAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                                                            |
| ClusterRole `eginnovations-operator-manager-role`      | eginnovations.com/eguniversalagents                                              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                                       |
| ClusterRole `eginnovations-operator-manager-role`      | eginnovations.com/eguniversalagents/finalizers                                   | update                                                | {{< risk Low >}}      |                                                                                                                                                                                       |
| ClusterRole `eginnovations-operator-manager-role`      | eginnovations.com/eguniversalagents/status                                       | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                                       |
| Role `eginnovations-operator-leader-election-role`     | core/events                                                                      | create Â· patch                                        | {{< risk Low >}}      |                                                                                                                                                                                       |
| ClusterRole `eginnovations-operator-manager-role`      | \*/limitranges                                                                   | get Â· list Â· watch                                    | {{< risk Low >}}      | {{< tag "ClusterWideAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "ResourceConfiguration" >}} {{< tag "WildcardPermission" >}}                 |
| ClusterRole `eginnovations-operator-manager-role`      | core/pods                                                                        | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                                       |
| ClusterRole `eginnovations-operator-manager-role`      | security.openshift.io/securitycontextconstraints **(restricted to: privileged)** | use                                                   | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                                  |

#### âš ï¸ Potential Abuse (32)

The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Modify secrets cluster-wide](/rules/1012)
- [Modify secrets in a namespace](/rules/1013)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Modify ConfigMaps cluster-wide](/rules/1024)
- [Modify ConfigMaps in a namespace](/rules/1025)
- [Delete namespaces](/rules/1026)
- [Manage ClusterRoles (create, update, patch, delete)](/rules/1027)
- [Manage ClusterRoleBindings (create, update, patch, delete)](/rules/1028)
- [Manage DaemonSets cluster-wide (runs on all nodes, high impact)](/rules/1035)
- [Manage DaemonSets in a namespace (runs on nodes, high impact)](/rules/1036)
- [Manage MutatingWebhookConfigurations](/rules/1043)
- [Create TokenReviews (validate arbitrary tokens)](/rules/1049)
- [Create SubjectAccessReviews (check arbitrary permissions)](/rules/1050)
- [Manage ServiceAccounts cluster-wide](/rules/1067)
- [Manage ServiceAccounts in a namespace](/rules/1068)
- [Read events cluster-wide](/rules/1070)
- [Manage Services cluster-wide](/rules/1075)
- [Manage Services in a namespace](/rules/1076)
- [Read RBAC configuration cluster-wide](/rules/1077)
- [Manage Leases cluster-wide](/rules/1080)
- [Manage Leases in kube-system or kube-node-lease namespace](/rules/1081)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)
- [List MutatingWebhookConfigurations (Reconnaissance)](/rules/1084)
- [Read LimitRanges (Namespace Information Disclosure)](/rules/1087)
- [Read ResourceQuotas (Namespace Information Disclosure)](/rules/1088)
- [Read All ResourceQuotas (Cluster-wide Information Disclosure)](/rules/1089)
- [Read ComponentStatuses (Control Plane Reconnaissance)](/rules/1095)

#### ğŸ“¦ Workloads (1)

| Kind       | Name                                      | Container | Image                                                   |
| ---------- | ----------------------------------------- | --------- | ------------------------------------------------------- |
| Deployment | eginnovations-operator-controller-manager | manager   | docker.io/eginnovations/universal-agent-operator:0.0.10 |

---

### ğŸ¤– `eg-universal-agent-operator-cert-manager-cainjector` {#sa-eg-universal-agent-operator-cert-manager-cainjector}

**Namespace:** `cert-manager` Â |Â  **Automount:** âœ…

#### ğŸ”‘ Permissions (10)

| Role                                                                      | Resource                                                                                     | Verbs                               | Risk                  | Tags                                                                                                                                                           |
| ------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------- | ----------------------------------- | --------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `eg-universal-agent-operator-cert-manager-cainjector`         | core/secrets                                                                                 | get Â· list Â· watch                  | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}} |
| ClusterRole `eg-universal-agent-operator-cert-manager-cainjector`         | admissionregistration.k8s.io/mutatingwebhookconfigurations                                   | get Â· list Â· patch Â· update Â· watch | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "WebhookReconnaissance" >}}                                                           |
| ClusterRole `eg-universal-agent-operator-cert-manager-cainjector`         | admissionregistration.k8s.io/validatingwebhookconfigurations                                 | get Â· list Â· patch Â· update Â· watch | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "WebhookReconnaissance" >}}                                                           |
| ClusterRole `eg-universal-agent-operator-cert-manager-cainjector`         | apiregistration.k8s.io/apiservices                                                           | get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `eg-universal-agent-operator-cert-manager-cainjector`         | cert-manager.io/certificates                                                                 | get Â· list Â· watch                  | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `eg-universal-agent-operator-cert-manager-cainjector`         | apiextensions.k8s.io/customresourcedefinitions                                               | get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `eg-universal-agent-operator-cert-manager-cainjector`         | core/events                                                                                  | create Â· get Â· patch Â· update       | {{< risk Low >}}      |                                                                                                                                                                |
| Role `eg-universal-agent-operator-cert-manager-cainjector:leaderelection` | coordination.k8s.io/leases **(restricted to: cert-manager-cainjector-leader-election)**      | get Â· patch Â· update                | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                           |
| Role `eg-universal-agent-operator-cert-manager-cainjector:leaderelection` | coordination.k8s.io/leases **(restricted to: cert-manager-cainjector-leader-election-core)** | get Â· patch Â· update                | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                           |
| Role `eg-universal-agent-operator-cert-manager-cainjector:leaderelection` | coordination.k8s.io/leases                                                                   | create                              | {{< risk Low >}}      |                                                                                                                                                                |

#### âš ï¸ Potential Abuse (5)

The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [List ValidatingWebhookConfigurations (Reconnaissance)](/rules/1083)
- [List MutatingWebhookConfigurations (Reconnaissance)](/rules/1084)

#### ğŸ“¦ Workloads (1)

| Kind       | Name                                                | Container               | Image                                            |
| ---------- | --------------------------------------------------- | ----------------------- | ------------------------------------------------ |
| Deployment | eg-universal-agent-operator-cert-manager-cainjector | cert-manager-cainjector | quay.io/jetstack/cert-manager-cainjector:v1.17.0 |

---

### ğŸ¤– `eg-universal-agent-operator-cert-manager-webhook` {#sa-eg-universal-agent-operator-cert-manager-webhook}

**Namespace:** `cert-manager` Â |Â  **Automount:** âœ…

#### ğŸ”‘ Permissions (3)

| Role                                                                                | Resource                                                                              | Verbs                       | Risk                | Tags                                                                                                                                                          |
| ----------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------- | --------------------------- | ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `eg-universal-agent-operator-cert-manager-webhook:subjectaccessreviews` | authorization.k8s.io/subjectaccessreviews                                             | create                      | {{< risk Medium >}} | {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                                                                   |
| Role `eg-universal-agent-operator-cert-manager-webhook:dynamic-serving`             | core/secrets **(restricted to: eg-universal-agent-operator-cert-manager-webhook-ca)** | get Â· list Â· update Â· watch | {{< risk Low >}}    | {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "ResourceNameRestricted" >}} {{< tag "SecretAccess" >}} |
| Role `eg-universal-agent-operator-cert-manager-webhook:dynamic-serving`             | core/secrets                                                                          | create                      | {{< risk Low >}}    |                                                                                                                                                               |

#### âš ï¸ Potential Abuse (3)

The following security risks were found based on the above permissions:

- [Read secrets in a namespace](/rules/1011)
- [Create SubjectAccessReviews (check arbitrary permissions)](/rules/1050)

#### ğŸ“¦ Workloads (1)

| Kind       | Name                                             | Container            | Image                                         |
| ---------- | ------------------------------------------------ | -------------------- | --------------------------------------------- |
| Deployment | eg-universal-agent-operator-cert-manager-webhook | cert-manager-webhook | quay.io/jetstack/cert-manager-webhook:v1.17.0 |

---

### ğŸ¤– `eg-universal-agent-operator-cert-manager-startupapicheck` {#sa-eg-universal-agent-operator-cert-manager-startupapicheck}

**Namespace:** `cert-manager` Â |Â  **Automount:** âœ…

#### ğŸ”‘ Permissions (1)

| Role                                                                        | Resource                            | Verbs  | Risk             | Tags |
| --------------------------------------------------------------------------- | ----------------------------------- | ------ | ---------------- | ---- |
| Role `eg-universal-agent-operator-cert-manager-startupapicheck:create-cert` | cert-manager.io/certificaterequests | create | {{< risk Low >}} |      |

#### âš ï¸ Potential Abuse (1)

The following security risks were found based on the above permissions:

#### ğŸ“¦ Workloads (1)

| Kind | Name                                                     | Container                    | Image                                                 |
| ---- | -------------------------------------------------------- | ---------------------------- | ----------------------------------------------------- |
| Job  | eg-universal-agent-operator-cert-manager-startupapicheck | cert-manager-startupapicheck | quay.io/jetstack/cert-manager-startupapicheck:v1.17.0 |

---
