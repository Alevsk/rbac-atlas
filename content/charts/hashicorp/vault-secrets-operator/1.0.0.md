---
title: "vault-secrets-operator"
description: "Official Vault Secrets Operator Chart"
version: v1.0.0
version_order: f0001f0000f0000
date: ""
service_accounts: 2
workloads: 3
bindings: 45
critical_findings: 3
high_findings: 2
medium_findings: 2
low_findings: 38
categories: []
tags:
  [
    CRDManipulation,
    ClusterWideSecretAccess,
    ConfigMapAccess,
    ControlPlaneDisruption,
    CredentialAccess,
    CriticalNamespace,
    DataExposure,
    DenialOfService,
    InformationDisclosure,
    Persistence,
    PotentialPrivilegeEscalation,
    PrivilegeEscalation,
    RBACQuery,
    SecretAccess,
    Tampering,
    letter-V,
  ]
---

## Description

Official Vault Secrets Operator Chart

- https://github.com/hashicorp/vault-secrets-operator

## Overview

| Identity                                                                                     | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| -------------------------------------------------------------------------------------------- | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`vault-secrets-operator-controller-manager`](#sa-vault-secrets-operator-controller-manager) | default   | ❌        | —       | 44          | 3         | {{< risk "Critical" >}} |
| [`vault-secrets-operator-upgrade-crds`](#sa-vault-secrets-operator-upgrade-crds)             | default   | ❌        | —       | 1           | 1         | {{< risk "Critical" >}} |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### 🤖 `vault-secrets-operator-controller-manager` {#sa-vault-secrets-operator-controller-manager}

**Namespace:** `default`  |  **Automount:** ❌

#### 🔑 Permissions (44)

| Role                                               | Resource                                               | Verbs                                                                    | Risk                  | Tags                                                                                                                                                                    |
| -------------------------------------------------- | ------------------------------------------------------ | ------------------------------------------------------------------------ | --------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Role `vault-secrets-operator-leader-election-role` | coordination.k8s.io/leases                             | create · delete · get · list · patch · update · watch                    | {{< risk Critical >}} | {{< tag "ControlPlaneDisruption" >}} {{< tag "CriticalNamespace" >}} {{< tag "DenialOfService" >}} {{< tag "Tampering" >}}                                              |
| ClusterRole `vault-secrets-operator-manager-role`  | core/secrets                                           | create · delete · deletecollection · get · list · patch · update · watch | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Persistence" >}} (+4 more) |
| ClusterRole `vault-secrets-operator-manager-role`  | core/configmaps                                        | get · list · watch                                                       | {{< risk High >}}     | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}}                                                                            |
| Role `vault-secrets-operator-leader-election-role` | core/configmaps                                        | create · delete · get · list · patch · update · watch                    | {{< risk High >}}     | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}         |
| ClusterRole `vault-secrets-operator-proxy-role`    | authorization.k8s.io/subjectaccessreviews              | create                                                                   | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                                                                             |
| ClusterRole `vault-secrets-operator-proxy-role`    | authentication.k8s.io/tokenreviews                     | create                                                                   | {{< risk Medium >}}   | {{< tag "CredentialAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                                              |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/csisecrets                       | create · delete · get · list · patch · update · watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/csisecrets/finalizers            | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/csisecrets/status                | get · patch · update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | apps/daemonsets                                        | get · list · patch · watch                                               | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | apps/deployments                                       | get · list · patch · watch                                               | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | core/events                                            | create · patch                                                           | {{< risk Low >}}      |                                                                                                                                                                         |
| Role `vault-secrets-operator-leader-election-role` | core/events                                            | create · patch                                                           | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/hcpauths                         | create · delete · get · list · patch · update · watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/hcpauths/finalizers              | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/hcpauths/status                  | get · patch · update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/hcpvaultsecretsapps              | create · delete · get · list · patch · update · watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/hcpvaultsecretsapps/finalizers   | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/hcpvaultsecretsapps/status       | get · patch · update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | argoproj.io/rollouts                                   | get · list · patch · watch                                               | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/secrettransformations            | create · delete · get · list · patch · update · watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/secrettransformations/finalizers | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/secrettransformations/status     | get · patch · update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | core/serviceaccounts                                   | get · list · watch                                                       | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | core/serviceaccounts/token                             | create · get · list · watch                                              | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | apps/statefulsets                                      | get · list · patch · watch                                               | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultauthglobals                 | create · delete · get · list · patch · update · watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultauthglobals/finalizers      | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultauthglobals/status          | get · patch · update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultauths                       | create · delete · get · list · patch · update · watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultauths/finalizers            | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultauths/status                | get · patch · update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultconnections                 | create · delete · get · list · patch · update · watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultconnections/finalizers      | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultconnections/status          | get · patch · update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultdynamicsecrets              | create · delete · get · list · patch · update · watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultdynamicsecrets/finalizers   | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultdynamicsecrets/status       | get · patch · update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultpkisecrets                  | create · delete · get · list · patch · update · watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultpkisecrets/finalizers       | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultpkisecrets/status           | get · patch · update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultstaticsecrets               | create · delete · get · list · patch · update · watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultstaticsecrets/finalizers    | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultstaticsecrets/status        | get · patch · update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |

#### ⚠️ Potential Abuse (11)

The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Modify secrets cluster-wide](/rules/1012)
- [Modify secrets in a namespace](/rules/1013)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Modify ConfigMaps in a namespace](/rules/1025)
- [Create TokenReviews (validate arbitrary tokens)](/rules/1049)
- [Create SubjectAccessReviews (check arbitrary permissions)](/rules/1050)
- [Manage Leases in kube-system or kube-node-lease namespace](/rules/1081)

#### 📦 Workloads (3)

| Kind       | Name                                      | Container                     | Image                                  |
| ---------- | ----------------------------------------- | ----------------------------- | -------------------------------------- |
| Deployment | vault-secrets-operator-controller-manager | kube-rbac-proxy               | quay.io/brancz/kube-rbac-proxy:v0.18.1 |
| Deployment | vault-secrets-operator-controller-manager | manager                       | hashicorp/vault-secrets-operator:1.0.0 |
| Job        | pdcc-vault-secrets-operator               | pre-delete-controller-cleanup | hashicorp/vault-secrets-operator:1.0.0 |

---

### 🤖 `vault-secrets-operator-upgrade-crds` {#sa-vault-secrets-operator-upgrade-crds}

**Namespace:** `default`  |  **Automount:** ❌

#### 🔑 Permissions (1)

| Role                                              | Resource                                       | Verbs                                         | Risk                  | Tags                                                                                             |
| ------------------------------------------------- | ---------------------------------------------- | --------------------------------------------- | --------------------- | ------------------------------------------------------------------------------------------------ |
| ClusterRole `vault-secrets-operator-upgrade-crds` | apiextensions.k8s.io/customresourcedefinitions | create · delete · get · list · patch · update | {{< risk Critical >}} | {{< tag "CRDManipulation" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}} |

#### ⚠️ Potential Abuse (2)

The following security risks were found based on the above permissions:

- [Manage CustomResourceDefinitions](/rules/1045)

#### 📦 Workloads (1)

| Kind | Name                                | Container        | Image                                  |
| ---- | ----------------------------------- | ---------------- | -------------------------------------- |
| Job  | upgrade-crds-vault-secrets-operator | pre-upgrade-crds | hashicorp/vault-secrets-operator:1.0.0 |

---
