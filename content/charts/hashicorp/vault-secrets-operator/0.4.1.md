---
title: "vault-secrets-operator"
description: "Official Vault Secrets Operator Chart"
version: v0.4.1
version_order: f0000f0004f0001
date: ""
service_accounts: 1
workloads: 2
bindings: 34
critical_findings: 2
high_findings: 2
medium_findings: 2
low_findings: 28
categories: []
tags:
  [
    ClusterWideSecretAccess,
    ConfigMapAccess,
    ControlPlaneDisruption,
    CredentialAccess,
    CriticalNamespace,
    DataExposure,
    DenialOfService,
    InformationDisclosure,
    Persistence,
    PotentialPrivilegeEscalation,
    PrivilegeEscalation,
    RBACQuery,
    SecretAccess,
    Tampering,
    letter-V,
  ]
---

## Description

Official Vault Secrets Operator Chart

- https://github.com/hashicorp/vault-secrets-operator

## Overview

| Identity                                                                                     | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| -------------------------------------------------------------------------------------------- | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`vault-secrets-operator-controller-manager`](#sa-vault-secrets-operator-controller-manager) | default   | âŒ        | â€”       | 34          | 3         | {{< risk "Critical" >}} |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### ğŸ¤– `vault-secrets-operator-controller-manager` {#sa-vault-secrets-operator-controller-manager}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (34)

| Role                                               | Resource                                             | Verbs                                                                    | Risk                  | Tags                                                                                                                                                                    |
| -------------------------------------------------- | ---------------------------------------------------- | ------------------------------------------------------------------------ | --------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Role `vault-secrets-operator-leader-election-role` | coordination.k8s.io/leases                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Critical >}} | {{< tag "ControlPlaneDisruption" >}} {{< tag "CriticalNamespace" >}} {{< tag "DenialOfService" >}} {{< tag "Tampering" >}}                                              |
| ClusterRole `vault-secrets-operator-manager-role`  | core/secrets                                         | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Persistence" >}} (+4 more) |
| ClusterRole `vault-secrets-operator-manager-role`  | core/configmaps                                      | get Â· list Â· watch                                                       | {{< risk High >}}     | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}}                                                                            |
| Role `vault-secrets-operator-leader-election-role` | core/configmaps                                      | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk High >}}     | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}         |
| ClusterRole `vault-secrets-operator-proxy-role`    | authorization.k8s.io/subjectaccessreviews            | create                                                                   | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                                                                             |
| ClusterRole `vault-secrets-operator-proxy-role`    | authentication.k8s.io/tokenreviews                   | create                                                                   | {{< risk Medium >}}   | {{< tag "CredentialAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                                              |
| ClusterRole `vault-secrets-operator-manager-role`  | apps/daemonsets                                      | get Â· list Â· patch Â· watch                                               | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | apps/deployments                                     | get Â· list Â· patch Â· watch                                               | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | core/events                                          | create Â· patch                                                           | {{< risk Low >}}      |                                                                                                                                                                         |
| Role `vault-secrets-operator-leader-election-role` | core/events                                          | create Â· patch                                                           | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/hcpauths                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/hcpauths/finalizers            | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/hcpauths/status                | get Â· patch Â· update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/hcpvaultsecretsapps            | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/hcpvaultsecretsapps/finalizers | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/hcpvaultsecretsapps/status     | get Â· patch Â· update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | core/serviceaccounts                                 | get Â· list Â· watch                                                       | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | core/serviceaccounts/token                           | create Â· get Â· list Â· watch                                              | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | apps/statefulsets                                    | get Â· list Â· patch Â· watch                                               | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultauths                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultauths/finalizers          | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultauths/status              | get Â· patch Â· update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultconnections               | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultconnections/finalizers    | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultconnections/status        | get Â· patch Â· update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultdynamicsecrets            | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultdynamicsecrets/finalizers | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultdynamicsecrets/status     | get Â· patch Â· update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultpkisecrets                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultpkisecrets/finalizers     | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultpkisecrets/status         | get Â· patch Â· update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultstaticsecrets             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultstaticsecrets/finalizers  | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `vault-secrets-operator-manager-role`  | secrets.hashicorp.com/vaultstaticsecrets/status      | get Â· patch Â· update                                                     | {{< risk Low >}}      |                                                                                                                                                                         |

#### âš ï¸ Potential Abuse (11)

The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Modify secrets cluster-wide](/rules/1012)
- [Modify secrets in a namespace](/rules/1013)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Modify ConfigMaps in a namespace](/rules/1025)
- [Create TokenReviews (validate arbitrary tokens)](/rules/1049)
- [Create SubjectAccessReviews (check arbitrary permissions)](/rules/1050)
- [Manage Leases in kube-system or kube-node-lease namespace](/rules/1081)

#### ğŸ“¦ Workloads (3)

| Kind       | Name                                                 | Container                     | Image                                      |
| ---------- | ---------------------------------------------------- | ----------------------------- | ------------------------------------------ |
| Deployment | vault-secrets-operator-controller-manager            | kube-rbac-proxy               | gcr.io/kubebuilder/kube-rbac-proxy:v0.15.0 |
| Deployment | vault-secrets-operator-controller-manager            | manager                       | hashicorp/vault-secrets-operator:0.4.1     |
| Job        | vault-secrets-operator-pre-delete-controller-cleanup | pre-delete-controller-cleanup | hashicorp/vault-secrets-operator:0.4.1     |

---
