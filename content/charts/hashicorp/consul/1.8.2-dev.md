---
title: "consul"
description: "Official HashiCorp Consul Chart"
version: v1.8.2-dev
version_order: f0001f0008f0002
date: ""
service_accounts: 5
workloads: 6
bindings: 74
critical_findings: 3
high_findings: 1
medium_findings: 4
low_findings: 66
categories: []
tags:
  [
    ClusterStructure,
    ClusterWideSecretAccess,
    ConfigMapAccess,
    CredentialAccess,
    DataExposure,
    DeprecatedFeature,
    InformationDisclosure,
    NodeAccess,
    Persistence,
    PodSecurityPolicy,
    PotentialPrivilegeEscalation,
    PrivilegeEscalation,
    RBACQuery,
    Reconnaissance,
    ResourceNameRestricted,
    SecretAccess,
    Tampering,
    WebhookReconnaissance,
    letter-C,
  ]
---

## Description

Official HashiCorp Consul Chart

- https://github.com/hashicorp/consul
- https://github.com/hashicorp/consul-k8s

## Overview

| Identity                                                                       | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| ------------------------------------------------------------------------------ | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`consul-consul-connect-injector`](#sa-consul-consul-connect-injector)         | default   | ❌        | —       | 65          | 1         | {{< risk "Critical" >}} |
| [`consul-consul-webhook-cert-manager`](#sa-consul-consul-webhook-cert-manager) | default   | ❌        | —       | 4           | 1         | {{< risk "Critical" >}} |
| [`consul-consul-gateway-cleanup`](#sa-consul-consul-gateway-cleanup)           | default   | ❌        | —       | 2           | 1         | {{< risk "Low" >}}      |
| [`consul-consul-gateway-resources`](#sa-consul-consul-gateway-resources)       | default   | ❌        | —       | 2           | 1         | {{< risk "Low" >}}      |
| [`consul-consul-server`](#sa-consul-consul-server)                             | default   | ❌        | —       | 1           | 1         | {{< risk "Low" >}}      |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### 🤖 `consul-consul-connect-injector` {#sa-consul-consul-connect-injector}

**Namespace:** `default`  |  **Automount:** ❌

#### 🔑 Permissions (65)

| Role                                                | Resource                                              | Verbs                                                 | Risk                  | Tags                                                                                                                                                            |
| --------------------------------------------------- | ----------------------------------------------------- | ----------------------------------------------------- | --------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `consul-consul-connect-injector`        | policy/podsecuritypolicies                            | use                                                   | {{< risk Critical >}} | {{< tag "DeprecatedFeature" >}} {{< tag "NodeAccess" >}} {{< tag "PodSecurityPolicy" >}} {{< tag "PrivilegeEscalation" >}}                                      |
| ClusterRole `consul-consul-connect-injector`        | core/secrets                                          | create · delete · get · list · update · watch         | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}}  |
| Role `consul-consul-connect-inject-leader-election` | core/configmaps                                       | create · delete · get · list · patch · update · watch | {{< risk High >}}     | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}} |
| ClusterRole `consul-consul-connect-injector`        | rbac.authorization.k8s.io/rolebindings                | create · delete · get · list · update · watch         | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}} {{< tag "Reconnaissance" >}}                                                                        |
| ClusterRole `consul-consul-connect-injector`        | rbac.authorization.k8s.io/roles                       | create · delete · get · list · update · watch         | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}} {{< tag "Reconnaissance" >}}                                                                        |
| Role `consul-consul-connect-inject-leader-election` | core/configmaps/status                                | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/controlplanerequestlimits        | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/controlplanerequestlimits/status | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | apps/deployments                                      | create · delete · get · list · update · watch         | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | core/endpoints                                        | get · list · watch                                    | {{< risk Low >}}      |                                                                                                                                                                 |
| Role `consul-consul-connect-inject-leader-election` | core/events                                           | create · patch                                        | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/exportedservices                 | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/exportedservices/status          | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/gatewayclassconfigs              | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/gatewayclasses              | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/gatewayclasses/finalizers   | update                                                | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/gatewayclasses/status       | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/gatewaypolicies                  | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/gatewaypolicies/status           | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/gateways                    | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/gateways/finalizers         | update                                                | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/gateways/status             | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/httproutes                  | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/httproutes/finalizers       | update                                                | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/httproutes/status           | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/ingressgateways                  | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/ingressgateways/status           | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/jwtproviders                     | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/jwtproviders/status              | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | coordination.k8s.io/leases                            | create · get · list · update                          | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/meshes                           | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/meshes/status                    | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/meshservices                     | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | core/namespaces                                       | get · list · watch                                    | {{< risk Low >}}      | {{< tag "ClusterStructure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}}                                                                 |
| ClusterRole `consul-consul-connect-injector`        | core/nodes                                            | get · list · watch                                    | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | core/pods                                             | get · list · update · watch                           | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/proxydefaults                    | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/proxydefaults/status             | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/referencegrants             | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/registrations                    | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/registrations/status             | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/routeauthfilters                 | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/routeauthfilters/status          | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/routeretryfilters                | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/routetimeoutfilters              | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/samenessgroups                   | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/samenessgroups/status            | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | core/serviceaccounts                                  | create · delete · get · list · update · watch         | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/servicedefaults                  | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/servicedefaults/status           | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/serviceintentions                | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/serviceintentions/status         | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/serviceresolvers                 | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/serviceresolvers/status          | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/servicerouters                   | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/servicerouters/status            | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | core/services                                         | create · delete · get · list · update · watch         | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | core/services                                         | list · watch                                          | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/servicesplitters                 | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/servicesplitters/status          | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/tcproutes                   | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/tcproutes/finalizers        | update                                                | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/tcproutes/status            | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/terminatinggateways              | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/terminatinggateways/status       | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                 |

#### ⚠️ Potential Abuse (8)

The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Modify ConfigMaps in a namespace](/rules/1025)
- [Read RBAC configuration cluster-wide](/rules/1077)
- [Use privileged PodSecurityPolicy (deprecated)](/rules/1078)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)

#### 📦 Workloads (1)

| Kind       | Name                           | Container        | Image                                                                              |
| ---------- | ------------------------------ | ---------------- | ---------------------------------------------------------------------------------- |
| Deployment | consul-consul-connect-injector | sidecar-injector | docker.mirror.hashicorp.services/hashicorppreview/consul-k8s-control-plane:1.8-dev |

---

### 🤖 `consul-consul-webhook-cert-manager` {#sa-consul-consul-webhook-cert-manager}

**Namespace:** `default`  |  **Automount:** ❌

#### 🔑 Permissions (4)

| Role                                             | Resource                                                                 | Verbs                                                 | Risk                  | Tags                                                                                                                                                                    |
| ------------------------------------------------ | ------------------------------------------------------------------------ | ----------------------------------------------------- | --------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `consul-consul-webhook-cert-manager` | core/secrets                                                             | create · delete · get · list · patch · update · watch | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Persistence" >}} (+4 more) |
| ClusterRole `consul-consul-webhook-cert-manager` | admissionregistration.k8s.io/mutatingwebhookconfigurations               | get · list · patch · watch                            | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "WebhookReconnaissance" >}}                                                                    |
| ClusterRole `consul-consul-webhook-cert-manager` | admissionregistration.k8s.io/validatingwebhookconfigurations             | get · list · patch · watch                            | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "WebhookReconnaissance" >}}                                                                    |
| ClusterRole `consul-consul-webhook-cert-manager` | apps/deployments **(restricted to: consul-consul-webhook-cert-manager)** | get                                                   | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                    |

#### ⚠️ Potential Abuse (7)

The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Modify secrets cluster-wide](/rules/1012)
- [Modify secrets in a namespace](/rules/1013)
- [List ValidatingWebhookConfigurations (Reconnaissance)](/rules/1083)
- [List MutatingWebhookConfigurations (Reconnaissance)](/rules/1084)

#### 📦 Workloads (1)

| Kind       | Name                               | Container            | Image                                                                              |
| ---------- | ---------------------------------- | -------------------- | ---------------------------------------------------------------------------------- |
| Deployment | consul-consul-webhook-cert-manager | webhook-cert-manager | docker.mirror.hashicorp.services/hashicorppreview/consul-k8s-control-plane:1.8-dev |

---

### 🤖 `consul-consul-gateway-cleanup` {#sa-consul-consul-gateway-cleanup}

**Namespace:** `default`  |  **Automount:** ❌

#### 🔑 Permissions (2)

| Role                                        | Resource                                 | Verbs        | Risk             | Tags |
| ------------------------------------------- | ---------------------------------------- | ------------ | ---------------- | ---- |
| ClusterRole `consul-consul-gateway-cleanup` | consul.hashicorp.com/gatewayclassconfigs | delete · get | {{< risk Low >}} |      |
| ClusterRole `consul-consul-gateway-cleanup` | gateway.networking.k8s.io/gatewayclasses | delete · get | {{< risk Low >}} |      |

#### ⚠️ Potential Abuse (1)

The following security risks were found based on the above permissions:

#### 📦 Workloads (1)

| Kind | Name                          | Container       | Image                                                                              |
| ---- | ----------------------------- | --------------- | ---------------------------------------------------------------------------------- |
| Job  | consul-consul-gateway-cleanup | gateway-cleanup | docker.mirror.hashicorp.services/hashicorppreview/consul-k8s-control-plane:1.8-dev |

---

### 🤖 `consul-consul-gateway-resources` {#sa-consul-consul-gateway-resources}

**Namespace:** `default`  |  **Automount:** ❌

#### 🔑 Permissions (2)

| Role                                          | Resource                                 | Verbs                 | Risk             | Tags |
| --------------------------------------------- | ---------------------------------------- | --------------------- | ---------------- | ---- |
| ClusterRole `consul-consul-gateway-resources` | consul.hashicorp.com/gatewayclassconfigs | create · get · update | {{< risk Low >}} |      |
| ClusterRole `consul-consul-gateway-resources` | gateway.networking.k8s.io/gatewayclasses | create · get · update | {{< risk Low >}} |      |

#### ⚠️ Potential Abuse (1)

The following security risks were found based on the above permissions:

#### 📦 Workloads (1)

| Kind | Name                            | Container         | Image                                                                              |
| ---- | ------------------------------- | ----------------- | ---------------------------------------------------------------------------------- |
| Job  | consul-consul-gateway-resources | gateway-resources | docker.mirror.hashicorp.services/hashicorppreview/consul-k8s-control-plane:1.8-dev |

---

### 🤖 `consul-consul-server` {#sa-consul-consul-server}

**Namespace:** `default`  |  **Automount:** ❌

#### 🔑 Permissions (1)

| Role                               | Resource   | Verbs | Risk             | Tags |
| ---------------------------------- | ---------- | ----- | ---------------- | ---- |
| ClusterRole `consul-consul-server` | core/nodes | get   | {{< risk Low >}} |      |

#### ⚠️ Potential Abuse (1)

The following security risks were found based on the above permissions:

#### 📦 Workloads (1)

| Kind        | Name                 | Container | Image                                                             |
| ----------- | -------------------- | --------- | ----------------------------------------------------------------- |
| StatefulSet | consul-consul-server | consul    | docker.mirror.hashicorp.services/hashicorppreview/consul:1.21-dev |

---
