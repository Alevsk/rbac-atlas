---
title: "consul"
description: "Official HashiCorp Consul Chart"
version: v1.5.9
version_order: f0001f0005f0009
date: ""
service_accounts: 5
workloads: 6
bindings: 80
critical_findings: 3
high_findings: 1
medium_findings: 4
low_findings: 72
categories: []
tags:
  [
    ClusterStructure,
    ClusterWideSecretAccess,
    ConfigMapAccess,
    CredentialAccess,
    DataExposure,
    DeprecatedFeature,
    InformationDisclosure,
    NodeAccess,
    Persistence,
    PodSecurityPolicy,
    PotentialPrivilegeEscalation,
    PrivilegeEscalation,
    RBACQuery,
    Reconnaissance,
    ResourceNameRestricted,
    SecretAccess,
    Tampering,
    WebhookReconnaissance,
    letter-C,
  ]
---

## Description

Official HashiCorp Consul Chart

- https://github.com/hashicorp/consul
- https://github.com/hashicorp/consul-k8s

## Overview

| Identity                                                                       | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| ------------------------------------------------------------------------------ | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`consul-consul-connect-injector`](#sa-consul-consul-connect-injector)         | default   | âŒ        | â€”       | 65          | 1         | {{< risk "Critical" >}} |
| [`consul-consul-webhook-cert-manager`](#sa-consul-consul-webhook-cert-manager) | default   | âŒ        | â€”       | 4           | 1         | {{< risk "Critical" >}} |
| [`consul-consul-gateway-cleanup`](#sa-consul-consul-gateway-cleanup)           | default   | âŒ        | â€”       | 5           | 1         | {{< risk "Low" >}}      |
| [`consul-consul-gateway-resources`](#sa-consul-consul-gateway-resources)       | default   | âŒ        | â€”       | 5           | 1         | {{< risk "Low" >}}      |
| [`consul-consul-server`](#sa-consul-consul-server)                             | default   | âŒ        | â€”       | 1           | 1         | {{< risk "Low" >}}      |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### ğŸ¤– `consul-consul-connect-injector` {#sa-consul-consul-connect-injector}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (65)

| Role                                                | Resource                                              | Verbs                                                 | Risk                  | Tags                                                                                                                                                            |
| --------------------------------------------------- | ----------------------------------------------------- | ----------------------------------------------------- | --------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `consul-consul-connect-injector`        | policy/podsecuritypolicies                            | use                                                   | {{< risk Critical >}} | {{< tag "DeprecatedFeature" >}} {{< tag "NodeAccess" >}} {{< tag "PodSecurityPolicy" >}} {{< tag "PrivilegeEscalation" >}}                                      |
| ClusterRole `consul-consul-connect-injector`        | core/secrets                                          | create Â· delete Â· get Â· list Â· update Â· watch         | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}}  |
| Role `consul-consul-connect-inject-leader-election` | core/configmaps                                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}} |
| ClusterRole `consul-consul-connect-injector`        | rbac.authorization.k8s.io/rolebindings                | create Â· delete Â· get Â· list Â· update Â· watch         | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}} {{< tag "Reconnaissance" >}}                                                                        |
| ClusterRole `consul-consul-connect-injector`        | rbac.authorization.k8s.io/roles                       | create Â· delete Â· get Â· list Â· update Â· watch         | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}} {{< tag "Reconnaissance" >}}                                                                        |
| Role `consul-consul-connect-inject-leader-election` | core/configmaps/status                                | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/controlplanerequestlimits        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/controlplanerequestlimits/status | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | apps/deployments                                      | create Â· delete Â· get Â· list Â· update Â· watch         | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | core/endpoints                                        | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                 |
| Role `consul-consul-connect-inject-leader-election` | core/events                                           | create Â· patch                                        | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/exportedservices                 | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/exportedservices/status          | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/gatewayclassconfigs              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/gatewayclasses              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/gatewayclasses/finalizers   | update                                                | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/gatewayclasses/status       | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/gatewaypolicies                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/gatewaypolicies/status           | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/gateways                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/gateways/finalizers         | update                                                | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/gateways/status             | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/httproutes                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/httproutes/finalizers       | update                                                | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/httproutes/status           | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/ingressgateways                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/ingressgateways/status           | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/jwtproviders                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/jwtproviders/status              | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | coordination.k8s.io/leases                            | create Â· get Â· list Â· update                          | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/meshes                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/meshes/status                    | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/meshservices                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | core/namespaces                                       | get Â· list Â· watch                                    | {{< risk Low >}}      | {{< tag "ClusterStructure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}}                                                                 |
| ClusterRole `consul-consul-connect-injector`        | core/nodes                                            | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | core/pods                                             | get Â· list Â· update Â· watch                           | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/proxydefaults                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/proxydefaults/status             | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/referencegrants             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/registrations                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/registrations/status             | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/routeauthfilters                 | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/routeauthfilters/status          | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/routeretryfilters                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/routetimeoutfilters              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/samenessgroups                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/samenessgroups/status            | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | core/serviceaccounts                                  | create Â· delete Â· get Â· list Â· update Â· watch         | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/servicedefaults                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/servicedefaults/status           | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/serviceintentions                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/serviceintentions/status         | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/serviceresolvers                 | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/serviceresolvers/status          | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/servicerouters                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/servicerouters/status            | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | core/services                                         | create Â· delete Â· get Â· list Â· update Â· watch         | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | core/services                                         | list Â· watch                                          | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/servicesplitters                 | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/servicesplitters/status          | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/tcproutes                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/tcproutes/finalizers        | update                                                | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | gateway.networking.k8s.io/tcproutes/status            | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/terminatinggateways              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `consul-consul-connect-injector`        | consul.hashicorp.com/terminatinggateways/status       | get Â· patch Â· update                                  | {{< risk Low >}}      |                                                                                                                                                                 |

#### âš ï¸ Potential Abuse (8)

The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Modify ConfigMaps in a namespace](/rules/1025)
- [Read RBAC configuration cluster-wide](/rules/1077)
- [Use privileged PodSecurityPolicy (deprecated)](/rules/1078)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)

#### ğŸ“¦ Workloads (1)

| Kind       | Name                           | Container        | Image                                    |
| ---------- | ------------------------------ | ---------------- | ---------------------------------------- |
| Deployment | consul-consul-connect-injector | sidecar-injector | hashicorp/consul-k8s-control-plane:1.5.9 |

---

### ğŸ¤– `consul-consul-webhook-cert-manager` {#sa-consul-consul-webhook-cert-manager}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (4)

| Role                                             | Resource                                                                 | Verbs                                                 | Risk                  | Tags                                                                                                                                                                    |
| ------------------------------------------------ | ------------------------------------------------------------------------ | ----------------------------------------------------- | --------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `consul-consul-webhook-cert-manager` | core/secrets                                                             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Persistence" >}} (+4 more) |
| ClusterRole `consul-consul-webhook-cert-manager` | admissionregistration.k8s.io/mutatingwebhookconfigurations               | get Â· list Â· patch Â· watch                            | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "WebhookReconnaissance" >}}                                                                    |
| ClusterRole `consul-consul-webhook-cert-manager` | admissionregistration.k8s.io/validatingwebhookconfigurations             | get Â· list Â· patch Â· watch                            | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "WebhookReconnaissance" >}}                                                                    |
| ClusterRole `consul-consul-webhook-cert-manager` | apps/deployments **(restricted to: consul-consul-webhook-cert-manager)** | get                                                   | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                    |

#### âš ï¸ Potential Abuse (7)

The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Modify secrets cluster-wide](/rules/1012)
- [Modify secrets in a namespace](/rules/1013)
- [List ValidatingWebhookConfigurations (Reconnaissance)](/rules/1083)
- [List MutatingWebhookConfigurations (Reconnaissance)](/rules/1084)

#### ğŸ“¦ Workloads (1)

| Kind       | Name                               | Container            | Image                                    |
| ---------- | ---------------------------------- | -------------------- | ---------------------------------------- |
| Deployment | consul-consul-webhook-cert-manager | webhook-cert-manager | hashicorp/consul-k8s-control-plane:1.5.9 |

---

### ğŸ¤– `consul-consul-gateway-cleanup` {#sa-consul-consul-gateway-cleanup}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (5)

| Role                                        | Resource                                      | Verbs        | Risk             | Tags |
| ------------------------------------------- | --------------------------------------------- | ------------ | ---------------- | ---- |
| ClusterRole `consul-consul-gateway-cleanup` | consul.hashicorp.com/gatewayclassconfigs      | delete Â· get | {{< risk Low >}} |      |
| ClusterRole `consul-consul-gateway-cleanup` | mesh.consul.hashicorp.com/gatewayclassconfigs | delete Â· get | {{< risk Low >}} |      |
| ClusterRole `consul-consul-gateway-cleanup` | gateway.networking.k8s.io/gatewayclasses      | delete Â· get | {{< risk Low >}} |      |
| ClusterRole `consul-consul-gateway-cleanup` | mesh.consul.hashicorp.com/gatewayclasses      | delete Â· get | {{< risk Low >}} |      |
| ClusterRole `consul-consul-gateway-cleanup` | mesh.consul.hashicorp.com/meshgateways        | delete Â· get | {{< risk Low >}} |      |

#### âš ï¸ Potential Abuse (1)

The following security risks were found based on the above permissions:

#### ğŸ“¦ Workloads (1)

| Kind | Name                          | Container       | Image                                    |
| ---- | ----------------------------- | --------------- | ---------------------------------------- |
| Job  | consul-consul-gateway-cleanup | gateway-cleanup | hashicorp/consul-k8s-control-plane:1.5.9 |

---

### ğŸ¤– `consul-consul-gateway-resources` {#sa-consul-consul-gateway-resources}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (5)

| Role                                          | Resource                                      | Verbs                 | Risk             | Tags |
| --------------------------------------------- | --------------------------------------------- | --------------------- | ---------------- | ---- |
| ClusterRole `consul-consul-gateway-resources` | consul.hashicorp.com/gatewayclassconfigs      | create Â· get Â· update | {{< risk Low >}} |      |
| ClusterRole `consul-consul-gateway-resources` | mesh.consul.hashicorp.com/gatewayclassconfigs | create Â· get Â· update | {{< risk Low >}} |      |
| ClusterRole `consul-consul-gateway-resources` | gateway.networking.k8s.io/gatewayclasses      | create Â· get Â· update | {{< risk Low >}} |      |
| ClusterRole `consul-consul-gateway-resources` | mesh.consul.hashicorp.com/gatewayclasses      | create Â· get Â· update | {{< risk Low >}} |      |
| ClusterRole `consul-consul-gateway-resources` | mesh.consul.hashicorp.com/meshgateways        | create Â· get Â· update | {{< risk Low >}} |      |

#### âš ï¸ Potential Abuse (1)

The following security risks were found based on the above permissions:

#### ğŸ“¦ Workloads (1)

| Kind | Name                            | Container         | Image                                    |
| ---- | ------------------------------- | ----------------- | ---------------------------------------- |
| Job  | consul-consul-gateway-resources | gateway-resources | hashicorp/consul-k8s-control-plane:1.5.9 |

---

### ğŸ¤– `consul-consul-server` {#sa-consul-consul-server}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (1)

| Role                               | Resource   | Verbs | Risk             | Tags |
| ---------------------------------- | ---------- | ----- | ---------------- | ---- |
| ClusterRole `consul-consul-server` | core/nodes | get   | {{< risk Low >}} |      |

#### âš ï¸ Potential Abuse (1)

The following security risks were found based on the above permissions:

#### ğŸ“¦ Workloads (1)

| Kind        | Name                 | Container | Image                   |
| ----------- | -------------------- | --------- | ----------------------- |
| StatefulSet | consul-consul-server | consul    | hashicorp/consul:1.19.2 |

---
