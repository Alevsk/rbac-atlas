---
title: "appmesh-spire-agent"
description: "SPIRE Agent Helm chart for AppMesh mTLS support on Kubernetes"
version: v1.0.3
version_order: f0001f0000f0003
date: ""
service_accounts: 1
workloads: 1
bindings: 3
critical_findings: 1
high_findings: 0
medium_findings: 0
low_findings: 2
categories: [eks, appmesh, spire]
tags:
  [AuthorizationBypass, ClusterAdminAccess, CodeExecution, ElevationOfPrivilege, LateralMovement, NodeAccess, letter-A]
---

## Description

SPIRE Agent Helm chart for AppMesh mTLS support on Kubernetes

- https://github.com/aws/eks-charts

## Overview

| Identity                         | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| -------------------------------- | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`spire-agent`](#sa-spire-agent) | default   | ‚ùå        | ‚Äî       | 3           | 1         | {{< risk "Critical" >}} |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### ü§ñ `spire-agent` {#sa-spire-agent}

**Namespace:** `default` ¬†|¬† **Automount:** ‚ùå

#### üîë Permissions (3)

| Role                           | Resource         | Verbs | Risk                  | Tags                                                                                                                                                                      |
| ------------------------------ | ---------------- | ----- | --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `spire-agent-role` | core/nodes/proxy | get   | {{< risk Critical >}} | {{< tag "AuthorizationBypass" >}} {{< tag "ClusterAdminAccess" >}} {{< tag "CodeExecution" >}} {{< tag "ElevationOfPrivilege" >}} {{< tag "LateralMovement" >}} (+1 more) |
| ClusterRole `spire-agent-role` | core/nodes       | get   | {{< risk Low >}}      |                                                                                                                                                                           |
| ClusterRole `spire-agent-role` | core/pods        | get   | {{< risk Low >}}      |                                                                                                                                                                           |

#### ‚ö†Ô∏è Potential Abuse (2)

The following security risks were found based on the above permissions:

- [Node proxy GET RCE via WebSocket](/rules/1104)

#### üì¶ Workloads (1)

| Kind      | Name        | Container           | Image                              |
| --------- | ----------- | ------------------- | ---------------------------------- |
| DaemonSet | spire-agent | appmesh-spire-agent | gcr.io/spiffe-io/spire-agent:1.0.0 |

---
