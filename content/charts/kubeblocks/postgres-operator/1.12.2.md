---
title: "postgres-operator"
description: "Postgres Operator creates and manages PostgreSQL clusters running in Kubernetes"
version: v1.12.2
version_order: f0001f000cf0002
date: ""
service_accounts: 1
workloads: 1
bindings: 22
critical_findings: 5
high_findings: 0
medium_findings: 1
low_findings: 16
categories: [postgres, operator, cloud-native, patroni, spilo]
tags:
  [
    ClusterWidePodExec,
    CodeExecution,
    DenialOfService,
    ElevationOfPrivilege,
    InformationDisclosure,
    LateralMovement,
    ManInTheMiddle,
    NetworkManipulation,
    OperationalData,
    Persistence,
    PodExec,
    PotentialPrivilegeEscalation,
    PrivilegeEscalation,
    Reconnaissance,
    ServiceExposure,
    Tampering,
    TrafficRedirection,
    WorkloadExecution,
    WorkloadLifecycle,
    letter-P,
  ]
---

## Description

Postgres Operator creates and manages PostgreSQL clusters running in Kubernetes

- https://github.com/zalando/postgres-operator

## Overview

| Identity                                     | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| -------------------------------------------- | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`postgres-operator`](#sa-postgres-operator) | default   | ❌        | —       | 22          | 1         | {{< risk "Critical" >}} |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### 🤖 `postgres-operator` {#sa-postgres-operator}

**Namespace:** `default`  |  **Automount:** ❌

#### 🔑 Permissions (22)

| Role                            | Resource                                       | Verbs                                                                    | Risk                  | Tags                                                                                                                                                           |
| ------------------------------- | ---------------------------------------------- | ------------------------------------------------------------------------ | --------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `postgres-operator` | batch/cronjobs                                 | create · delete · get · list · patch · update                            | {{< risk Critical >}} | {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}} |
| ClusterRole `postgres-operator` | core/endpoints                                 | create · delete · deletecollection · get · list · patch · update · watch | {{< risk Critical >}} | {{< tag "DenialOfService" >}} {{< tag "ManInTheMiddle" >}} {{< tag "NetworkManipulation" >}} {{< tag "Tampering" >}} {{< tag "TrafficRedirection" >}}          |
| ClusterRole `postgres-operator` | core/pods                                      | delete · get · list · patch · update · watch                             | {{< risk Critical >}} | {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadExecution" >}}                           |
| ClusterRole `postgres-operator` | core/pods/exec                                 | create                                                                   | {{< risk Critical >}} | {{< tag "ClusterWidePodExec" >}} {{< tag "CodeExecution" >}} {{< tag "ElevationOfPrivilege" >}} {{< tag "LateralMovement" >}} {{< tag "PodExec" >}} (+1 more)  |
| ClusterRole `postgres-operator` | core/services                                  | create · delete · get · patch · update                                   | {{< risk Critical >}} | {{< tag "DenialOfService" >}} {{< tag "NetworkManipulation" >}} {{< tag "ServiceExposure" >}} {{< tag "Tampering" >}}                                          |
| ClusterRole `postgres-operator` | core/events                                    | create · get · list · patch · update · watch                             | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "OperationalData" >}} {{< tag "Reconnaissance" >}}                                                                 |
| ClusterRole `postgres-operator` | core/configmaps                                | get                                                                      | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | apiextensions.k8s.io/customresourcedefinitions | create · get · patch · update                                            | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | apps/deployments                               | create · delete · get · list · patch                                     | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | core/namespaces                                | get                                                                      | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | core/nodes                                     | get · list · watch                                                       | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | acid.zalan.do/operatorconfigurations           | create · delete · deletecollection · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | core/persistentvolumeclaims                    | delete · get · list · patch · update                                     | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | core/persistentvolumes                         | get · list                                                               | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | policy/poddisruptionbudgets                    | create · delete · get                                                    | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | acid.zalan.do/postgresqls                      | create · delete · deletecollection · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | acid.zalan.do/postgresqls/status               | create · delete · deletecollection · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | acid.zalan.do/postgresteams                    | get · list · watch                                                       | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | rbac.authorization.k8s.io/rolebindings         | create · get                                                             | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | core/secrets                                   | create · delete · get · update                                           | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | core/serviceaccounts                           | create · get                                                             | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `postgres-operator` | apps/statefulsets                              | create · delete · get · list · patch                                     | {{< risk Low >}}      |                                                                                                                                                                |

#### ⚠️ Potential Abuse (12)

The following security risks were found based on the above permissions:

- [Cluster-wide pod exec](/rules/1000)
- [Namespaced pod exec](/rules/1001)
- [Update/Patch pods cluster-wide](/rules/1008)
- [Update/Patch pods in a namespace](/rules/1009)
- [Manage CronJobs cluster-wide (scheduled privileged execution, persistence)](/rules/1039)
- [Manage CronJobs in a namespace (scheduled privileged execution, persistence)](/rules/1040)
- [Read events cluster-wide](/rules/1070)
- [Manage Endpoints or EndpointSlices cluster-wide](/rules/1073)
- [Manage Endpoints or EndpointSlices in a namespace](/rules/1074)
- [Manage Services cluster-wide](/rules/1075)
- [Manage Services in a namespace](/rules/1076)

#### 📦 Workloads (1)

| Kind       | Name              | Container         | Image                                     |
| ---------- | ----------------- | ----------------- | ----------------------------------------- |
| Deployment | postgres-operator | postgres-operator | ghcr.io/zalando/postgres-operator:v1.12.2 |

---
