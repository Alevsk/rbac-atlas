---
title: "stackgres-operator"
description: "StackGres Operator"
version: v0.9.3
version_order: f0000f0009f0003
date: ""
service_accounts: 11
workloads: 9
bindings: 167
critical_findings: 18
high_findings: 15
medium_findings: 5
low_findings: 129
categories: []
tags:
  [
    AuthorizationBypass,
    BindingToPrivilegedRole,
    CRDManipulation,
    ClusterAdminAccess,
    ClusterStructure,
    ClusterWideAccess,
    ClusterWidePodExec,
    ClusterWideSecretAccess,
    CodeExecution,
    ConfigMapAccess,
    CredentialAccess,
    DataExposure,
    DenialOfService,
    DeprecatedFeature,
    ElevationOfPrivilege,
    IdentityManagement,
    Impersonation,
    InformationDisclosure,
    LateralMovement,
    ManInTheMiddle,
    NamespaceLifecycle,
    NetworkManipulation,
    NodeAccess,
    OperationalData,
    Persistence,
    PodExec,
    PodSecurityPolicy,
    PotentialPrivilegeEscalation,
    PrivilegeEscalation,
    QuotaTampering,
    RBACManipulation,
    RBACQuery,
    Reconnaissance,
    ResourceConfiguration,
    ResourceDeletion,
    ResourceNameRestricted,
    SecretAccess,
    ServiceExposure,
    Spoofing,
    Tampering,
    TrafficRedirection,
    WebhookReconnaissance,
    WildcardPermission,
    WorkloadExecution,
    WorkloadLifecycle,
    letter-S,
  ]
---

## Description

StackGres Operator

- https://gitlab.com/ongresinc/stackgres

## Overview

| Identity                                                                                         | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| ------------------------------------------------------------------------------------------------ | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`stackgres-operator`](#sa-stackgres-operator)                                                   | default   | âŒ        | â€”       | 90          | 1         | {{< risk "Critical" >}} |
| [`stackgres-operator-grafana`](#sa-stackgres-operator-grafana)                                   | default   | âŒ        | â€”       | 3           | 2         | {{< risk "Critical" >}} |
| [`stackgres-operator-kube-state-metrics`](#sa-stackgres-operator-kube-state-metrics)             | default   | âŒ        | â€”       | 33          | 1         | {{< risk "Critical" >}} |
| [`stackgres-operator-prometh-operator`](#sa-stackgres-operator-prometh-operator)                 | default   | âŒ        | â€”       | 20          | 2         | {{< risk "Critical" >}} |
| [`stackgres-operator-prometh-prometheus`](#sa-stackgres-operator-prometh-prometheus)             | default   | âŒ        | â€”       | 9           | 0         | {{< risk "Critical" >}} |
| [`stackgres-restapi`](#sa-stackgres-restapi)                                                     | default   | âŒ        | â€”       | 5           | 2         | {{< risk "Critical" >}} |
| [`stackgres-operator-grafana-test`](#sa-stackgres-operator-grafana-test)                         | default   | âŒ        | â€”       | 1           | 1         | {{< risk "Low" >}}      |
| [`stackgres-operator-prometh-admission`](#sa-stackgres-operator-prometh-admission)               | default   | âŒ        | â€”       | 4           | 2         | {{< risk "Low" >}}      |
| [`stackgres-operator-prometh-alertmanager`](#sa-stackgres-operator-prometh-alertmanager)         | default   | âŒ        | â€”       | 1           | 0         | {{< risk "Low" >}}      |
| [`stackgres-operator-prometheus-node-exporter`](#sa-stackgres-operator-prometheus-node-exporter) | default   | âŒ        | â€”       | 1           | 1         | {{< risk "Low" >}}      |
| [`stackgres-operator-init`](#sa-stackgres-operator-init)                                         | default   | âŒ        | â€”       | 0           | 4         | â€”                       |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### ğŸ¤– `stackgres-operator` {#sa-stackgres-operator}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (90)

| Role                             | Resource                                                                 | Verbs                                                 | Risk                  | Tags                                                                                                                                                                         |
| -------------------------------- | ------------------------------------------------------------------------ | ----------------------------------------------------- | --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `stackgres-operator` | core/configmaps                                                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}              |
| ClusterRole `stackgres-operator` | batch/cronjobs                                                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}               |
| ClusterRole `stackgres-operator` | core/endpoints                                                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "DenialOfService" >}} {{< tag "ManInTheMiddle" >}} {{< tag "NetworkManipulation" >}} {{< tag "Tampering" >}} {{< tag "TrafficRedirection" >}}                        |
| ClusterRole `stackgres-operator` | batch/jobs                                                               | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}                                         |
| ClusterRole `stackgres-operator` | core/pods                                                                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "LateralMovement" >}} {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} (+1 more)       |
| ClusterRole `stackgres-operator` | core/pods/exec                                                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ClusterWidePodExec" >}} {{< tag "CodeExecution" >}} {{< tag "ElevationOfPrivilege" >}} {{< tag "LateralMovement" >}} {{< tag "PodExec" >}} (+1 more)                |
| ClusterRole `stackgres-operator` | core/secrets                                                             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Persistence" >}} (+4 more)      |
| ClusterRole `stackgres-operator` | core/services                                                            | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "DenialOfService" >}} {{< tag "NetworkManipulation" >}} {{< tag "ServiceExposure" >}} {{< tag "Tampering" >}}                                                        |
| ClusterRole `stackgres-operator` | apps/statefulsets                                                        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}               |
| ClusterRole `stackgres-operator` | core/namespaces                                                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "ClusterStructure" >}} {{< tag "DenialOfService" >}} {{< tag "InformationDisclosure" >}} {{< tag "NamespaceLifecycle" >}} {{< tag "Reconnaissance" >}} (+1 more)     |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/rolebindings                                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "BindingToPrivilegedRole" >}} {{< tag "InformationDisclosure" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}} {{< tag "RBACQuery" >}} (+1 more) |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/roles                                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "InformationDisclosure" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}} {{< tag "RBACQuery" >}} {{< tag "Reconnaissance" >}}                    |
| ClusterRole `stackgres-operator` | core/serviceaccounts                                                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "IdentityManagement" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}                                                                          |
| ClusterRole `stackgres-operator` | core/events                                                              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "OperationalData" >}} {{< tag "Reconnaissance" >}}                                                                               |
| ClusterRole `stackgres-operator` | apps/configmaps                                                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/configmaps                                                         | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/configmaps                                                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/configmaps                                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/cronjobs                                                            | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/cronjobs                                                            | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/cronjobs                                                      | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/cronjobs                                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions                           | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | customresourcedefinitions.apiextensions.k8s.io/customresourcedefinitions | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/endpoints                                                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/endpoints                                                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/endpoints                                                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/endpoints                                      | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/events                                                              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/events                                                             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/events                                                        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/events                                         | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/jobs                                                                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/jobs                                                                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/jobs                                                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/jobs                                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/namespaces                                                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/namespaces                                                         | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/namespaces                                                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/namespaces                                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/persistentvolumeclaims                                              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/persistentvolumeclaims                                             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/persistentvolumeclaims                                              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/persistentvolumeclaims                                        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/persistentvolumeclaims                         | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | monitoring.coreos.com/podmonitors                                        | get Â· list                                            | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/pods                                                                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/pods                                                               | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/pods                                                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/pods                                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/pods/exec                                                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/pods/exec                                                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/pods/exec                                                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/pods/exec                                      | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | monitoring.coreos.com/prometheus                                         | get Â· list                                            | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | monitoring.coreos.com/prometheuses                                       | get Â· list                                            | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/rolebindings                                                        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/rolebindings                                                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/rolebindings                                                        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/rolebindings                                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/roles                                                               | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/roles                                                              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/roles                                                               | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/roles                                                         | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/secrets                                                             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/secrets                                                            | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/secrets                                                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/secrets                                        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/serviceaccounts                                                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/serviceaccounts                                                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/serviceaccounts                                               | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/serviceaccounts                                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | monitoring.coreos.com/servicemonitors                                    | create Â· delete Â· get Â· list Â· patch Â· update         | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/services                                                            | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/services                                                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/services                                                      | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/services                                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgbackupconfigs                                             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgbackups                                                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgclusters                                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgdistributedlogs                                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sginstanceprofiles                                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgpgconfigs                                                 | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgpoolconfigs                                               | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgrestoreconfigs                                            | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/statefulsets                                                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/statefulsets                                                        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/statefulsets                                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/statefulsets                                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | storage.k8s.io/storageclasses                                            | get Â· list                                            | {{< risk Low >}}      |                                                                                                                                                                              |

#### âš ï¸ Potential Abuse (33)

The following security risks were found based on the above permissions:

- [Cluster-wide pod exec](/rules/1000)
- [Namespaced pod exec](/rules/1001)
- [Create pods cluster-wide](/rules/1006)
- [Create pods in a namespace](/rules/1007)
- [Update/Patch pods cluster-wide](/rules/1008)
- [Update/Patch pods in a namespace](/rules/1009)
- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Modify secrets cluster-wide](/rules/1012)
- [Modify secrets in a namespace](/rules/1013)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Modify ConfigMaps cluster-wide](/rules/1024)
- [Modify ConfigMaps in a namespace](/rules/1025)
- [Delete namespaces](/rules/1026)
- [Manage Roles in a namespace (create, update, patch, delete)](/rules/1029)
- [Manage RoleBindings in a namespace (create, update, patch, delete)](/rules/1030)
- [Manage StatefulSets cluster-wide](/rules/1037)
- [Manage StatefulSets in a namespace](/rules/1038)
- [Manage CronJobs cluster-wide (scheduled privileged execution, persistence)](/rules/1039)
- [Manage CronJobs in a namespace (scheduled privileged execution, persistence)](/rules/1040)
- [Manage Jobs cluster-wide (one-off privileged execution)](/rules/1041)
- [Manage Jobs in a namespace (one-off privileged execution)](/rules/1042)
- [Manage ServiceAccounts cluster-wide](/rules/1067)
- [Manage ServiceAccounts in a namespace](/rules/1068)
- [Read events cluster-wide](/rules/1070)
- [Manage Endpoints or EndpointSlices cluster-wide](/rules/1073)
- [Manage Endpoints or EndpointSlices in a namespace](/rules/1074)
- [Manage Services cluster-wide](/rules/1075)
- [Manage Services in a namespace](/rules/1076)
- [Read RBAC configuration cluster-wide](/rules/1077)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)

#### ğŸ“¦ Workloads (1)

| Kind       | Name               | Container          | Image                        |
| ---------- | ------------------ | ------------------ | ---------------------------- |
| Deployment | stackgres-operator | stackgres-operator | stackgres/operator:0.9.3-jvm |

---

### ğŸ¤– `stackgres-operator-kube-state-metrics` {#sa-stackgres-operator-kube-state-metrics}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (33)

| Role                                                    | Resource                                                                              | Verbs        | Risk                  | Tags                                                                                                                                                            |
| ------------------------------------------------------- | ------------------------------------------------------------------------------------- | ------------ | --------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `stackgres-operator-kube-state-metrics`     | core/secrets                                                                          | list Â· watch | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}}  |
| ClusterRole `stackgres-operator-kube-state-metrics`     | core/configmaps                                                                       | list Â· watch | {{< risk High >}}     | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}}                                                                    |
| ClusterRole `stackgres-operator-kube-state-metrics`     | admissionregistration.k8s.io/mutatingwebhookconfigurations                            | list Â· watch | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "WebhookReconnaissance" >}}                                                            |
| ClusterRole `stackgres-operator-kube-state-metrics`     | core/resourcequotas                                                                   | list Â· watch | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "QuotaTampering" >}} {{< tag "Reconnaissance" >}} {{< tag "ResourceConfiguration" >}}                               |
| ClusterRole `stackgres-operator-kube-state-metrics`     | admissionregistration.k8s.io/validatingwebhookconfigurations                          | list Â· watch | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "WebhookReconnaissance" >}}                                                            |
| ClusterRole `stackgres-operator-kube-state-metrics`     | certificates.k8s.io/certificatesigningrequests                                        | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | batch/cronjobs                                                                        | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | apps/daemonsets                                                                       | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | extensions/daemonsets                                                                 | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | apps/deployments                                                                      | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | extensions/deployments                                                                | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | core/endpoints                                                                        | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | autoscaling/horizontalpodautoscalers                                                  | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | extensions/ingresses                                                                  | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | networking.k8s.io/ingresses                                                           | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | batch/jobs                                                                            | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | core/limitranges                                                                      | list Â· watch | {{< risk Low >}}      | {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "ResourceConfiguration" >}}                                                            |
| ClusterRole `stackgres-operator-kube-state-metrics`     | core/namespaces                                                                       | list Â· watch | {{< risk Low >}}      | {{< tag "ClusterStructure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}}                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | networking.k8s.io/networkpolicies                                                     | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | core/nodes                                                                            | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | core/persistentvolumeclaims                                                           | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | core/persistentvolumes                                                                | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | policy/poddisruptionbudgets                                                           | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | core/pods                                                                             | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | apps/replicasets                                                                      | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | extensions/replicasets                                                                | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | core/replicationcontrollers                                                           | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | core/services                                                                         | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | apps/statefulsets                                                                     | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | storage.k8s.io/storageclasses                                                         | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | autoscaling.k8s.io/verticalpodautoscalers                                             | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-kube-state-metrics`     | storage.k8s.io/volumeattachments                                                      | list Â· watch | {{< risk Low >}}      |                                                                                                                                                                 |
| ClusterRole `psp-stackgres-operator-kube-state-metrics` | policy/podsecuritypolicies **(restricted to: stackgres-operator-kube-state-metrics)** | use          | {{< risk Low >}}      | {{< tag "DeprecatedFeature" >}} {{< tag "NodeAccess" >}} {{< tag "PodSecurityPolicy" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "ResourceNameRestricted" >}} |

#### âš ï¸ Potential Abuse (12)

The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Use privileged PodSecurityPolicy (deprecated)](/rules/1078)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)
- [List ValidatingWebhookConfigurations (Reconnaissance)](/rules/1083)
- [List MutatingWebhookConfigurations (Reconnaissance)](/rules/1084)
- [Read LimitRanges (Namespace Information Disclosure)](/rules/1087)
- [Read ResourceQuotas (Namespace Information Disclosure)](/rules/1088)
- [Read All ResourceQuotas (Cluster-wide Information Disclosure)](/rules/1089)

#### ğŸ“¦ Workloads (1)

| Kind       | Name                                  | Container          | Image                                    |
| ---------- | ------------------------------------- | ------------------ | ---------------------------------------- |
| Deployment | stackgres-operator-kube-state-metrics | kube-state-metrics | quay.io/coreos/kube-state-metrics:v1.9.5 |

---

### ğŸ¤– `stackgres-operator-prometh-operator` {#sa-stackgres-operator-prometh-operator}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (20)

| Role                                                  | Resource                                                                            | Verbs                          | Risk                  | Tags                                                                                                                                                                              |
| ----------------------------------------------------- | ----------------------------------------------------------------------------------- | ------------------------------ | --------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `stackgres-operator-prometh-operator`     | core/configmaps                                                                     | \*                             | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} (+2 more) |
| ClusterRole `stackgres-operator-prometh-operator`     | apiextensions.k8s.io/customresourcedefinitions                                      | \*                             | {{< risk Critical >}} | {{< tag "CRDManipulation" >}} {{< tag "ClusterWideAccess" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WildcardPermission" >}}                 |
| ClusterRole `stackgres-operator-prometh-operator`     | core/secrets                                                                        | \*                             | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} (+6 more)     |
| ClusterRole `stackgres-operator-prometh-operator`     | apps/statefulsets                                                                   | \*                             | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} (+2 more)          |
| ClusterRole `stackgres-operator-prometh-operator`     | monitoring.coreos.com/alertmanagers                                                 | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `stackgres-operator-prometh-operator`     | monitoring.coreos.com/alertmanagers/finalizers                                      | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `stackgres-operator-prometh-operator`     | monitoring.coreos.com/podmonitors                                                   | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `stackgres-operator-prometh-operator`     | monitoring.coreos.com/prometheuses                                                  | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `stackgres-operator-prometh-operator`     | monitoring.coreos.com/prometheuses/finalizers                                       | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `stackgres-operator-prometh-operator`     | monitoring.coreos.com/prometheusrules                                               | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `stackgres-operator-prometh-operator`     | monitoring.coreos.com/servicemonitors                                               | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `stackgres-operator-prometh-operator`     | monitoring.coreos.com/thanosrulers                                                  | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `stackgres-operator-prometh-operator`     | monitoring.coreos.com/thanosrulers/finalizers                                       | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `stackgres-operator-prometh-operator`     | core/endpoints                                                                      | create Â· delete Â· get Â· update | {{< risk Low >}}      |                                                                                                                                                                                   |
| ClusterRole `stackgres-operator-prometh-operator`     | core/namespaces                                                                     | get Â· list Â· watch             | {{< risk Low >}}      | {{< tag "ClusterStructure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}}                                                                                   |
| ClusterRole `stackgres-operator-prometh-operator`     | core/nodes                                                                          | list Â· watch                   | {{< risk Low >}}      |                                                                                                                                                                                   |
| ClusterRole `stackgres-operator-prometh-operator`     | core/pods                                                                           | delete Â· list                  | {{< risk Low >}}      |                                                                                                                                                                                   |
| ClusterRole `stackgres-operator-prometh-operator`     | core/services                                                                       | create Â· delete Â· get Â· update | {{< risk Low >}}      |                                                                                                                                                                                   |
| ClusterRole `stackgres-operator-prometh-operator`     | core/services/finalizers                                                            | create Â· delete Â· get Â· update | {{< risk Low >}}      |                                                                                                                                                                                   |
| ClusterRole `stackgres-operator-prometh-operator-psp` | policy/podsecuritypolicies **(restricted to: stackgres-operator-prometh-operator)** | use                            | {{< risk Low >}}      | {{< tag "DeprecatedFeature" >}} {{< tag "NodeAccess" >}} {{< tag "PodSecurityPolicy" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "ResourceNameRestricted" >}}                   |

#### âš ï¸ Potential Abuse (15)

The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Modify secrets cluster-wide](/rules/1012)
- [Modify secrets in a namespace](/rules/1013)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Modify ConfigMaps cluster-wide](/rules/1024)
- [Modify ConfigMaps in a namespace](/rules/1025)
- [Manage StatefulSets cluster-wide](/rules/1037)
- [Manage StatefulSets in a namespace](/rules/1038)
- [Manage CustomResourceDefinitions](/rules/1045)
- [Use privileged PodSecurityPolicy (deprecated)](/rules/1078)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)

#### ğŸ“¦ Workloads (2)

| Kind       | Name                                | Container           | Image                                      |
| ---------- | ----------------------------------- | ------------------- | ------------------------------------------ |
| Deployment | stackgres-operator-prometh-operator | prometheus-operator | quay.io/coreos/prometheus-operator:v0.38.1 |
| Deployment | stackgres-operator-prometh-operator | tls-proxy           | squareup/ghostunnel:v1.5.2                 |

---

### ğŸ¤– `stackgres-operator-prometh-prometheus` {#sa-stackgres-operator-prometh-prometheus}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (9)

| Role                                                    | Resource                                                                              | Verbs              | Risk                  | Tags                                                                                                                                                                      |
| ------------------------------------------------------- | ------------------------------------------------------------------------------------- | ------------------ | --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `stackgres-operator-prometh-prometheus`     | core/nodes/proxy                                                                      | get Â· list Â· watch | {{< risk Critical >}} | {{< tag "AuthorizationBypass" >}} {{< tag "ClusterAdminAccess" >}} {{< tag "CodeExecution" >}} {{< tag "ElevationOfPrivilege" >}} {{< tag "LateralMovement" >}} (+1 more) |
| ClusterRole `stackgres-operator-prometh-prometheus`     | core/endpoints                                                                        | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                           |
| ClusterRole `stackgres-operator-prometh-prometheus`     | extensions/ingresses                                                                  | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                           |
| ClusterRole `stackgres-operator-prometh-prometheus`     | networking.k8s.io/ingresses                                                           | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                           |
| ClusterRole `stackgres-operator-prometh-prometheus`     | core/nodes                                                                            | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                           |
| ClusterRole `stackgres-operator-prometh-prometheus`     | core/nodes/metrics                                                                    | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                           |
| ClusterRole `stackgres-operator-prometh-prometheus`     | core/pods                                                                             | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                           |
| ClusterRole `stackgres-operator-prometh-prometheus`     | core/services                                                                         | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                           |
| ClusterRole `stackgres-operator-prometh-prometheus-psp` | policy/podsecuritypolicies **(restricted to: stackgres-operator-prometh-prometheus)** | use                | {{< risk Low >}}      | {{< tag "DeprecatedFeature" >}} {{< tag "NodeAccess" >}} {{< tag "PodSecurityPolicy" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "ResourceNameRestricted" >}}           |

#### âš ï¸ Potential Abuse (3)

The following security risks were found based on the above permissions:

- [Use privileged PodSecurityPolicy (deprecated)](/rules/1078)
- [Node proxy GET RCE via WebSocket](/rules/1104)

#### ğŸ“¦ Workloads (0)

_No workloads use this ServiceAccount._

---

### ğŸ¤– `stackgres-restapi` {#sa-stackgres-restapi}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (5)

| Role                            | Resource                                  | Verbs       | Risk                  | Tags                                                                                                                  |
| ------------------------------- | ----------------------------------------- | ----------- | --------------------- | --------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `stackgres-restapi` | core/groups                               | impersonate | {{< risk Critical >}} | {{< tag "ClusterAdminAccess" >}} {{< tag "Impersonation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Spoofing" >}} |
| ClusterRole `stackgres-restapi` | core/users                                | impersonate | {{< risk Critical >}} | {{< tag "ClusterAdminAccess" >}} {{< tag "Impersonation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Spoofing" >}} |
| ClusterRole `stackgres-restapi` | authorization.k8s.io/subjectaccessreviews | create      | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                           |
| ClusterRole `stackgres-restapi` | core/secrets                              | get Â· list  | {{< risk Low >}}      |                                                                                                                       |
| ClusterRole `stackgres-restapi` | core/serviceaccount                       | impersonate | {{< risk Low >}}      |                                                                                                                       |

#### âš ï¸ Potential Abuse (3)

The following security risks were found based on the above permissions:

- [Create SubjectAccessReviews (check arbitrary permissions)](/rules/1050)
- [Impersonate users, groups, or service accounts (cluster-wide)](/rules/1066)

#### ğŸ“¦ Workloads (2)

| Kind       | Name              | Container         | Image                       |
| ---------- | ----------------- | ----------------- | --------------------------- |
| Deployment | stackgres-restapi | stackgres-adminui | stackgres/admin-ui:0.9.3    |
| Deployment | stackgres-restapi | stackgres-restapi | stackgres/restapi:0.9.3-jvm |

---

### ğŸ¤– `stackgres-operator-grafana` {#sa-stackgres-operator-grafana}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (3)

| Role                                                 | Resource                                                                       | Verbs              | Risk                  | Tags                                                                                                                                                           |
| ---------------------------------------------------- | ------------------------------------------------------------------------------ | ------------------ | --------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `stackgres-operator-grafana-clusterrole` | core/secrets                                                                   | get Â· list Â· watch | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}} |
| ClusterRole `stackgres-operator-grafana-clusterrole` | core/configmaps                                                                | get Â· list Â· watch | {{< risk High >}}     | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}}                                                                   |
| Role `stackgres-operator-grafana`                    | extensions/podsecuritypolicies **(restricted to: stackgres-operator-grafana)** | use                | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                           |

#### âš ï¸ Potential Abuse (5)

The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)

#### ğŸ“¦ Workloads (2)

| Kind       | Name                       | Container            | Image                       |
| ---------- | -------------------------- | -------------------- | --------------------------- |
| Deployment | stackgres-operator-grafana | grafana              | grafana/grafana:6.7.3       |
| Deployment | stackgres-operator-grafana | grafana-sc-dashboard | kiwigrid/k8s-sidecar:0.1.99 |

---

### ğŸ¤– `stackgres-operator-prometh-admission` {#sa-stackgres-operator-prometh-admission}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (4)

| Role                                               | Resource                                                                             | Verbs        | Risk             | Tags                                                                                                                                                            |
| -------------------------------------------------- | ------------------------------------------------------------------------------------ | ------------ | ---------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `stackgres-operator-prometh-admission` | admissionregistration.k8s.io/mutatingwebhookconfigurations                           | get Â· update | {{< risk Low >}} |                                                                                                                                                                 |
| Role `stackgres-operator-prometh-admission`        | core/secrets                                                                         | create Â· get | {{< risk Low >}} |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-prometh-admission` | admissionregistration.k8s.io/validatingwebhookconfigurations                         | get Â· update | {{< risk Low >}} |                                                                                                                                                                 |
| ClusterRole `stackgres-operator-prometh-admission` | policy/podsecuritypolicies **(restricted to: stackgres-operator-prometh-admission)** | use          | {{< risk Low >}} | {{< tag "DeprecatedFeature" >}} {{< tag "NodeAccess" >}} {{< tag "PodSecurityPolicy" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "ResourceNameRestricted" >}} |

#### âš ï¸ Potential Abuse (2)

The following security risks were found based on the above permissions:

- [Use privileged PodSecurityPolicy (deprecated)](/rules/1078)

#### ğŸ“¦ Workloads (2)

| Kind | Name                                        | Container | Image                               |
| ---- | ------------------------------------------- | --------- | ----------------------------------- |
| Job  | stackgres-operator-prometh-admission-create | create    | jettech/kube-webhook-certgen:v1.2.0 |
| Job  | stackgres-operator-prometh-admission-patch  | patch     | jettech/kube-webhook-certgen:v1.2.0 |

---

### ğŸ¤– `stackgres-operator-grafana-test` {#sa-stackgres-operator-grafana-test}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (1)

| Role                                   | Resource                                                                        | Verbs | Risk             | Tags                                 |
| -------------------------------------- | ------------------------------------------------------------------------------- | ----- | ---------------- | ------------------------------------ |
| Role `stackgres-operator-grafana-test` | policy/podsecuritypolicies **(restricted to: stackgres-operator-grafana-test)** | use   | {{< risk Low >}} | {{< tag "ResourceNameRestricted" >}} |

#### âš ï¸ Potential Abuse (1)

The following security risks were found based on the above permissions:

#### ğŸ“¦ Workloads (1)

| Kind | Name                            | Container               | Image            |
| ---- | ------------------------------- | ----------------------- | ---------------- |
| Pod  | stackgres-operator-grafana-test | stackgres-operator-test | bats/bats:v1.1.0 |

---

### ğŸ¤– `stackgres-operator-prometh-alertmanager` {#sa-stackgres-operator-prometh-alertmanager}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (1)

| Role                                           | Resource                                                                                | Verbs | Risk             | Tags                                 |
| ---------------------------------------------- | --------------------------------------------------------------------------------------- | ----- | ---------------- | ------------------------------------ |
| Role `stackgres-operator-prometh-alertmanager` | policy/podsecuritypolicies **(restricted to: stackgres-operator-prometh-alertmanager)** | use   | {{< risk Low >}} | {{< tag "ResourceNameRestricted" >}} |

#### âš ï¸ Potential Abuse (1)

The following security risks were found based on the above permissions:

#### ğŸ“¦ Workloads (0)

_No workloads use this ServiceAccount._

---

### ğŸ¤– `stackgres-operator-prometheus-node-exporter` {#sa-stackgres-operator-prometheus-node-exporter}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (1)

| Role                                                          | Resource                                                                                        | Verbs | Risk             | Tags                                                                                                                                                            |
| ------------------------------------------------------------- | ----------------------------------------------------------------------------------------------- | ----- | ---------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `psp-stackgres-operator-prometheus-node-exporter` | extensions/podsecuritypolicies **(restricted to: stackgres-operator-prometheus-node-exporter)** | use   | {{< risk Low >}} | {{< tag "DeprecatedFeature" >}} {{< tag "NodeAccess" >}} {{< tag "PodSecurityPolicy" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "ResourceNameRestricted" >}} |

#### âš ï¸ Potential Abuse (2)

The following security risks were found based on the above permissions:

- [Use privileged PodSecurityPolicy (deprecated)](/rules/1078)

#### ğŸ“¦ Workloads (1)

| Kind      | Name                                        | Container     | Image                                    |
| --------- | ------------------------------------------- | ------------- | ---------------------------------------- |
| DaemonSet | stackgres-operator-prometheus-node-exporter | node-exporter | quay.io/prometheus/node-exporter:v0.18.1 |

---

### ğŸ¤– `stackgres-operator-init` {#sa-stackgres-operator-init}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (0)

_No explicit RBAC bindings._

#### ğŸ“¦ Workloads (4)

| Kind | Name                                  | Container                             | Image                  |
| ---- | ------------------------------------- | ------------------------------------- | ---------------------- |
| Job  | stackgres-operator-bootstrap          | stackgres-operator-bootstrap          | bitnami/kubectl:1.18.3 |
| Job  | stackgres-operator-create-certificate | stackgres-operator-create-certificate | bitnami/kubectl:1.18.3 |
| Job  | stackgres-operator-upgrade            | stackgres-operator-upgrade            | bitnami/kubectl:1.18.3 |
| Job  | stackgres-operator-wait               | stackgres-operator-wait               | bitnami/kubectl:1.18.3 |

---
