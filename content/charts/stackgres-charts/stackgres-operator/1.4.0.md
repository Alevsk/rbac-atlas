---
title: "stackgres-operator"
description: "StackGres Operator"
version: v1.4.0
version_order: f0001f0004f0000
date: ""
service_accounts: 3
workloads: 3
bindings: 108
critical_findings: 11
high_findings: 5
medium_findings: 2
low_findings: 90
categories: [stackgres, postgresql, postgres, cluster, stack, opinionated]
tags:
  [
    BindingToPrivilegedRole,
    ClusterAdminAccess,
    ClusterStructure,
    ClusterWideLogAccess,
    ClusterWidePodExec,
    ClusterWideSecretAccess,
    CodeExecution,
    ConfigMapAccess,
    CredentialAccess,
    DataExposure,
    DenialOfService,
    ElevationOfPrivilege,
    IdentityManagement,
    Impersonation,
    InformationDisclosure,
    LateralMovement,
    LogAccess,
    ManInTheMiddle,
    NamespaceLifecycle,
    NetworkManipulation,
    OperationalData,
    Persistence,
    PodExec,
    PotentialPrivilegeEscalation,
    PrivilegeEscalation,
    RBACManipulation,
    RBACQuery,
    Reconnaissance,
    ResourceDeletion,
    SecretAccess,
    ServiceExposure,
    Spoofing,
    Tampering,
    TrafficRedirection,
    WorkloadExecution,
    WorkloadLifecycle,
    letter-S,
  ]
---

## Description

StackGres Operator

- https://gitlab.com/ongresinc/stackgres

## Overview

| Identity                                                 | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| -------------------------------------------------------- | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`stackgres-operator`](#sa-stackgres-operator)           | default   | âŒ        | â€”       | 103         | 1         | {{< risk "Critical" >}} |
| [`stackgres-restapi`](#sa-stackgres-restapi)             | default   | âŒ        | â€”       | 5           | 2         | {{< risk "Critical" >}} |
| [`stackgres-operator-init`](#sa-stackgres-operator-init) | default   | âŒ        | â€”       | 0           | 7         | â€”                       |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### ğŸ¤– `stackgres-operator` {#sa-stackgres-operator}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (103)

| Role                             | Resource                                         | Verbs                                                 | Risk                  | Tags                                                                                                                                                                         |
| -------------------------------- | ------------------------------------------------ | ----------------------------------------------------- | --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `stackgres-operator` | core/configmaps                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}              |
| ClusterRole `stackgres-operator` | batch/cronjobs                                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}               |
| ClusterRole `stackgres-operator` | core/endpoints                                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "DenialOfService" >}} {{< tag "ManInTheMiddle" >}} {{< tag "NetworkManipulation" >}} {{< tag "Tampering" >}} {{< tag "TrafficRedirection" >}}                        |
| ClusterRole `stackgres-operator` | batch/jobs                                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}                                         |
| ClusterRole `stackgres-operator` | core/pods                                        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "LateralMovement" >}} {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} (+1 more)       |
| ClusterRole `stackgres-operator` | core/pods/exec                                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ClusterWidePodExec" >}} {{< tag "CodeExecution" >}} {{< tag "ElevationOfPrivilege" >}} {{< tag "LateralMovement" >}} {{< tag "PodExec" >}} (+1 more)                |
| ClusterRole `stackgres-operator` | core/secrets                                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Persistence" >}} (+4 more)      |
| ClusterRole `stackgres-operator` | core/services                                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "DenialOfService" >}} {{< tag "NetworkManipulation" >}} {{< tag "ServiceExposure" >}} {{< tag "Tampering" >}}                                                        |
| ClusterRole `stackgres-operator` | apps/statefulsets                                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}               |
| ClusterRole `stackgres-operator` | core/namespaces                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "ClusterStructure" >}} {{< tag "DenialOfService" >}} {{< tag "InformationDisclosure" >}} {{< tag "NamespaceLifecycle" >}} {{< tag "Reconnaissance" >}} (+1 more)     |
| ClusterRole `stackgres-operator` | core/pods/log                                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "ClusterWideLogAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "LogAccess" >}}                                                    |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/rolebindings           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "BindingToPrivilegedRole" >}} {{< tag "InformationDisclosure" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}} {{< tag "RBACQuery" >}} (+1 more) |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/roles                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "InformationDisclosure" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}} {{< tag "RBACQuery" >}} {{< tag "Reconnaissance" >}}                    |
| ClusterRole `stackgres-operator` | core/serviceaccounts                             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "IdentityManagement" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}                                                                          |
| ClusterRole `stackgres-operator` | core/events                                      | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "OperationalData" >}} {{< tag "Reconnaissance" >}}                                                                               |
| ClusterRole `stackgres-operator` | apps/configmaps                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/configmaps                                 | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/configmaps                            | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/configmaps             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/cronjobs                                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/cronjobs                                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/cronjobs                              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/cronjobs               | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions   | get Â· list Â· watch                                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/endpoints                                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/endpoints                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/endpoints                             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/endpoints              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/endpoints/restricted                        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/endpoints/restricted                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/endpoints/restricted                        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/endpoints/restricted                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/endpoints/restricted   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/events                                      | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/events                                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/events                                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/events                 | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/jobs                                        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/jobs                                        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/jobs                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/jobs                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/namespaces                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/namespaces                                 | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/namespaces                            | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/namespaces             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/persistentvolumeclaims                      | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/persistentvolumeclaims                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/persistentvolumeclaims                      | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/persistentvolumeclaims                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/persistentvolumeclaims | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | monitoring.coreos.com/podmonitors                | create Â· delete Â· get Â· list Â· patch Â· update         | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/pods                                        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/pods                                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/pods                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/pods                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/pods/exec                                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/pods/exec                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/pods/exec                             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/pods/exec              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/pods/log                                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/pods/log                                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/pods/log                              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/pods/log               | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | monitoring.coreos.com/prometheus                 | get Â· list                                            | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | monitoring.coreos.com/prometheuses               | get Â· list                                            | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/rolebindings                                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/rolebindings                               | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/rolebindings                                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/rolebindings                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/roles                                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/roles                                      | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/roles                                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/roles                                 | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/secrets                                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/secrets                                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/secrets                               | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/secrets                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/serviceaccounts                             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/serviceaccounts                            | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/serviceaccounts                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/serviceaccounts        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | monitoring.coreos.com/servicemonitors            | create Â· delete Â· get Â· list Â· patch Â· update         | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/services                                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/services                                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/services                              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/services               | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgbackupconfigs                     | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgbackups                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgclusters                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgclusters/status                   | update                                                | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgdbops                             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgdistributedlogs                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgdistributedlogs/status            | update                                                | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sginstanceprofiles                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgobjectstorages                    | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgpgconfigs                         | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgpoolconfigs                       | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgscripts                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/statefulsets                               | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/statefulsets                                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/statefulsets                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/statefulsets           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | storage.k8s.io/storageclasses                    | get Â· list                                            | {{< risk Low >}}      |                                                                                                                                                                              |

#### âš ï¸ Potential Abuse (35)

The following security risks were found based on the above permissions:

- [Cluster-wide pod exec](/rules/1000)
- [Namespaced pod exec](/rules/1001)
- [Create pods cluster-wide](/rules/1006)
- [Create pods in a namespace](/rules/1007)
- [Update/Patch pods cluster-wide](/rules/1008)
- [Update/Patch pods in a namespace](/rules/1009)
- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Modify secrets cluster-wide](/rules/1012)
- [Modify secrets in a namespace](/rules/1013)
- [Read pod logs cluster-wide](/rules/1018)
- [Read pod logs in a namespace](/rules/1019)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Modify ConfigMaps cluster-wide](/rules/1024)
- [Modify ConfigMaps in a namespace](/rules/1025)
- [Delete namespaces](/rules/1026)
- [Manage Roles in a namespace (create, update, patch, delete)](/rules/1029)
- [Manage RoleBindings in a namespace (create, update, patch, delete)](/rules/1030)
- [Manage StatefulSets cluster-wide](/rules/1037)
- [Manage StatefulSets in a namespace](/rules/1038)
- [Manage CronJobs cluster-wide (scheduled privileged execution, persistence)](/rules/1039)
- [Manage CronJobs in a namespace (scheduled privileged execution, persistence)](/rules/1040)
- [Manage Jobs cluster-wide (one-off privileged execution)](/rules/1041)
- [Manage Jobs in a namespace (one-off privileged execution)](/rules/1042)
- [Manage ServiceAccounts cluster-wide](/rules/1067)
- [Manage ServiceAccounts in a namespace](/rules/1068)
- [Read events cluster-wide](/rules/1070)
- [Manage Endpoints or EndpointSlices cluster-wide](/rules/1073)
- [Manage Endpoints or EndpointSlices in a namespace](/rules/1074)
- [Manage Services cluster-wide](/rules/1075)
- [Manage Services in a namespace](/rules/1076)
- [Read RBAC configuration cluster-wide](/rules/1077)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)

#### ğŸ“¦ Workloads (1)

| Kind       | Name               | Container          | Image                    |
| ---------- | ------------------ | ------------------ | ------------------------ |
| Deployment | stackgres-operator | stackgres-operator | stackgres/operator:1.4.0 |

---

### ğŸ¤– `stackgres-restapi` {#sa-stackgres-restapi}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (5)

| Role                            | Resource                                  | Verbs       | Risk                  | Tags                                                                                                                  |
| ------------------------------- | ----------------------------------------- | ----------- | --------------------- | --------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `stackgres-restapi` | core/groups                               | impersonate | {{< risk Critical >}} | {{< tag "ClusterAdminAccess" >}} {{< tag "Impersonation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Spoofing" >}} |
| ClusterRole `stackgres-restapi` | core/users                                | impersonate | {{< risk Critical >}} | {{< tag "ClusterAdminAccess" >}} {{< tag "Impersonation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Spoofing" >}} |
| ClusterRole `stackgres-restapi` | authorization.k8s.io/subjectaccessreviews | create      | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                           |
| ClusterRole `stackgres-restapi` | core/secrets                              | get Â· list  | {{< risk Low >}}      |                                                                                                                       |
| ClusterRole `stackgres-restapi` | core/serviceaccount                       | impersonate | {{< risk Low >}}      |                                                                                                                       |

#### âš ï¸ Potential Abuse (3)

The following security risks were found based on the above permissions:

- [Create SubjectAccessReviews (check arbitrary permissions)](/rules/1050)
- [Impersonate users, groups, or service accounts (cluster-wide)](/rules/1066)

#### ğŸ“¦ Workloads (2)

| Kind       | Name              | Container         | Image                    |
| ---------- | ----------------- | ----------------- | ------------------------ |
| Deployment | stackgres-restapi | stackgres-adminui | stackgres/admin-ui:1.4.0 |
| Deployment | stackgres-restapi | stackgres-restapi | stackgres/restapi:1.4.0  |

---

### ğŸ¤– `stackgres-operator-init` {#sa-stackgres-operator-init}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (0)

_No explicit RBAC bindings._

#### ğŸ“¦ Workloads (7)

| Kind | Name                                   | Container                        | Image                              |
| ---- | -------------------------------------- | -------------------------------- | ---------------------------------- |
| Job  | stackgres-operator-conversion-webhooks | conversion-webhooks              | stackgres/jobs:1.4.0               |
| Job  | stackgres-operator-cr-updater          | stackgres-jobs                   | stackgres/jobs:1.4.0               |
| Job  | stackgres-operator-crd-upgrade         | crd-upgrade                      | stackgres/jobs:1.4.0               |
| Job  | stackgres-operator-create-certificate  | create-certificate               | ongres/kubectl:v1.19.16-build-6.16 |
| Job  | stackgres-operator-set-crd-version     | set-crd-version                  | ongres/kubectl:v1.19.16-build-6.16 |
| Job  | stackgres-operator-wait                | stackgres-operator-wait          | ongres/kubectl:v1.19.16-build-6.16 |
| Job  | stackgres-operator-wait-webhooks       | stackgres-operator-wait-webhooks | ongres/kubectl:v1.19.16-build-6.16 |

---
