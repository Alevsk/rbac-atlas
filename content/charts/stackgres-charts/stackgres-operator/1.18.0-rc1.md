---
title: "stackgres-operator"
description: "StackGres Operator"
version: v1.18.0-rc1
version_order: f0001f0012f0000
date: ""
service_accounts: 3
workloads: 2
bindings: 185
critical_findings: 12
high_findings: 5
medium_findings: 2
low_findings: 166
categories: [stackgres, postgresql, postgres, cluster, stack, opinionated]
tags:
  [
    BindingToPrivilegedRole,
    ClusterAdminAccess,
    ClusterStructure,
    ClusterWideLogAccess,
    ClusterWidePodExec,
    ClusterWideSecretAccess,
    CodeExecution,
    ConfigMapAccess,
    CredentialAccess,
    DataExposure,
    DenialOfService,
    ElevationOfPrivilege,
    IdentityManagement,
    Impersonation,
    InformationDisclosure,
    LateralMovement,
    LogAccess,
    ManInTheMiddle,
    NamespaceLifecycle,
    NetworkManipulation,
    OperationalData,
    Persistence,
    PodExec,
    PotentialPrivilegeEscalation,
    PrivilegeEscalation,
    RBACManipulation,
    RBACQuery,
    Reconnaissance,
    ResourceDeletion,
    ResourceNameRestricted,
    SecretAccess,
    ServiceExposure,
    Spoofing,
    Tampering,
    TrafficRedirection,
    WorkloadExecution,
    WorkloadLifecycle,
    letter-S,
  ]
---

## Description

StackGres Operator

- https://gitlab.com/ongresinc/stackgres

## Overview

| Identity                                                 | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| -------------------------------------------------------- | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`stackgres-operator`](#sa-stackgres-operator)           | default   | âŒ        | â€”       | 177         | 2         | {{< risk "Critical" >}} |
| [`stackgres-operator-init`](#sa-stackgres-operator-init) | default   | âŒ        | â€”       | 4           | 2         | {{< risk "Low" >}}      |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### ğŸ¤– `stackgres-operator` {#sa-stackgres-operator}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (177)

| Role                             | Resource                                                                                               | Verbs                                                                    | Risk                  | Tags                                                                                                                                                                         |
| -------------------------------- | ------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------ | --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `stackgres-operator` | core/configmaps                                                                                        | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}              |
| ClusterRole `stackgres-operator` | batch/cronjobs                                                                                         | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}               |
| ClusterRole `stackgres-operator` | apps/deployments                                                                                       | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}               |
| ClusterRole `stackgres-operator` | core/endpoints                                                                                         | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "DenialOfService" >}} {{< tag "ManInTheMiddle" >}} {{< tag "NetworkManipulation" >}} {{< tag "Tampering" >}} {{< tag "TrafficRedirection" >}}                        |
| ClusterRole `stackgres-operator` | batch/jobs                                                                                             | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}                                         |
| ClusterRole `stackgres-operator` | core/pods                                                                                              | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "LateralMovement" >}} {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} (+1 more)       |
| ClusterRole `stackgres-operator` | core/pods/exec                                                                                         | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ClusterWidePodExec" >}} {{< tag "CodeExecution" >}} {{< tag "ElevationOfPrivilege" >}} {{< tag "LateralMovement" >}} {{< tag "PodExec" >}} (+1 more)                |
| ClusterRole `stackgres-operator` | core/secrets                                                                                           | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Persistence" >}} (+4 more)      |
| ClusterRole `stackgres-operator` | core/services                                                                                          | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "DenialOfService" >}} {{< tag "NetworkManipulation" >}} {{< tag "ServiceExposure" >}} {{< tag "Tampering" >}}                                                        |
| ClusterRole `stackgres-operator` | apps/statefulsets                                                                                      | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Critical >}} | {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}               |
| ClusterRole `stackgres-operator` | core/namespaces                                                                                        | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "ClusterStructure" >}} {{< tag "DenialOfService" >}} {{< tag "InformationDisclosure" >}} {{< tag "NamespaceLifecycle" >}} {{< tag "Reconnaissance" >}} (+1 more)     |
| ClusterRole `stackgres-operator` | core/pods/log                                                                                          | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "ClusterWideLogAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "LogAccess" >}}                                                    |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/rolebindings                                                                 | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "BindingToPrivilegedRole" >}} {{< tag "InformationDisclosure" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}} {{< tag "RBACQuery" >}} (+1 more) |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/roles                                                                        | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "InformationDisclosure" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}} {{< tag "RBACQuery" >}} {{< tag "Reconnaissance" >}}                    |
| ClusterRole `stackgres-operator` | core/serviceaccounts                                                                                   | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk High >}}     | {{< tag "IdentityManagement" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}                                                                          |
| ClusterRole `stackgres-operator` | core/events                                                                                            | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "OperationalData" >}} {{< tag "Reconnaissance" >}}                                                                               |
| ClusterRole `stackgres-operator` | shardingsphere.apache.org/computenodes                                                                 | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/configmaps                                                                                        | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/configmaps                                                                                       | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/configmaps                                                                                  | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/configmaps                                                                   | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/cronjobs                                                                                          | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/cronjobs                                                                                          | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/cronjobs                                                                                    | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/cronjobs                                                                     | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/cronjobs/finalizers                                                                               | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/cronjobs/finalizers                                                                              | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/cronjobs/finalizers                                                                               | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions                                                         | create Â· list                                                            | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/deployments                                                                                      | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/deployments                                                                                       | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/deployments                                                                                 | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/deployments                                                                  | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/deployments/finalizers                                                                            | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/deployments/finalizers                                                                           | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/deployments/finalizers                                                                            | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/endpoints                                                                                         | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/endpoints                                                                                        | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/endpoints                                                                                   | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/endpoints                                                                    | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/endpoints/finalizers                                                                              | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/endpoints/finalizers                                                                             | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/endpoints/finalizers                                                                              | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/endpoints/restricted                                                                              | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/endpoints/restricted                                                                             | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/endpoints/restricted                                                                              | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/endpoints/restricted                                                                        | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/endpoints/restricted                                                         | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/events                                                                                            | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/events                                                                                           | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/events                                                                                      | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/events                                                                       | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/jobs                                                                                              | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/jobs                                                                                              | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/jobs                                                                                        | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/jobs                                                                         | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/jobs/finalizers                                                                                   | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/jobs/finalizers                                                                                  | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/jobs/finalizers                                                                                   | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/namespaces                                                                                        | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/namespaces                                                                                       | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/namespaces                                                                                  | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/namespaces                                                                   | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/persistentvolumeclaims                                                                            | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/persistentvolumeclaims                                                                           | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/persistentvolumeclaims                                                                            | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/persistentvolumeclaims                                                                      | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/persistentvolumeclaims                                                       | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/persistentvolumeclaims/finalizers                                                                 | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/persistentvolumeclaims/finalizers                                                                | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/persistentvolumeclaims/finalizers                                                                 | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | monitoring.coreos.com/podmonitors                                                                      | create Â· delete Â· get Â· list Â· patch Â· update                            | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/pods                                                                                              | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/pods                                                                                             | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/pods                                                                                        | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/pods                                                                         | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/pods/exec                                                                                         | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/pods/exec                                                                                        | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/pods/exec                                                                                   | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/pods/exec                                                                    | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/pods/finalizers                                                                                   | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/pods/finalizers                                                                                  | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/pods/finalizers                                                                                   | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/pods/log                                                                                          | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/pods/log                                                                                         | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/pods/log                                                                                    | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/pods/log                                                                     | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | monitoring.coreos.com/prometheus                                                                       | get Â· list                                                               | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | monitoring.coreos.com/prometheuses                                                                     | get Â· list                                                               | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/rolebindings                                                                                      | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/rolebindings                                                                                     | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/rolebindings                                                                                      | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/rolebindings                                                                                | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/roles                                                                                             | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/roles                                                                                            | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/roles                                                                                             | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/roles                                                                                       | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | keda.sh/scaledobjects                                                                                  | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/secrets                                                                                           | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/secrets                                                                                          | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/secrets                                                                                     | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/secrets                                                                      | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/serviceaccounts                                                                                   | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/serviceaccounts                                                                                  | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/serviceaccounts                                                                             | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/serviceaccounts                                                              | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | monitoring.coreos.com/servicemonitors                                                                  | create Â· delete Â· get Â· list Â· patch Â· update                            | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/services                                                                                          | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/services                                                                                         | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/services                                                                                    | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/services                                                                     | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | serving.knative.dev/services                                                                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/services/finalizers                                                                               | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/services/finalizers                                                                              | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/services/finalizers                                                                               | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgbackupconfigs                                                                           | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgbackupconfigs/finalizers                                                                | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgbackups                                                                                 | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgbackups/finalizers                                                                      | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgclusters                                                                                | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgclusters/finalizers                                                                     | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgclusters/status                                                                         | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgconfigs                                                                                 | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgconfigs/finalizers                                                                      | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgconfigs/status                                                                          | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgdbops                                                                                   | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgdbops/finalizers                                                                        | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgdistributedlogs                                                                         | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgdistributedlogs/finalizers                                                              | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgdistributedlogs/status                                                                  | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sginstanceprofiles                                                                        | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sginstanceprofiles/finalizers                                                             | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgobjectstorages                                                                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgobjectstorages/finalizers                                                               | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgpgconfigs                                                                               | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgpgconfigs/finalizers                                                                    | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgpoolconfigs                                                                             | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgpoolconfigs/finalizers                                                                  | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgscripts                                                                                 | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgscripts/finalizers                                                                      | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgshardedbackups                                                                          | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgshardedbackups/finalizers                                                               | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgshardedclusters                                                                         | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgshardedclusters/finalizers                                                              | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgshardeddbops                                                                            | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgshardeddbops/finalizers                                                                 | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgstreams                                                                                 | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | stackgres.io/sgstreams/finalizers                                                                      | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/statefulsets                                                                                     | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/statefulsets                                                                                      | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | extensions/statefulsets                                                                                | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | rbac.authorization.k8s.io/statefulsets                                                                 | create Â· delete Â· deletecollection Â· get Â· list Â· patch Â· update Â· watch | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apps/statefulsets/finalizers                                                                           | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | batch/statefulsets/finalizers                                                                          | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | core/statefulsets/finalizers                                                                           | update                                                                   | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | storage.k8s.io/storageclasses                                                                          | get Â· list                                                               | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | keda.sh/triggerauthentications                                                                         | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | autoscaling.k8s.io/verticalpodautoscalers                                                              | create Â· delete Â· get Â· list Â· patch Â· update Â· watch                    | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | snapshot.storage.k8s.io/volumesnapshots                                                                | create Â· get Â· list Â· watch                                              | {{< risk Low >}}      |                                                                                                                                                                              |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: prometheuses.monitoring.coreos.com)** | get                                                                      | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgbackupconfigs.stackgres.io)**       | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgbackups.stackgres.io)**             | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgclusters.stackgres.io)**            | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgconfigs.stackgres.io)**             | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgdbops.stackgres.io)**               | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgdistributedlogs.stackgres.io)**     | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sginstanceprofiles.stackgres.io)**    | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgobjectstorages.stackgres.io)**      | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgpgconfigs.stackgres.io)**           | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgpoolconfigs.stackgres.io)**         | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgscripts.stackgres.io)**             | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgshardedbackups.stackgres.io)**      | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgshardedclusters.stackgres.io)**     | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgshardeddbops.stackgres.io)**        | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgstreams.stackgres.io)**             | get Â· patch Â· update                                                     | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | admissionregistration.k8s.io/mutatingwebhookconfigurations **(restricted to: stackgres-operator)**     | get Â· patch                                                              | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |
| ClusterRole `stackgres-operator` | admissionregistration.k8s.io/validatingwebhookconfigurations **(restricted to: stackgres-operator)**   | get Â· patch                                                              | {{< risk Low >}}      | {{< tag "ResourceNameRestricted" >}}                                                                                                                                         |

#### âš ï¸ Potential Abuse (37)

The following security risks were found based on the above permissions:

- [Cluster-wide pod exec](/rules/1000)
- [Namespaced pod exec](/rules/1001)
- [Create pods cluster-wide](/rules/1006)
- [Create pods in a namespace](/rules/1007)
- [Update/Patch pods cluster-wide](/rules/1008)
- [Update/Patch pods in a namespace](/rules/1009)
- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Modify secrets cluster-wide](/rules/1012)
- [Modify secrets in a namespace](/rules/1013)
- [Read pod logs cluster-wide](/rules/1018)
- [Read pod logs in a namespace](/rules/1019)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Modify ConfigMaps cluster-wide](/rules/1024)
- [Modify ConfigMaps in a namespace](/rules/1025)
- [Delete namespaces](/rules/1026)
- [Manage Roles in a namespace (create, update, patch, delete)](/rules/1029)
- [Manage RoleBindings in a namespace (create, update, patch, delete)](/rules/1030)
- [Manage Deployments cluster-wide (potential for privileged pod execution)](/rules/1033)
- [Manage Deployments in a namespace (potential for privileged pod execution)](/rules/1034)
- [Manage StatefulSets cluster-wide](/rules/1037)
- [Manage StatefulSets in a namespace](/rules/1038)
- [Manage CronJobs cluster-wide (scheduled privileged execution, persistence)](/rules/1039)
- [Manage CronJobs in a namespace (scheduled privileged execution, persistence)](/rules/1040)
- [Manage Jobs cluster-wide (one-off privileged execution)](/rules/1041)
- [Manage Jobs in a namespace (one-off privileged execution)](/rules/1042)
- [Manage ServiceAccounts cluster-wide](/rules/1067)
- [Manage ServiceAccounts in a namespace](/rules/1068)
- [Read events cluster-wide](/rules/1070)
- [Manage Endpoints or EndpointSlices cluster-wide](/rules/1073)
- [Manage Endpoints or EndpointSlices in a namespace](/rules/1074)
- [Manage Services cluster-wide](/rules/1075)
- [Manage Services in a namespace](/rules/1076)
- [Read RBAC configuration cluster-wide](/rules/1077)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)

#### ğŸ“¦ Workloads (2)

| Kind       | Name                               | Container          | Image                                      |
| ---------- | ---------------------------------- | ------------------ | ------------------------------------------ |
| Deployment | stackgres-operator                 | stackgres-operator | quay.io/stackgres/operator:1.18.0-rc1      |
| Pod        | stackgres-operator-test-connection | conn-check         | quay.io/ongres/kubectl:v1.19.16-build-6.38 |

---

### ğŸ¤– `stackgres-operator-init` {#sa-stackgres-operator-init}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (4)

| Role                                  | Resource                                                                                   | Verbs                         | Risk             | Tags                                 |
| ------------------------------------- | ------------------------------------------------------------------------------------------ | ----------------------------- | ---------------- | ------------------------------------ |
| ClusterRole `stackgres-operator-init` | apiextensions.k8s.io/customresourcedefinitions                                             | create                        | {{< risk Low >}} |                                      |
| Role `stackgres-operator-init`        | stackgres.io/sgconfigs                                                                     | create                        | {{< risk Low >}} |                                      |
| ClusterRole `stackgres-operator-init` | apiextensions.k8s.io/customresourcedefinitions **(restricted to: sgconfigs.stackgres.io)** | get Â· update                  | {{< risk Low >}} | {{< tag "ResourceNameRestricted" >}} |
| Role `stackgres-operator-init`        | stackgres.io/sgconfigs **(restricted to: stackgres-operator)**                             | delete Â· get Â· patch Â· update | {{< risk Low >}} | {{< tag "ResourceNameRestricted" >}} |

#### âš ï¸ Potential Abuse (1)

The following security risks were found based on the above permissions:

#### ğŸ“¦ Workloads (2)

| Kind | Name                                | Container        | Image                                      |
| ---- | ----------------------------------- | ---------------- | ------------------------------------------ |
| Job  | stackgres-operator-install-sgconfig | install-sgconfig | quay.io/ongres/kubectl:v1.19.16-build-6.38 |
| Job  | stackgres-operator-remove-sgconfig  | remove-sgconfig  | quay.io/ongres/kubectl:v1.19.16-build-6.38 |

---
