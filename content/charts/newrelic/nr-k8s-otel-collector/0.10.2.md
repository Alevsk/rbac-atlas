---
title: "nr-k8s-otel-collector"
description: "A Helm chart to monitor a Kubernetes Cluster using an OpenTelemetry Collector."
version: v0.10.2
version_order: f0000f000af0002
date: ""
service_accounts: 2
workloads: 2
bindings: 49
critical_findings: 2
high_findings: 1
medium_findings: 5
low_findings: 41
categories: [infrastructure, newrelic, monitoring, opentelemetry, kubernetes]
tags: [AuthorizationBypass, ClusterAdminAccess, ClusterStructure, ClusterWideSecretAccess, CodeExecution, ConfigMapAccess, CredentialAccess, DataExposure, ElevationOfPrivilege, InformationDisclosure, LateralMovement, NodeAccess, OperationalData, QuotaTampering, Reconnaissance, ResourceConfiguration, SecretAccess, WebhookReconnaissance, letter-N]
---
## Description

A Helm chart to monitor a Kubernetes Cluster using an OpenTelemetry Collector.

## Overview

|Identity|Namespace|Automount|Secrets|Permissions|Workloads|Risk|
|---|---|---|---|---|---|---|
|[`nr-k8s-otel-collector`](#sa-nr-k8s-otel-collector)|default|âŒ|â€”|21|2|{{< risk "Critical" >}}|
|[`nr-k8s-otel-collector-kube-state-metrics`](#sa-nr-k8s-otel-collector-kube-state-metrics)|default|âœ…|â€”|28|1|{{< risk "Critical" >}}|


> *Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount.*

---

## Identities

### ğŸ¤– `nr-k8s-otel-collector-kube-state-metrics` {#sa-nr-k8s-otel-collector-kube-state-metrics}
 **Namespace:** `default` Â |Â  **Automount:** âœ…

#### ğŸ”‘ Permissions (28)
|Role|Resource|Verbs|Risk|Tags|
|---|---|---|---|---|
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|core/secrets|list Â· watch|{{< risk Critical >}}|{{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}}|
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|core/configmaps|list Â· watch|{{< risk High >}}|{{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}}|
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|admissionregistration.k8s.io/mutatingwebhookconfigurations|list Â· watch|{{< risk Medium >}}|{{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "WebhookReconnaissance" >}}|
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|core/resourcequotas|list Â· watch|{{< risk Medium >}}|{{< tag "InformationDisclosure" >}} {{< tag "QuotaTampering" >}} {{< tag "Reconnaissance" >}} {{< tag "ResourceConfiguration" >}}|
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|admissionregistration.k8s.io/validatingwebhookconfigurations|list Â· watch|{{< risk Medium >}}|{{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "WebhookReconnaissance" >}}|
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|certificates.k8s.io/certificatesigningrequests|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|batch/cronjobs|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|apps/daemonsets|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|apps/deployments|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|core/endpoints|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|autoscaling/horizontalpodautoscalers|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|networking.k8s.io/ingresses|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|batch/jobs|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|coordination.k8s.io/leases|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|core/limitranges|list Â· watch|{{< risk Low >}}|{{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "ResourceConfiguration" >}}|
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|core/namespaces|list Â· watch|{{< risk Low >}}|{{< tag "ClusterStructure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}}|
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|networking.k8s.io/networkpolicies|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|core/nodes|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|core/persistentvolumeclaims|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|core/persistentvolumes|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|policy/poddisruptionbudgets|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|core/pods|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|apps/replicasets|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|core/replicationcontrollers|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|core/services|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|apps/statefulsets|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|storage.k8s.io/storageclasses|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector-kube-state-metrics`|storage.k8s.io/volumeattachments|list Â· watch|{{< risk Low >}}||

#### âš ï¸ Potential Abuse (11)
The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)
- [List ValidatingWebhookConfigurations (Reconnaissance)](/rules/1083)
- [List MutatingWebhookConfigurations (Reconnaissance)](/rules/1084)
- [Read LimitRanges (Namespace Information Disclosure)](/rules/1087)
- [Read ResourceQuotas (Namespace Information Disclosure)](/rules/1088)
- [Read All ResourceQuotas (Cluster-wide Information Disclosure)](/rules/1089)

#### ğŸ“¦ Workloads (1)
|Kind|Name|Container|Image|
|---|---|---|---|
|Deployment|nr-k8s-otel-collector-kube-state-metrics|kube-state-metrics|registry.k8s.io/kube-state-metrics/kube-state-metrics:v2.16.0|

---

### ğŸ¤– `nr-k8s-otel-collector` {#sa-nr-k8s-otel-collector}
 **Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (21)
|Role|Resource|Verbs|Risk|Tags|
|---|---|---|---|---|
|ClusterRole `nr-k8s-otel-collector`|core/nodes/proxy|get|{{< risk Critical >}}|{{< tag "AuthorizationBypass" >}} {{< tag "ClusterAdminAccess" >}} {{< tag "CodeExecution" >}} {{< tag "ElevationOfPrivilege" >}} {{< tag "LateralMovement" >}} (+1 more)|
|ClusterRole `nr-k8s-otel-collector`|core/events|get Â· list Â· watch|{{< risk Medium >}}|{{< tag "InformationDisclosure" >}} {{< tag "OperationalData" >}} {{< tag "Reconnaissance" >}}|
|ClusterRole `nr-k8s-otel-collector`|core/resourcequotas|list Â· watch|{{< risk Medium >}}|{{< tag "InformationDisclosure" >}} {{< tag "QuotaTampering" >}} {{< tag "Reconnaissance" >}} {{< tag "ResourceConfiguration" >}}|
|ClusterRole `nr-k8s-otel-collector`|batch/cronjobs|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|apps/daemonsets|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|apps/deployments|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|core/endpoints|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|autoscaling/horizontalpodautoscalers|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|batch/jobs|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|core/namespaces|get Â· list Â· watch|{{< risk Low >}}|{{< tag "ClusterStructure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}}|
|ClusterRole `nr-k8s-otel-collector`|core/nodes|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|core/nodes/metrics|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|core/nodes/spec|get|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|core/nodes/stats|get|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|core/pods|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|core/pods/logs|get|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|core/pods/status|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|apps/replicasets|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|core/replicationcontrollers|list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|core/services|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `nr-k8s-otel-collector`|apps/statefulsets|get Â· list Â· watch|{{< risk Low >}}||

#### âš ï¸ Potential Abuse (6)
The following security risks were found based on the above permissions:

- [Read events cluster-wide](/rules/1070)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)
- [Read ResourceQuotas (Namespace Information Disclosure)](/rules/1088)
- [Read All ResourceQuotas (Cluster-wide Information Disclosure)](/rules/1089)
- [Node proxy GET RCE via WebSocket](/rules/1104)

#### ğŸ“¦ Workloads (2)
|Kind|Name|Container|Image|
|---|---|---|---|
|DaemonSet|nr-k8s-otel-collector-daemonset|otel-collector-daemonset|docker.io/newrelic/nrdot-collector-k8s:1.8.0|
|Deployment|nr-k8s-otel-collector-deployment|otel-collector-deployment|docker.io/newrelic/nrdot-collector-k8s:1.8.0|

---

