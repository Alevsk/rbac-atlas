---
title: metricbeat
description: Official Elastic helm chart for Metricbeat
version: v8.5.1
version_order: f0008f0005f0001
date: ""
service_accounts: 2
workloads: 2
bindings: 42
critical_findings: 0
high_findings: 0
medium_findings: 3
low_findings: 39
categories: []
tags: [ClusterStructure, InformationDisclosure, OperationalData, Reconnaissance, WebhookReconnaissance, letter-M]
---

## Description

Official Elastic helm chart for Metricbeat

- https://github.com/elastic/beats

## Overview

| Identity                                                             | Namespace | Automount | Secrets | Permissions | Workloads | Risk                  |
| -------------------------------------------------------------------- | --------- | --------- | ------- | ----------- | --------- | --------------------- |
| [`metricbeat-kube-state-metrics`](#sa-metricbeat-kube-state-metrics) | default   | ❌        | —       | 31          | 1         | {{< risk "Medium" >}} |
| [`metricbeat-metricbeat`](#sa-metricbeat-metricbeat)                 | default   | ❌        | —       | 11          | 2         | {{< risk "Medium" >}} |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### 🤖 `metricbeat-kube-state-metrics` {#sa-metricbeat-kube-state-metrics}

**Namespace:** `default` &nbsp;|&nbsp; **Automount:** ❌

#### 🔑 Permissions (31)

| Role                                        | Resource                                                     | Verbs        | Risk                | Tags                                                                                                 |
| ------------------------------------------- | ------------------------------------------------------------ | ------------ | ------------------- | ---------------------------------------------------------------------------------------------------- |
| ClusterRole `metricbeat-kube-state-metrics` | admissionregistration.k8s.io/mutatingwebhookconfigurations   | list · watch | {{< risk Medium >}} | {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "WebhookReconnaissance" >}} |
| ClusterRole `metricbeat-kube-state-metrics` | admissionregistration.k8s.io/validatingwebhookconfigurations | list · watch | {{< risk Medium >}} | {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "WebhookReconnaissance" >}} |
| ClusterRole `metricbeat-kube-state-metrics` | certificates.k8s.io/certificatesigningrequests               | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | core/configmaps                                              | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | batch/cronjobs                                               | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | apps/daemonsets                                              | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | extensions/daemonsets                                        | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | apps/deployments                                             | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | extensions/deployments                                       | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | core/endpoints                                               | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | autoscaling/horizontalpodautoscalers                         | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | extensions/ingresses                                         | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | networking.k8s.io/ingresses                                  | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | batch/jobs                                                   | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | core/limitranges                                             | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | core/namespaces                                              | list · watch | {{< risk Low >}}    | {{< tag "ClusterStructure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}}      |
| ClusterRole `metricbeat-kube-state-metrics` | networking.k8s.io/networkpolicies                            | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | core/nodes                                                   | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | core/persistentvolumeclaims                                  | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | core/persistentvolumes                                       | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | policy/poddisruptionbudgets                                  | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | core/pods                                                    | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | apps/replicasets                                             | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | extensions/replicasets                                       | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | core/replicationcontrollers                                  | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | core/resourcequotas                                          | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | core/secrets                                                 | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | core/services                                                | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | apps/statefulsets                                            | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | storage.k8s.io/storageclasses                                | list · watch | {{< risk Low >}}    |                                                                                                      |
| ClusterRole `metricbeat-kube-state-metrics` | storage.k8s.io/volumeattachments                             | list · watch | {{< risk Low >}}    |                                                                                                      |

#### ⚠️ Potential Abuse (4)

The following security risks were found based on the above permissions:

- [List Namespaces (Cluster Reconnaissance)](/rules/1082)
- [List ValidatingWebhookConfigurations (Reconnaissance)](/rules/1083)
- [List MutatingWebhookConfigurations (Reconnaissance)](/rules/1084)

#### 📦 Workloads (1)

| Kind       | Name                          | Container          | Image                                                   |
| ---------- | ----------------------------- | ------------------ | ------------------------------------------------------- |
| Deployment | metricbeat-kube-state-metrics | kube-state-metrics | k8s.gcr.io/kube-state-metrics/kube-state-metrics:v2.4.1 |

---

### 🤖 `metricbeat-metricbeat` {#sa-metricbeat-metricbeat}

**Namespace:** `default` &nbsp;|&nbsp; **Automount:** ❌

#### 🔑 Permissions (11)

| Role                                             | Resource                   | Verbs                 | Risk                | Tags                                                                                            |
| ------------------------------------------------ | -------------------------- | --------------------- | ------------------- | ----------------------------------------------------------------------------------------------- |
| ClusterRole `metricbeat-metricbeat-cluster-role` | core/events                | get · list · watch    | {{< risk Medium >}} | {{< tag "InformationDisclosure" >}} {{< tag "OperationalData" >}} {{< tag "Reconnaissance" >}}  |
| ClusterRole `metricbeat-metricbeat-cluster-role` | apps/deployments           | get · list · watch    | {{< risk Low >}}    |                                                                                                 |
| Role `metricbeat-metricbeat-role`                | coordination.k8s.io/leases | create · get · update | {{< risk Low >}}    |                                                                                                 |
| ClusterRole `metricbeat-metricbeat-cluster-role` | core/namespaces            | get · list · watch    | {{< risk Low >}}    | {{< tag "ClusterStructure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} |
| ClusterRole `metricbeat-metricbeat-cluster-role` | core/nodes                 | get · list · watch    | {{< risk Low >}}    |                                                                                                 |
| ClusterRole `metricbeat-metricbeat-cluster-role` | core/nodes/stats           | get                   | {{< risk Low >}}    |                                                                                                 |
| ClusterRole `metricbeat-metricbeat-cluster-role` | core/pods                  | get · list · watch    | {{< risk Low >}}    |                                                                                                 |
| ClusterRole `metricbeat-metricbeat-cluster-role` | apps/replicasets           | get · list · watch    | {{< risk Low >}}    |                                                                                                 |
| ClusterRole `metricbeat-metricbeat-cluster-role` | extensions/replicasets     | get · list · watch    | {{< risk Low >}}    |                                                                                                 |
| ClusterRole `metricbeat-metricbeat-cluster-role` | core/services              | get · list · watch    | {{< risk Low >}}    |                                                                                                 |
| ClusterRole `metricbeat-metricbeat-cluster-role` | apps/statefulsets          | get · list · watch    | {{< risk Low >}}    |                                                                                                 |

#### ⚠️ Potential Abuse (3)

The following security risks were found based on the above permissions:

- [Read events cluster-wide](/rules/1070)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)

#### 📦 Workloads (2)

| Kind       | Name                          | Container  | Image                                    |
| ---------- | ----------------------------- | ---------- | ---------------------------------------- |
| DaemonSet  | metricbeat-metricbeat         | metricbeat | docker.elastic.co/beats/metricbeat:8.5.1 |
| Deployment | metricbeat-metricbeat-metrics | metricbeat | docker.elastic.co/beats/metricbeat:8.5.1 |

---
