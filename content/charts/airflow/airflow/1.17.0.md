---
title: "airflow"
description: "The official Helm chart to deploy Apache Airflow, a platform to programmatically author, schedule, and monitor workflows"
version: v1.17.0
version_order: f0001f0011f0000
date: ""
service_accounts: 9
workloads: 10
bindings: 8
critical_findings: 0
high_findings: 2
medium_findings: 3
low_findings: 3
categories: [apache, airflow, workflow, scheduler]
tags:
  [
    CodeExecution,
    DataExposure,
    InformationDisclosure,
    LateralMovement,
    LogAccess,
    Persistence,
    PodExec,
    PotentialPrivilegeEscalation,
    WorkloadExecution,
    letter-A,
  ]
---

## Description

The official Helm chart to deploy Apache Airflow, a platform to programmatically author, schedule, and monitor workflows

- https://github.com/apache/airflow

## Overview

| Identity                                                           | Namespace | Automount | Secrets | Permissions | Workloads | Risk                  |
| ------------------------------------------------------------------ | --------- | --------- | ------- | ----------- | --------- | --------------------- |
| [`airflow-worker`](#sa-airflow-worker)                             | default   | ✅        | —       | 4           | 2         | {{< risk "High" >}}   |
| [`airflow-api-server`](#sa-airflow-api-server)                     | default   | ✅        | —       | 2           | 1         | {{< risk "Medium" >}} |
| [`airflow-triggerer`](#sa-airflow-triggerer)                       | default   | ✅        | —       | 2           | 2         | {{< risk "Medium" >}} |
| [`airflow-create-user-job`](#sa-airflow-create-user-job)           | default   | ✅        | —       | 0           | 1         | —                     |
| [`airflow-dag-processor`](#sa-airflow-dag-processor)               | default   | ✅        | —       | 0           | 2         | —                     |
| [`airflow-migrate-database-job`](#sa-airflow-migrate-database-job) | default   | ✅        | —       | 0           | 1         | —                     |
| [`airflow-redis`](#sa-airflow-redis)                               | default   | ✅        | —       | 0           | 1         | —                     |
| [`airflow-scheduler`](#sa-airflow-scheduler)                       | default   | ✅        | —       | 0           | 2         | —                     |
| [`airflow-statsd`](#sa-airflow-statsd)                             | default   | ✅        | —       | 0           | 1         | —                     |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### 🤖 `airflow-worker` {#sa-airflow-worker}

**Namespace:** `default`  |  **Automount:** ✅

#### 🔑 Permissions (4)

| Role                             | Resource       | Verbs                                        | Risk                | Tags                                                                                                                               |
| -------------------------------- | -------------- | -------------------------------------------- | ------------------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| Role `airflow-pod-launcher-role` | core/pods      | create · delete · get · list · patch · watch | {{< risk High >}}   | {{< tag "LateralMovement" >}} {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "WorkloadExecution" >}} |
| Role `airflow-pod-launcher-role` | core/pods/exec | create · get                                 | {{< risk High >}}   | {{< tag "CodeExecution" >}} {{< tag "LateralMovement" >}} {{< tag "PodExec" >}} {{< tag "PotentialPrivilegeEscalation" >}}         |
| Role `airflow-pod-launcher-role` | core/pods/log  | get                                          | {{< risk Medium >}} | {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "LogAccess" >}}                                             |
| Role `airflow-pod-launcher-role` | core/events    | list                                         | {{< risk Low >}}    |                                                                                                                                    |

#### ⚠️ Potential Abuse (4)

The following security risks were found based on the above permissions:

- [Namespaced pod exec](/rules/1001)
- [Create pods in a namespace](/rules/1007)
- [Read pod logs in a namespace](/rules/1019)

#### 📦 Workloads (2)

| Kind        | Name           | Container          | Image                |
| ----------- | -------------- | ------------------ | -------------------- |
| StatefulSet | airflow-worker | worker             | apache/airflow:3.0.2 |
| StatefulSet | airflow-worker | worker-log-groomer | apache/airflow:3.0.2 |

---

### 🤖 `airflow-api-server` {#sa-airflow-api-server}

**Namespace:** `default`  |  **Automount:** ✅

#### 🔑 Permissions (2)

| Role                               | Resource      | Verbs              | Risk                | Tags                                                                                   |
| ---------------------------------- | ------------- | ------------------ | ------------------- | -------------------------------------------------------------------------------------- |
| Role `airflow-pod-log-reader-role` | core/pods/log | get · list         | {{< risk Medium >}} | {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "LogAccess" >}} |
| Role `airflow-pod-log-reader-role` | core/pods     | get · list · watch | {{< risk Low >}}    |                                                                                        |

#### ⚠️ Potential Abuse (2)

The following security risks were found based on the above permissions:

- [Read pod logs in a namespace](/rules/1019)

#### 📦 Workloads (1)

| Kind       | Name               | Container  | Image                |
| ---------- | ------------------ | ---------- | -------------------- |
| Deployment | airflow-api-server | api-server | apache/airflow:3.0.2 |

---

### 🤖 `airflow-triggerer` {#sa-airflow-triggerer}

**Namespace:** `default`  |  **Automount:** ✅

#### 🔑 Permissions (2)

| Role                               | Resource      | Verbs              | Risk                | Tags                                                                                   |
| ---------------------------------- | ------------- | ------------------ | ------------------- | -------------------------------------------------------------------------------------- |
| Role `airflow-pod-log-reader-role` | core/pods/log | get · list         | {{< risk Medium >}} | {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "LogAccess" >}} |
| Role `airflow-pod-log-reader-role` | core/pods     | get · list · watch | {{< risk Low >}}    |                                                                                        |

#### ⚠️ Potential Abuse (2)

The following security risks were found based on the above permissions:

- [Read pod logs in a namespace](/rules/1019)

#### 📦 Workloads (2)

| Kind        | Name              | Container             | Image                |
| ----------- | ----------------- | --------------------- | -------------------- |
| StatefulSet | airflow-triggerer | triggerer             | apache/airflow:3.0.2 |
| StatefulSet | airflow-triggerer | triggerer-log-groomer | apache/airflow:3.0.2 |

---

### 🤖 `airflow-create-user-job` {#sa-airflow-create-user-job}

**Namespace:** `default`  |  **Automount:** ✅

#### 🔑 Permissions (0)

_No explicit RBAC bindings._

#### 📦 Workloads (1)

| Kind | Name                | Container   | Image                |
| ---- | ------------------- | ----------- | -------------------- |
| Job  | airflow-create-user | create-user | apache/airflow:3.0.2 |

---

### 🤖 `airflow-dag-processor` {#sa-airflow-dag-processor}

**Namespace:** `default`  |  **Automount:** ✅

#### 🔑 Permissions (0)

_No explicit RBAC bindings._

#### 📦 Workloads (2)

| Kind       | Name                  | Container                 | Image                |
| ---------- | --------------------- | ------------------------- | -------------------- |
| Deployment | airflow-dag-processor | dag-processor             | apache/airflow:3.0.2 |
| Deployment | airflow-dag-processor | dag-processor-log-groomer | apache/airflow:3.0.2 |

---

### 🤖 `airflow-migrate-database-job` {#sa-airflow-migrate-database-job}

**Namespace:** `default`  |  **Automount:** ✅

#### 🔑 Permissions (0)

_No explicit RBAC bindings._

#### 📦 Workloads (1)

| Kind | Name                           | Container              | Image                |
| ---- | ------------------------------ | ---------------------- | -------------------- |
| Job  | airflow-run-airflow-migrations | run-airflow-migrations | apache/airflow:3.0.2 |

---

### 🤖 `airflow-redis` {#sa-airflow-redis}

**Namespace:** `default`  |  **Automount:** ✅

#### 🔑 Permissions (0)

_No explicit RBAC bindings._

#### 📦 Workloads (1)

| Kind        | Name          | Container | Image              |
| ----------- | ------------- | --------- | ------------------ |
| StatefulSet | airflow-redis | redis     | redis:7.2-bookworm |

---

### 🤖 `airflow-scheduler` {#sa-airflow-scheduler}

**Namespace:** `default`  |  **Automount:** ✅

#### 🔑 Permissions (0)

_No explicit RBAC bindings._

#### 📦 Workloads (2)

| Kind       | Name              | Container             | Image                |
| ---------- | ----------------- | --------------------- | -------------------- |
| Deployment | airflow-scheduler | scheduler             | apache/airflow:3.0.2 |
| Deployment | airflow-scheduler | scheduler-log-groomer | apache/airflow:3.0.2 |

---

### 🤖 `airflow-statsd` {#sa-airflow-statsd}

**Namespace:** `default`  |  **Automount:** ✅

#### 🔑 Permissions (0)

_No explicit RBAC bindings._

#### 📦 Workloads (1)

| Kind       | Name           | Container | Image                                      |
| ---------- | -------------- | --------- | ------------------------------------------ |
| Deployment | airflow-statsd | statsd    | quay.io/prometheus/statsd-exporter:v0.28.0 |

---
