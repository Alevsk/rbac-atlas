---
title: "airflow"
description: "The official Helm chart to deploy Apache Airflow, a platform to programmatically author, schedule, and monitor workflows"
version: v1.6.0
version_order: f0001f0006f0000
date: ""
service_accounts: 8
workloads: 9
bindings: 8
critical_findings: 0
high_findings: 2
medium_findings: 3
low_findings: 3
categories: [apache, airflow, workflow, scheduler]
tags:
  [
    CodeExecution,
    DataExposure,
    InformationDisclosure,
    LateralMovement,
    LogAccess,
    Persistence,
    PodExec,
    PotentialPrivilegeEscalation,
    WorkloadExecution,
    letter-A,
  ]
---

## Description

The official Helm chart to deploy Apache Airflow, a platform to programmatically author, schedule, and monitor workflows

- https://github.com/apache/airflow

## Overview

| Identity                                                           | Namespace | Automount | Secrets | Permissions | Workloads | Risk                  |
| ------------------------------------------------------------------ | --------- | --------- | ------- | ----------- | --------- | --------------------- |
| [`airflow-worker`](#sa-airflow-worker)                             | default   | âŒ        | â€”       | 4           | 2         | {{< risk "High" >}}   |
| [`airflow-triggerer`](#sa-airflow-triggerer)                       | default   | âŒ        | â€”       | 2           | 1         | {{< risk "Medium" >}} |
| [`airflow-webserver`](#sa-airflow-webserver)                       | default   | âŒ        | â€”       | 2           | 1         | {{< risk "Medium" >}} |
| [`airflow-create-user-job`](#sa-airflow-create-user-job)           | default   | âŒ        | â€”       | 0           | 1         | â€”                     |
| [`airflow-migrate-database-job`](#sa-airflow-migrate-database-job) | default   | âŒ        | â€”       | 0           | 1         | â€”                     |
| [`airflow-redis`](#sa-airflow-redis)                               | default   | âŒ        | â€”       | 0           | 1         | â€”                     |
| [`airflow-scheduler`](#sa-airflow-scheduler)                       | default   | âŒ        | â€”       | 0           | 2         | â€”                     |
| [`airflow-statsd`](#sa-airflow-statsd)                             | default   | âŒ        | â€”       | 0           | 1         | â€”                     |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### ğŸ¤– `airflow-worker` {#sa-airflow-worker}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (4)

| Role                             | Resource       | Verbs                                        | Risk                | Tags                                                                                                                               |
| -------------------------------- | -------------- | -------------------------------------------- | ------------------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| Role `airflow-pod-launcher-role` | core/pods      | create Â· delete Â· get Â· list Â· patch Â· watch | {{< risk High >}}   | {{< tag "LateralMovement" >}} {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "WorkloadExecution" >}} |
| Role `airflow-pod-launcher-role` | core/pods/exec | create Â· get                                 | {{< risk High >}}   | {{< tag "CodeExecution" >}} {{< tag "LateralMovement" >}} {{< tag "PodExec" >}} {{< tag "PotentialPrivilegeEscalation" >}}         |
| Role `airflow-pod-launcher-role` | core/pods/log  | get                                          | {{< risk Medium >}} | {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "LogAccess" >}}                                             |
| Role `airflow-pod-launcher-role` | core/events    | list                                         | {{< risk Low >}}    |                                                                                                                                    |

#### âš ï¸ Potential Abuse (4)

The following security risks were found based on the above permissions:

- [Namespaced pod exec](/rules/1001)
- [Create pods in a namespace](/rules/1007)
- [Read pod logs in a namespace](/rules/1019)

#### ğŸ“¦ Workloads (2)

| Kind        | Name           | Container          | Image                |
| ----------- | -------------- | ------------------ | -------------------- |
| StatefulSet | airflow-worker | worker             | apache/airflow:2.3.0 |
| StatefulSet | airflow-worker | worker-log-groomer | apache/airflow:2.3.0 |

---

### ğŸ¤– `airflow-triggerer` {#sa-airflow-triggerer}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (2)

| Role                               | Resource      | Verbs              | Risk                | Tags                                                                                   |
| ---------------------------------- | ------------- | ------------------ | ------------------- | -------------------------------------------------------------------------------------- |
| Role `airflow-pod-log-reader-role` | core/pods/log | get Â· list         | {{< risk Medium >}} | {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "LogAccess" >}} |
| Role `airflow-pod-log-reader-role` | core/pods     | get Â· list Â· watch | {{< risk Low >}}    |                                                                                        |

#### âš ï¸ Potential Abuse (2)

The following security risks were found based on the above permissions:

- [Read pod logs in a namespace](/rules/1019)

#### ğŸ“¦ Workloads (1)

| Kind       | Name              | Container | Image                |
| ---------- | ----------------- | --------- | -------------------- |
| Deployment | airflow-triggerer | triggerer | apache/airflow:2.3.0 |

---

### ğŸ¤– `airflow-webserver` {#sa-airflow-webserver}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (2)

| Role                               | Resource      | Verbs              | Risk                | Tags                                                                                   |
| ---------------------------------- | ------------- | ------------------ | ------------------- | -------------------------------------------------------------------------------------- |
| Role `airflow-pod-log-reader-role` | core/pods/log | get Â· list         | {{< risk Medium >}} | {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "LogAccess" >}} |
| Role `airflow-pod-log-reader-role` | core/pods     | get Â· list Â· watch | {{< risk Low >}}    |                                                                                        |

#### âš ï¸ Potential Abuse (2)

The following security risks were found based on the above permissions:

- [Read pod logs in a namespace](/rules/1019)

#### ğŸ“¦ Workloads (1)

| Kind       | Name              | Container | Image                |
| ---------- | ----------------- | --------- | -------------------- |
| Deployment | airflow-webserver | webserver | apache/airflow:2.3.0 |

---

### ğŸ¤– `airflow-create-user-job` {#sa-airflow-create-user-job}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (0)

_No explicit RBAC bindings._

#### ğŸ“¦ Workloads (1)

| Kind | Name                | Container   | Image                |
| ---- | ------------------- | ----------- | -------------------- |
| Job  | airflow-create-user | create-user | apache/airflow:2.3.0 |

---

### ğŸ¤– `airflow-migrate-database-job` {#sa-airflow-migrate-database-job}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (0)

_No explicit RBAC bindings._

#### ğŸ“¦ Workloads (1)

| Kind | Name                           | Container              | Image                |
| ---- | ------------------------------ | ---------------------- | -------------------- |
| Job  | airflow-run-airflow-migrations | run-airflow-migrations | apache/airflow:2.3.0 |

---

### ğŸ¤– `airflow-redis` {#sa-airflow-redis}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (0)

_No explicit RBAC bindings._

#### ğŸ“¦ Workloads (1)

| Kind        | Name          | Container | Image            |
| ----------- | ------------- | --------- | ---------------- |
| StatefulSet | airflow-redis | redis     | redis:6-bullseye |

---

### ğŸ¤– `airflow-scheduler` {#sa-airflow-scheduler}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (0)

_No explicit RBAC bindings._

#### ğŸ“¦ Workloads (2)

| Kind       | Name              | Container             | Image                |
| ---------- | ----------------- | --------------------- | -------------------- |
| Deployment | airflow-scheduler | scheduler             | apache/airflow:2.3.0 |
| Deployment | airflow-scheduler | scheduler-log-groomer | apache/airflow:2.3.0 |

---

### ğŸ¤– `airflow-statsd` {#sa-airflow-statsd}

**Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (0)

_No explicit RBAC bindings._

#### ğŸ“¦ Workloads (1)

| Kind       | Name           | Container | Image                                                     |
| ---------- | -------------- | --------- | --------------------------------------------------------- |
| Deployment | airflow-statsd | statsd    | apache/airflow:airflow-statsd-exporter-2021.04.28-v0.17.0 |

---
