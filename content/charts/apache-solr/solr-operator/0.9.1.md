---
title: "solr-operator"
description: "The Solr Operator enables easy management of Solr resources within Kubernetes."
version: v0.9.1
version_order: f0000f0009f0001
date: ""
service_accounts: 4
workloads: 4
bindings: 48
critical_findings: 17
high_findings: 6
medium_findings: 4
low_findings: 21
categories: [solr, apache, search, lucene, operator]
tags:
  [
    AvailabilityImpact,
    ClusterAdminAccess,
    ClusterWideAccess,
    ClusterWidePodExec,
    ClusterWideSecretAccess,
    CodeExecution,
    ConfigMapAccess,
    ControlPlaneDisruption,
    CredentialAccess,
    CriticalNamespace,
    DataExposure,
    DenialOfService,
    ElevationOfPrivilege,
    IdentityManagement,
    Impersonation,
    InformationDisclosure,
    LateralMovement,
    ManInTheMiddle,
    NamespaceAdmin,
    NamespaceWideAccess,
    NetworkManipulation,
    NodeAccess,
    OperationalData,
    Persistence,
    PodExec,
    PotentialPrivilegeEscalation,
    PrivilegeEscalation,
    Reconnaissance,
    ResourceDeletion,
    SecretAccess,
    ServiceExposure,
    Spoofing,
    Tampering,
    TrafficRedirection,
    WildcardPermission,
    WorkloadExecution,
    WorkloadLifecycle,
    letter-S,
  ]
---

## Description

The Solr Operator enables easy management of Solr resources within Kubernetes.

- https://github.com/apache/solr-operator

## Overview

| Identity                                                                                                             | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| -------------------------------------------------------------------------------------------------------------------- | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`solr-operator`](#sa-solr-operator)                                                                                 | default   | ❌        | —       | 30          | 1         | {{< risk "Critical" >}} |
| [`zookeeper-operator`](#sa-zookeeper-operator)                                                                       | default   | ❌        | —       | 15          | 1         | {{< risk "Critical" >}} |
| [`solr-operator-zookeeper-operator-pre-delete`](#sa-solr-operator-zookeeper-operator-pre-delete)                     | default   | ❌        | —       | 1           | 1         | {{< risk "High" >}}     |
| [`solr-operator-zookeeper-operator-post-install-upgrade`](#sa-solr-operator-zookeeper-operator-post-install-upgrade) | default   | ❌        | —       | 2           | 1         | {{< risk "Medium" >}}   |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### 🤖 `solr-operator` {#sa-solr-operator}

**Namespace:** `default`  |  **Automount:** ❌

#### 🔑 Permissions (30)

| Role                                      | Resource                                           | Verbs                                                 | Risk                  | Tags                                                                                                                                                                    |
| ----------------------------------------- | -------------------------------------------------- | ----------------------------------------------------- | --------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `solr-operator-role`          | core/configmaps                                    | create · delete · get · list · patch · update · watch | {{< risk Critical >}} | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}         |
| ClusterRole `solr-operator-role`          | apps/deployments                                   | create · delete · get · list · patch · update · watch | {{< risk Critical >}} | {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}          |
| Role `solr-operator-leader-election-role` | coordination.k8s.io/leases                         | create · delete · get · list · patch · update · watch | {{< risk Critical >}} | {{< tag "ControlPlaneDisruption" >}} {{< tag "CriticalNamespace" >}} {{< tag "DenialOfService" >}} {{< tag "Tampering" >}}                                              |
| ClusterRole `solr-operator-role`          | core/pods/exec                                     | create                                                | {{< risk Critical >}} | {{< tag "ClusterWidePodExec" >}} {{< tag "CodeExecution" >}} {{< tag "ElevationOfPrivilege" >}} {{< tag "LateralMovement" >}} {{< tag "PodExec" >}} (+1 more)           |
| ClusterRole `solr-operator-role`          | core/secrets                                       | create · delete · get · list · patch · update · watch | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Persistence" >}} (+4 more) |
| ClusterRole `solr-operator-role`          | core/services                                      | create · delete · get · list · patch · update · watch | {{< risk Critical >}} | {{< tag "DenialOfService" >}} {{< tag "NetworkManipulation" >}} {{< tag "ServiceExposure" >}} {{< tag "Tampering" >}}                                                   |
| ClusterRole `solr-operator-role`          | apps/statefulsets                                  | create · delete · get · list · patch · update · watch | {{< risk Critical >}} | {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}          |
| Role `solr-operator-leader-election-role` | core/configmaps                                    | create · delete · get · list · patch · update · watch | {{< risk High >}}     | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}         |
| ClusterRole `solr-operator-role`          | networking.k8s.io/ingresses                        | create · delete · get · list · patch · update · watch | {{< risk High >}}     | {{< tag "DenialOfService" >}} {{< tag "NetworkManipulation" >}} {{< tag "ServiceExposure" >}} {{< tag "Tampering" >}}                                                   |
| ClusterRole `solr-operator-role`          | policy/poddisruptionbudgets                        | create · delete · get · list · patch · update · watch | {{< risk Medium >}}   | {{< tag "AvailabilityImpact" >}} {{< tag "DenialOfService" >}} {{< tag "Tampering" >}}                                                                                  |
| ClusterRole `solr-operator-role`          | core/configmaps/status                             | get                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | apps/deployments/status                            | get                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| Role `solr-operator-leader-election-role` | core/events                                        | create · patch                                        | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | networking.k8s.io/ingresses/status                 | get                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | core/persistentvolumeclaims                        | delete · get · list · watch                           | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | core/pods                                          | delete · get · list · watch                           | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | core/pods/status                                   | get · patch                                           | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | core/services/status                               | get                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | solr.apache.org/solrbackups                        | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | solr.apache.org/solrbackups/finalizers             | update                                                | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | solr.apache.org/solrbackups/status                 | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | solr.apache.org/solrclouds                         | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | solr.apache.org/solrclouds/finalizers              | update                                                | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | solr.apache.org/solrclouds/status                  | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | solr.apache.org/solrprometheusexporters            | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | solr.apache.org/solrprometheusexporters/finalizers | update                                                | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | solr.apache.org/solrprometheusexporters/status     | get · patch · update                                  | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | apps/statefulsets/status                           | get                                                   | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | zookeeper.pravega.io/zookeeperclusters             | create · delete · get · list · patch · update · watch | {{< risk Low >}}      |                                                                                                                                                                         |
| ClusterRole `solr-operator-role`          | zookeeper.pravega.io/zookeeperclusters/status      | get                                                   | {{< risk Low >}}      |                                                                                                                                                                         |

#### ⚠️ Potential Abuse (20)

The following security risks were found based on the above permissions:

- [Cluster-wide pod exec](/rules/1000)
- [Namespaced pod exec](/rules/1001)
- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Modify secrets cluster-wide](/rules/1012)
- [Modify secrets in a namespace](/rules/1013)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Modify ConfigMaps cluster-wide](/rules/1024)
- [Modify ConfigMaps in a namespace](/rules/1025)
- [Manage Deployments cluster-wide (potential for privileged pod execution)](/rules/1033)
- [Manage Deployments in a namespace (potential for privileged pod execution)](/rules/1034)
- [Manage StatefulSets cluster-wide](/rules/1037)
- [Manage StatefulSets in a namespace](/rules/1038)
- [Manage Services cluster-wide](/rules/1075)
- [Manage Services in a namespace](/rules/1076)
- [Manage PodDisruptionBudgets cluster-wide](/rules/1079)
- [Manage Leases in kube-system or kube-node-lease namespace](/rules/1081)
- [Manage Ingresses (Namespace Service Exposure/Traffic Redirection)](/rules/1091)

#### 📦 Workloads (1)

| Kind       | Name          | Container     | Image                       |
| ---------- | ------------- | ------------- | --------------------------- |
| Deployment | solr-operator | solr-operator | apache/solr-operator:v0.9.1 |

---

### 🤖 `zookeeper-operator` {#sa-zookeeper-operator}

**Namespace:** `default`  |  **Automount:** ❌

#### 🔑 Permissions (15)

| Role                                           | Resource                    | Verbs | Risk                  | Tags                                                                                                                                                                               |
| ---------------------------------------------- | --------------------------- | ----- | --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `solr-operator-zookeeper-operator` | core/configmaps             | \*    | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} (+2 more)  |
| ClusterRole `solr-operator-zookeeper-operator` | apps/daemonsets             | \*    | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "NodeAccess" >}} {{< tag "Persistence" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} (+2 more)                             |
| ClusterRole `solr-operator-zookeeper-operator` | apps/deployments            | \*    | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} (+2 more)           |
| ClusterRole `solr-operator-zookeeper-operator` | core/endpoints              | \*    | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "DenialOfService" >}} {{< tag "ManInTheMiddle" >}} {{< tag "NetworkManipulation" >}} {{< tag "Tampering" >}} (+2 more)                     |
| ClusterRole `solr-operator-zookeeper-operator` | core/nodes                  | \*    | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "DenialOfService" >}} {{< tag "NodeAccess" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "ResourceDeletion" >}} (+2 more)         |
| ClusterRole `solr-operator-zookeeper-operator` | core/pods                   | \*    | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "LateralMovement" >}} {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} (+3 more)     |
| ClusterRole `solr-operator-zookeeper-operator` | core/secrets                | \*    | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} (+6 more)      |
| ClusterRole `solr-operator-zookeeper-operator` | core/serviceaccounts        | \*    | {{< risk Critical >}} | {{< tag "ClusterAdminAccess" >}} {{< tag "ClusterWideAccess" >}} {{< tag "IdentityManagement" >}} {{< tag "Impersonation" >}} {{< tag "PotentialPrivilegeEscalation" >}} (+4 more) |
| ClusterRole `solr-operator-zookeeper-operator` | core/services               | \*    | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "DenialOfService" >}} {{< tag "NetworkManipulation" >}} {{< tag "ServiceExposure" >}} {{< tag "Tampering" >}} (+1 more)                    |
| ClusterRole `solr-operator-zookeeper-operator` | apps/statefulsets           | \*    | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} (+2 more)           |
| ClusterRole `solr-operator-zookeeper-operator` | zookeeper.pravega.io/\*     | \*    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                   |
| ClusterRole `solr-operator-zookeeper-operator` | core/persistentvolumeclaims | \*    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                   |
| ClusterRole `solr-operator-zookeeper-operator` | apps/replicasets            | \*    | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                   |
| ClusterRole `solr-operator-zookeeper-operator` | core/events                 | \*    | {{< risk Medium >}}   | {{< tag "ClusterWideAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "OperationalData" >}} {{< tag "Reconnaissance" >}} {{< tag "WildcardPermission" >}}                    |
| ClusterRole `solr-operator-zookeeper-operator` | policy/poddisruptionbudgets | \*    | {{< risk Medium >}}   | {{< tag "AvailabilityImpact" >}} {{< tag "ClusterWideAccess" >}} {{< tag "DenialOfService" >}} {{< tag "Tampering" >}} {{< tag "WildcardPermission" >}}                            |

#### ⚠️ Potential Abuse (30)

The following security risks were found based on the above permissions:

- [Create pods cluster-wide](/rules/1006)
- [Create pods in a namespace](/rules/1007)
- [Update/Patch pods cluster-wide](/rules/1008)
- [Update/Patch pods in a namespace](/rules/1009)
- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Modify secrets cluster-wide](/rules/1012)
- [Modify secrets in a namespace](/rules/1013)
- [Modify node configuration (labels, taints)](/rules/1015)
- [Delete nodes](/rules/1016)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Modify ConfigMaps cluster-wide](/rules/1024)
- [Modify ConfigMaps in a namespace](/rules/1025)
- [Manage Deployments cluster-wide (potential for privileged pod execution)](/rules/1033)
- [Manage Deployments in a namespace (potential for privileged pod execution)](/rules/1034)
- [Manage DaemonSets cluster-wide (runs on all nodes, high impact)](/rules/1035)
- [Manage DaemonSets in a namespace (runs on nodes, high impact)](/rules/1036)
- [Manage StatefulSets cluster-wide](/rules/1037)
- [Manage StatefulSets in a namespace](/rules/1038)
- [Impersonate users, groups, or service accounts (cluster-wide)](/rules/1066)
- [Manage ServiceAccounts cluster-wide](/rules/1067)
- [Manage ServiceAccounts in a namespace](/rules/1068)
- [Read events cluster-wide](/rules/1070)
- [Manage Endpoints or EndpointSlices cluster-wide](/rules/1073)
- [Manage Endpoints or EndpointSlices in a namespace](/rules/1074)
- [Manage Services cluster-wide](/rules/1075)
- [Manage Services in a namespace](/rules/1076)
- [Manage PodDisruptionBudgets cluster-wide](/rules/1079)

#### 📦 Workloads (1)

| Kind       | Name                             | Container                        | Image                             |
| ---------- | -------------------------------- | -------------------------------- | --------------------------------- |
| Deployment | solr-operator-zookeeper-operator | solr-operator-zookeeper-operator | pravega/zookeeper-operator:0.2.15 |

---

### 🤖 `solr-operator-zookeeper-operator-pre-delete` {#sa-solr-operator-zookeeper-operator-pre-delete}

**Namespace:** `default`  |  **Automount:** ❌

#### 🔑 Permissions (1)

| Role                                                      | Resource                | Verbs      | Risk              | Tags                                                             |
| --------------------------------------------------------- | ----------------------- | ---------- | ----------------- | ---------------------------------------------------------------- |
| ClusterRole `solr-operator-zookeeper-operator-pre-delete` | zookeeper.pravega.io/\* | get · list | {{< risk High >}} | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}} |

#### ⚠️ Potential Abuse (1)

The following security risks were found based on the above permissions:

#### 📦 Workloads (1)

| Kind | Name                                        | Container      | Image                              |
| ---- | ------------------------------------------- | -------------- | ---------------------------------- |
| Job  | solr-operator-zookeeper-operator-pre-delete | pre-delete-job | lachlanevenson/k8s-kubectl:v1.23.2 |

---

### 🤖 `solr-operator-zookeeper-operator-post-install-upgrade` {#sa-solr-operator-zookeeper-operator-post-install-upgrade}

**Namespace:** `default`  |  **Automount:** ❌

#### 🔑 Permissions (2)

| Role                                                         | Resource                | Verbs | Risk                | Tags                                                                                            |
| ------------------------------------------------------------ | ----------------------- | ----- | ------------------- | ----------------------------------------------------------------------------------------------- |
| Role `solr-operator-zookeeper-operator-post-install-upgrade` | zookeeper.pravega.io/\* | get   | {{< risk Medium >}} | {{< tag "NamespaceAdmin" >}} {{< tag "NamespaceWideAccess" >}} {{< tag "WildcardPermission" >}} |
| Role `solr-operator-zookeeper-operator-post-install-upgrade` | extensions/deployments  | get   | {{< risk Low >}}    |                                                                                                 |

#### ⚠️ Potential Abuse (2)

The following security risks were found based on the above permissions:

#### 📦 Workloads (1)

| Kind | Name                                                  | Container                | Image                              |
| ---- | ----------------------------------------------------- | ------------------------ | ---------------------------------- |
| Job  | solr-operator-zookeeper-operator-post-install-upgrade | post-install-upgrade-job | lachlanevenson/k8s-kubectl:v1.23.2 |

---
