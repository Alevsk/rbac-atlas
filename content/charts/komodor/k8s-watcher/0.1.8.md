---
title: "k8s-watcher"
description: "Watches and send kubernetes resource-related events"
version: v0.1.8
version_order: f0000f0001f0008
date: ""
service_accounts: 1
workloads: 1
bindings: 18
critical_findings: 1
high_findings: 1
medium_findings: 2
low_findings: 14
categories: []
tags:
  [
    ClusterStructure,
    ClusterWideSecretAccess,
    ConfigMapAccess,
    CredentialAccess,
    DataExposure,
    InformationDisclosure,
    OperationalData,
    RBACQuery,
    Reconnaissance,
    SecretAccess,
    letter-K,
  ]
---

## Description

Watches and send kubernetes resource-related events

## Overview

| Identity                         | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| -------------------------------- | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`k8s-watcher`](#sa-k8s-watcher) | komodor   | âŒ        | â€”       | 18          | 1         | {{< risk "Critical" >}} |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### ğŸ¤– `k8s-watcher` {#sa-k8s-watcher}

**Namespace:** `komodor` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (18)

| Role                      | Resource                               | Verbs              | Risk                  | Tags                                                                                                                                                           |
| ------------------------- | -------------------------------------- | ------------------ | --------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `k8s-watcher` | core/secrets                           | get Â· list Â· watch | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}} |
| ClusterRole `k8s-watcher` | core/configmaps                        | get Â· list Â· watch | {{< risk High >}}     | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}}                                                                   |
| ClusterRole `k8s-watcher` | rbac.authorization.k8s.io/clusterroles | get Â· list Â· watch | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}} {{< tag "Reconnaissance" >}}                                                                       |
| ClusterRole `k8s-watcher` | core/events                            | get Â· list Â· watch | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "OperationalData" >}} {{< tag "Reconnaissance" >}}                                                                 |
| ClusterRole `k8s-watcher` | rbac/clusterroles                      | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `k8s-watcher` | apps/daemonsets                        | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `k8s-watcher` | apps/deployments                       | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `k8s-watcher` | extensions/ingresses                   | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `k8s-watcher` | batch/jobs                             | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `k8s-watcher` | core/namespaces                        | get Â· list Â· watch | {{< risk Low >}}      | {{< tag "ClusterStructure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}}                                                                |
| ClusterRole `k8s-watcher` | core/nodes                             | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `k8s-watcher` | core/persistentvolumeclaims            | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `k8s-watcher` | core/persistentvolumes                 | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `k8s-watcher` | core/pods                              | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `k8s-watcher` | apps/replicasets                       | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `k8s-watcher` | core/replicationcontrollers            | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `k8s-watcher` | core/serviceaccounts                   | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |
| ClusterRole `k8s-watcher` | core/services                          | get Â· list Â· watch | {{< risk Low >}}      |                                                                                                                                                                |

#### âš ï¸ Potential Abuse (8)

The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Read events cluster-wide](/rules/1070)
- [Read RBAC configuration cluster-wide](/rules/1077)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)

#### ğŸ“¦ Workloads (1)

| Kind       | Name        | Container   | Image                        |
| ---------- | ----------- | ----------- | ---------------------------- |
| Deployment | k8s-watcher | k8s-watcher | komodorio/k8s-watcher:latest |

---
