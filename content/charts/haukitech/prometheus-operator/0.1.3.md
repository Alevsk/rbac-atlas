---
title: "prometheus-operator"
description: "Prometheus operator"
version: v0.1.3
version_order: f0000f0001f0003
date: ""
service_accounts: 1
workloads: 1
bindings: 32
critical_findings: 3
high_findings: 18
medium_findings: 2
low_findings: 9
categories: []
tags:
  [
    ClusterStructure,
    ClusterWideAccess,
    ClusterWideSecretAccess,
    ConfigMapAccess,
    CredentialAccess,
    DataExposure,
    InformationDisclosure,
    Persistence,
    PotentialPrivilegeEscalation,
    PrivilegeEscalation,
    RBACQuery,
    Reconnaissance,
    SecretAccess,
    Tampering,
    WildcardPermission,
    WorkloadLifecycle,
    letter-P,
  ]
---

## Description

Prometheus operator

## Overview

| Identity                                         | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| ------------------------------------------------ | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`prometheus-operator`](#sa-prometheus-operator) | default   | ‚ùå        | ‚Äî       | 32          | 1         | {{< risk "Critical" >}} |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### ü§ñ `prometheus-operator` {#sa-prometheus-operator}

**Namespace:** `default` ¬†|¬† **Automount:** ‚ùå

#### üîë Permissions (32)

| Role                              | Resource                                          | Verbs                          | Risk                  | Tags                                                                                                                                                                              |
| --------------------------------- | ------------------------------------------------- | ------------------------------ | --------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `prometheus-operator` | core/configmaps                                   | \*                             | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} (+2 more) |
| ClusterRole `prometheus-operator` | core/secrets                                      | \*                             | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} (+6 more)     |
| ClusterRole `prometheus-operator` | apps/statefulsets                                 | \*                             | {{< risk Critical >}} | {{< tag "ClusterWideAccess" >}} {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} (+2 more)          |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/alertmanagerconfigs         | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/alertmanagers               | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/alertmanagers/finalizers    | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/alertmanagers/status        | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/podmonitors                 | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/probes                      | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/prometheusagents            | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/prometheusagents/finalizers | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/prometheusagents/status     | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/prometheuses                | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/prometheuses/finalizers     | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/prometheuses/status         | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/prometheusrules             | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/scrapeconfigs               | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/servicemonitors             | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/thanosrulers                | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/thanosrulers/finalizers     | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | monitoring.coreos.com/thanosrulers/status         | \*                             | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                                  |
| ClusterRole `prometheus-operator` | authorization.k8s.io/subjectaccessreviews         | create                         | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                                                                                       |
| ClusterRole `prometheus-operator` | authentication.k8s.io/tokenreviews                | create                         | {{< risk Medium >}}   | {{< tag "CredentialAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                                                        |
| ClusterRole `prometheus-operator` | core/endpoints                                    | create ¬∑ delete ¬∑ get ¬∑ update | {{< risk Low >}}      |                                                                                                                                                                                   |
| ClusterRole `prometheus-operator` | core/events                                       | create ¬∑ patch                 | {{< risk Low >}}      |                                                                                                                                                                                   |
| ClusterRole `prometheus-operator` | networking.k8s.io/ingresses                       | get ¬∑ list ¬∑ watch             | {{< risk Low >}}      |                                                                                                                                                                                   |
| ClusterRole `prometheus-operator` | core/namespaces                                   | get ¬∑ list ¬∑ watch             | {{< risk Low >}}      | {{< tag "ClusterStructure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}}                                                                                   |
| ClusterRole `prometheus-operator` | core/nodes                                        | list ¬∑ watch                   | {{< risk Low >}}      |                                                                                                                                                                                   |
| ClusterRole `prometheus-operator` | core/pods                                         | delete ¬∑ list                  | {{< risk Low >}}      |                                                                                                                                                                                   |
| ClusterRole `prometheus-operator` | core/services                                     | create ¬∑ delete ¬∑ get ¬∑ update | {{< risk Low >}}      |                                                                                                                                                                                   |
| ClusterRole `prometheus-operator` | core/services/finalizers                          | create ¬∑ delete ¬∑ get ¬∑ update | {{< risk Low >}}      |                                                                                                                                                                                   |
| ClusterRole `prometheus-operator` | storage.k8s.io/storageclasses                     | get                            | {{< risk Low >}}      |                                                                                                                                                                                   |

#### ‚ö†Ô∏è Potential Abuse (15)

The following security risks were found based on the above permissions:

- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Modify secrets cluster-wide](/rules/1012)
- [Modify secrets in a namespace](/rules/1013)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Modify ConfigMaps cluster-wide](/rules/1024)
- [Modify ConfigMaps in a namespace](/rules/1025)
- [Manage StatefulSets cluster-wide](/rules/1037)
- [Manage StatefulSets in a namespace](/rules/1038)
- [Create TokenReviews (validate arbitrary tokens)](/rules/1049)
- [Create SubjectAccessReviews (check arbitrary permissions)](/rules/1050)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)

#### üì¶ Workloads (1)

| Kind       | Name                | Container           | Image                                                   |
| ---------- | ------------------- | ------------------- | ------------------------------------------------------- |
| Deployment | prometheus-operator | prometheus-operator | quay.io/prometheus-operator/prometheus-operator:v0.77.1 |

---
