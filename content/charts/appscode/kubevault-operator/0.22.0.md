---
title: "kubevault-operator"
description: "KubeVault Operator by AppsCode - HashiCorp Vault operator for Kubernetes"
version: v0.22.0
version_order: f0000f0016f0000
date: ""
service_accounts: 1
workloads: 1
bindings: 34
critical_findings: 7
high_findings: 11
medium_findings: 2
low_findings: 14
categories: []
tags:
  [
    BindingToPrivilegedRole,
    CRDManipulation,
    CertificateManagement,
    ClusterAdminAccess,
    ClusterWideAccess,
    ClusterWidePodExec,
    ClusterWideSecretAccess,
    CodeExecution,
    ConfigMapAccess,
    CredentialAccess,
    DataExposure,
    ElevationOfPrivilege,
    InformationDisclosure,
    LateralMovement,
    Persistence,
    PodExec,
    PotentialPrivilegeEscalation,
    PrivilegeEscalation,
    RBACManipulation,
    RBACQuery,
    SecretAccess,
    Spoofing,
    Tampering,
    WildcardPermission,
    WorkloadExecution,
    letter-K,
  ]
---

## Description

KubeVault Operator by AppsCode - HashiCorp Vault operator for Kubernetes

- https://github.com/kubevault

## Overview

| Identity                                       | Namespace | Automount | Secrets | Permissions | Workloads | Risk                    |
| ---------------------------------------------- | --------- | --------- | ------- | ----------- | --------- | ----------------------- |
| [`kubevault-operator`](#sa-kubevault-operator) | default   | ❌        | —       | 34          | 1         | {{< risk "Critical" >}} |

> _Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount._

---

## Identities

### 🤖 `kubevault-operator` {#sa-kubevault-operator}

**Namespace:** `default`  |  **Automount:** ❌

#### 🔑 Permissions (34)

| Role                             | Resource                                       | Verbs                                                   | Risk                  | Tags                                                                                                                                                                 |
| -------------------------------- | ---------------------------------------------- | ------------------------------------------------------- | --------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ClusterRole `kubevault-operator` | cert-manager.io/\*                             | \*                                                      | {{< risk Critical >}} | {{< tag "CertificateManagement" >}} {{< tag "ClusterWideAccess" >}} {{< tag "ElevationOfPrivilege" >}} {{< tag "Spoofing" >}} {{< tag "Tampering" >}} (+1 more)      |
| ClusterRole `kubevault-operator` | rbac.authorization.k8s.io/clusterrolebindings  | create · delete · get · patch · update                  | {{< risk Critical >}} | {{< tag "BindingToPrivilegedRole" >}} {{< tag "ClusterAdminAccess" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}}                              |
| ClusterRole `kubevault-operator` | rbac.authorization.k8s.io/clusterroles         | create · delete · get · patch · update                  | {{< risk Critical >}} | {{< tag "ClusterAdminAccess" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}}                                                                    |
| ClusterRole `kubevault-operator` | apiextensions.k8s.io/customresourcedefinitions | \*                                                      | {{< risk Critical >}} | {{< tag "CRDManipulation" >}} {{< tag "ClusterWideAccess" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WildcardPermission" >}}    |
| ClusterRole `kubevault-operator` | core/pods                                      | create · get · list                                     | {{< risk Critical >}} | {{< tag "LateralMovement" >}} {{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "WorkloadExecution" >}} |
| ClusterRole `kubevault-operator` | core/pods/exec                                 | create · get · list                                     | {{< risk Critical >}} | {{< tag "ClusterWidePodExec" >}} {{< tag "CodeExecution" >}} {{< tag "ElevationOfPrivilege" >}} {{< tag "LateralMovement" >}} {{< tag "PodExec" >}} (+1 more)        |
| ClusterRole `kubevault-operator` | core/secrets                                   | create · delete · get · list · patch · watch            | {{< risk Critical >}} | {{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}}       |
| ClusterRole `kubevault-operator` | appcatalog.appscode.com/\*                     | \*                                                      | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                     |
| ClusterRole `kubevault-operator` | catalog.kubevault.com/\*                       | \*                                                      | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                     |
| ClusterRole `kubevault-operator` | engine.kubevault.com/\*                        | \*                                                      | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                     |
| ClusterRole `kubevault-operator` | kubevault.com/\*                               | \*                                                      | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                     |
| ClusterRole `kubevault-operator` | ops.kubevault.com/\*                           | \*                                                      | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                     |
| ClusterRole `kubevault-operator` | policy.kubevault.com/\*                        | \*                                                      | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                     |
| ClusterRole `kubevault-operator` | supervisor.appscode.com/\*                     | create · get · list · patch · update · watch            | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                     |
| ClusterRole `kubevault-operator` | core/configmaps                                | create · get · list · patch · watch                     | {{< risk High >}}     | {{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}}                                                                         |
| ClusterRole `kubevault-operator` | rbac.authorization.k8s.io/rolebindings         | create · delete · get · patch · update                  | {{< risk High >}}     | {{< tag "BindingToPrivilegedRole" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}}                                                               |
| ClusterRole `kubevault-operator` | rbac.authorization.k8s.io/roles                | create · delete · get · patch · update                  | {{< risk High >}}     | {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}}                                                                                                     |
| ClusterRole `kubevault-operator` | monitoring.coreos.com/servicemonitors          | \*                                                      | {{< risk High >}}     | {{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}                                                                                                     |
| ClusterRole `kubevault-operator` | authorization.k8s.io/subjectaccessreviews      | create                                                  | {{< risk Medium >}}   | {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                                                                          |
| ClusterRole `kubevault-operator` | authentication.k8s.io/tokenreviews             | create                                                  | {{< risk Medium >}}   | {{< tag "CredentialAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "RBACQuery" >}}                                                                           |
| ClusterRole `kubevault-operator` | apiregistration.k8s.io/apiservices             | get                                                     | {{< risk Low >}}      |                                                                                                                                                                      |
| ClusterRole `kubevault-operator` | core/events                                    | create                                                  | {{< risk Low >}}      |                                                                                                                                                                      |
| ClusterRole `kubevault-operator` | core/namespaces                                | get · list                                              | {{< risk Low >}}      |                                                                                                                                                                      |
| ClusterRole `kubevault-operator` | core/nodes                                     | get · list · watch                                      | {{< risk Low >}}      |                                                                                                                                                                      |
| ClusterRole `kubevault-operator` | core/persistentvolumeclaims                    | create · get · list · patch                             | {{< risk Low >}}      |                                                                                                                                                                      |
| ClusterRole `kubevault-operator` | policy/poddisruptionbudgets                    | create · delete · deletecollection · get · list · patch | {{< risk Low >}}      |                                                                                                                                                                      |
| ClusterRole `kubevault-operator` | core/pods/eviction                             | create · get · list                                     | {{< risk Low >}}      |                                                                                                                                                                      |
| ClusterRole `kubevault-operator` | core/serviceaccounts                           | create · get · patch                                    | {{< risk Low >}}      |                                                                                                                                                                      |
| ClusterRole `kubevault-operator` | core/serviceaccounts/finalizers                | update                                                  | {{< risk Low >}}      |                                                                                                                                                                      |
| ClusterRole `kubevault-operator` | core/services                                  | create · delete · get · list · patch · watch            | {{< risk Low >}}      |                                                                                                                                                                      |
| ClusterRole `kubevault-operator` | core/services/finalizers                       | update                                                  | {{< risk Low >}}      |                                                                                                                                                                      |
| ClusterRole `kubevault-operator` | apps/statefulsets                              | create · delete · get · list · patch · watch            | {{< risk Low >}}      |                                                                                                                                                                      |
| ClusterRole `kubevault-operator` | apps/statefulsets/finalizers                   | update                                                  | {{< risk Low >}}      |                                                                                                                                                                      |
| ClusterRole `kubevault-operator` | kubevault.com/vaultservers/finalizers          | update                                                  | {{< risk Low >}}      |                                                                                                                                                                      |

#### ⚠️ Potential Abuse (18)

The following security risks were found based on the above permissions:

- [Cluster-wide pod exec](/rules/1000)
- [Namespaced pod exec](/rules/1001)
- [Create pods cluster-wide](/rules/1006)
- [Create pods in a namespace](/rules/1007)
- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Read ConfigMaps cluster-wide](/rules/1022)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Manage ClusterRoles (create, update, patch, delete)](/rules/1027)
- [Manage ClusterRoleBindings (create, update, patch, delete)](/rules/1028)
- [Manage Roles in a namespace (create, update, patch, delete)](/rules/1029)
- [Manage RoleBindings in a namespace (create, update, patch, delete)](/rules/1030)
- [Manage CustomResourceDefinitions](/rules/1045)
- [Create TokenReviews (validate arbitrary tokens)](/rules/1049)
- [Create SubjectAccessReviews (check arbitrary permissions)](/rules/1050)
- [Manage ClusterIssuers (cert-manager.io)](/rules/1062)

#### 📦 Workloads (1)

| Kind       | Name               | Container | Image                                    |
| ---------- | ------------------ | --------- | ---------------------------------------- |
| Deployment | kubevault-operator | operator  | ghcr.io/kubevault/vault-operator:v0.22.0 |

---
