---
title: "kubestash-operator"
description: "KubeStash, Kubernetes native backup operator by AppsCode"
version: v0.24.0
version_order: f0000f0018f0000
date: ""
service_accounts: 2
workloads: 2
bindings: 50
critical_findings: 9
high_findings: 15
medium_findings: 0
low_findings: 26
categories: []
tags: [BindingToPrivilegedRole, ClusterAdminAccess, ClusterStructure, ClusterWideAccess, ClusterWidePodExec, ClusterWideSecretAccess, CodeExecution, ConfigMapAccess, ControlPlaneDisruption, CredentialAccess, CriticalNamespace, DataExposure, DenialOfService, ElevationOfPrivilege, IdentityManagement, InformationDisclosure, LateralMovement, Persistence, PodExec, PotentialPrivilegeEscalation, PrivilegeEscalation, RBACManipulation, RBACQuery, Reconnaissance, ResourceNameRestricted, SecretAccess, Tampering, WebhookManipulation, WebhookReconnaissance, WildcardPermission, WorkloadLifecycle, letter-K]
---
## Description

KubeStash, Kubernetes native backup operator by AppsCode

- https://github.com/stashed

## Overview

|Identity|Namespace|Automount|Secrets|Permissions|Workloads|Risk|
|---|---|---|---|---|---|---|
|[`kubestash-operator`](#sa-kubestash-operator)|default|âŒ|â€”|44|2|{{< risk "Critical" >}}|
|[`kubestash-operator-cleaner`](#sa-kubestash-operator-cleaner)|default|âŒ|â€”|6|1|{{< risk "High" >}}|


> *Numbers in the last two columns indicate how many bindings or workloads involve each ServiceAccount.*

---

## Identities

### ğŸ¤– `kubestash-operator` {#sa-kubestash-operator}
 **Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (44)
|Role|Resource|Verbs|Risk|Tags|
|---|---|---|---|---|
|ClusterRole `kubestash-operator`|rbac.authorization.k8s.io/clusterrolebindings|create Â· delete Â· get Â· list Â· patch Â· update Â· watch|{{< risk Critical >}}|{{< tag "BindingToPrivilegedRole" >}} {{< tag "ClusterAdminAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}} (+2 more)|
|ClusterRole `kubestash-operator`|rbac.authorization.k8s.io/clusterroles|create Â· delete Â· get Â· list Â· patch Â· update Â· watch|{{< risk Critical >}}|{{< tag "ClusterAdminAccess" >}} {{< tag "InformationDisclosure" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}} {{< tag "RBACQuery" >}} (+1 more)|
|ClusterRole `kubestash-operator`|batch/cronjobs|create Â· delete Â· get Â· list Â· patch Â· update Â· watch|{{< risk Critical >}}|{{< tag "Persistence" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}|
|ClusterRole `kubestash-operator`|batch/jobs|create Â· delete Â· get Â· list Â· patch Â· update Â· watch|{{< risk Critical >}}|{{< tag "PotentialPrivilegeEscalation" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Tampering" >}} {{< tag "WorkloadLifecycle" >}}|
|Role `kubestash-operator-leader-election`|coordination.k8s.io/leases|create Â· delete Â· get Â· list Â· patch Â· update Â· watch|{{< risk Critical >}}|{{< tag "ControlPlaneDisruption" >}} {{< tag "CriticalNamespace" >}} {{< tag "DenialOfService" >}} {{< tag "Tampering" >}}|
|ClusterRole `kubestash-operator`|admissionregistration.k8s.io/mutatingwebhookconfigurations|*|{{< risk Critical >}}|{{< tag "ClusterWideAccess" >}} {{< tag "DenialOfService" >}} {{< tag "InformationDisclosure" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "Reconnaissance" >}} (+4 more)|
|ClusterRole `kubestash-operator`|core/pods/exec|create|{{< risk Critical >}}|{{< tag "ClusterWidePodExec" >}} {{< tag "CodeExecution" >}} {{< tag "ElevationOfPrivilege" >}} {{< tag "LateralMovement" >}} {{< tag "PodExec" >}} (+1 more)|
|ClusterRole `kubestash-operator`|core/secrets|create Â· delete Â· get Â· list Â· patch Â· watch|{{< risk Critical >}}|{{< tag "ClusterWideSecretAccess" >}} {{< tag "CredentialAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "SecretAccess" >}}|
|ClusterRole `kubestash-operator`|admissionregistration.k8s.io/validatingwebhookconfigurations|*|{{< risk Critical >}}|{{< tag "ClusterWideAccess" >}} {{< tag "DenialOfService" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}} {{< tag "Tampering" >}} (+3 more)|
|ClusterRole `kubestash-operator`|addons.kubestash.com/*|*|{{< risk High >}}|{{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}|
|ClusterRole `kubestash-operator`|appcatalog.appscode.com/*|get Â· list Â· watch|{{< risk High >}}|{{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}|
|ClusterRole `kubestash-operator`|archiver.kubedb.com/*|create Â· get|{{< risk High >}}|{{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}|
|ClusterRole `kubestash-operator`|config.kubestash.com/*|*|{{< risk High >}}|{{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}|
|ClusterRole `kubestash-operator`|core.kubestash.com/*|*|{{< risk High >}}|{{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}|
|ClusterRole `kubestash-operator`|kubedb.com/*|*|{{< risk High >}}|{{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}|
|ClusterRole `kubestash-operator`|snapshot.storage.k8s.io/*|*|{{< risk High >}}|{{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}|
|ClusterRole `kubestash-operator`|storage.kubestash.com/*|*|{{< risk High >}}|{{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}|
|Role `kubestash-operator-leader-election`|core/configmaps|create Â· delete Â· get Â· list Â· patch Â· update Â· watch|{{< risk High >}}|{{< tag "ConfigMapAccess" >}} {{< tag "DataExposure" >}} {{< tag "InformationDisclosure" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}|
|ClusterRole `kubestash-operator`|rbac.authorization.k8s.io/rolebindings|create Â· delete Â· get Â· list Â· patch Â· update Â· watch|{{< risk High >}}|{{< tag "BindingToPrivilegedRole" >}} {{< tag "InformationDisclosure" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}} {{< tag "RBACQuery" >}} (+1 more)|
|ClusterRole `kubestash-operator`|rbac.authorization.k8s.io/roles|create Â· delete Â· get Â· list Â· patch Â· update Â· watch|{{< risk High >}}|{{< tag "InformationDisclosure" >}} {{< tag "PrivilegeEscalation" >}} {{< tag "RBACManipulation" >}} {{< tag "RBACQuery" >}} {{< tag "Reconnaissance" >}}|
|ClusterRole `kubestash-operator`|core/serviceaccounts|create Â· delete Â· get Â· list Â· patch Â· update Â· watch|{{< risk High >}}|{{< tag "IdentityManagement" >}} {{< tag "PotentialPrivilegeEscalation" >}} {{< tag "Tampering" >}}|
|ClusterRole `kubestash-operator`|appcatalog.appscode.com/appbindings|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|cert-manager.io/certificates|create Â· get|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|core/configmaps|create Â· get|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|apiextensions.k8s.io/customresourcedefinitions|create Â· get Â· patch Â· update|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|apps/daemonsets|create Â· get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|apps/deployments|create Â· get Â· list Â· patch Â· update Â· watch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|elasticsearch.kubedb.com/elasticsearchdashboards|list|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|catalog.kubedb.com/elasticsearchs|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|core/endpoints|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|core/events|create|{{< risk Low >}}||
|Role `kubestash-operator-leader-election`|core/events|create Â· patch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|core/namespaces|get Â· list Â· watch|{{< risk Low >}}|{{< tag "ClusterStructure" >}} {{< tag "InformationDisclosure" >}} {{< tag "Reconnaissance" >}}|
|ClusterRole `kubestash-operator`|core/nodes|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|batch.k8s.appscode.com/pendingtasks|create Â· get Â· list Â· patch Â· watch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|core/persistentvolumeclaims|create Â· delete Â· get Â· list Â· patch Â· update Â· watch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|core/persistentvolumes|create Â· delete Â· get Â· list Â· patch Â· update Â· watch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|core/pods|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|apps/replicasets|create Â· get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|core/services|create Â· get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|apps/statefulsets|create Â· get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|storage.k8s.io/storageclasses|get Â· list Â· watch|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|snapshot.storage.k8s.io/volumesnapshots|delete Â· get|{{< risk Low >}}||
|ClusterRole `kubestash-operator`|cluster.open-cluster-management.io/clusterclaims **(restricted to: features.ace.info)**|get|{{< risk Low >}}|{{< tag "ResourceNameRestricted" >}}|

#### âš ï¸ Potential Abuse (25)
The following security risks were found based on the above permissions:

- [Cluster-wide pod exec](/rules/1000)
- [Namespaced pod exec](/rules/1001)
- [Read secrets cluster-wide](/rules/1010)
- [Read secrets in a namespace](/rules/1011)
- [Read ConfigMaps in a namespace](/rules/1023)
- [Modify ConfigMaps in a namespace](/rules/1025)
- [Manage ClusterRoles (create, update, patch, delete)](/rules/1027)
- [Manage ClusterRoleBindings (create, update, patch, delete)](/rules/1028)
- [Manage Roles in a namespace (create, update, patch, delete)](/rules/1029)
- [Manage RoleBindings in a namespace (create, update, patch, delete)](/rules/1030)
- [Manage CronJobs cluster-wide (scheduled privileged execution, persistence)](/rules/1039)
- [Manage CronJobs in a namespace (scheduled privileged execution, persistence)](/rules/1040)
- [Manage Jobs cluster-wide (one-off privileged execution)](/rules/1041)
- [Manage Jobs in a namespace (one-off privileged execution)](/rules/1042)
- [Manage MutatingWebhookConfigurations](/rules/1043)
- [Manage ValidatingWebhookConfigurations](/rules/1044)
- [Manage ServiceAccounts cluster-wide](/rules/1067)
- [Manage ServiceAccounts in a namespace](/rules/1068)
- [Read RBAC configuration cluster-wide](/rules/1077)
- [Manage Leases in kube-system or kube-node-lease namespace](/rules/1081)
- [List Namespaces (Cluster Reconnaissance)](/rules/1082)
- [List ValidatingWebhookConfigurations (Reconnaissance)](/rules/1083)
- [List MutatingWebhookConfigurations (Reconnaissance)](/rules/1084)

#### ğŸ“¦ Workloads (2)
|Kind|Name|Container|Image|
|---|---|---|---|
|Deployment|kubestash-operator-operator|operator|ghcr.io/kubestash/kubestash:v0.24.0|
|Deployment|kubestash-operator-webhook-server|webhook-server|ghcr.io/kubestash/kubestash:v0.24.0|

---

### ğŸ¤– `kubestash-operator-cleaner` {#sa-kubestash-operator-cleaner}
 **Namespace:** `default` Â |Â  **Automount:** âŒ

#### ğŸ”‘ Permissions (6)
|Role|Resource|Verbs|Risk|Tags|
|---|---|---|---|---|
|ClusterRole `kubestash-operator-cleaner`|addons.kubestash.com/*|delete|{{< risk High >}}|{{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}|
|ClusterRole `kubestash-operator-cleaner`|core.kubestash.com/*|delete|{{< risk High >}}|{{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}|
|ClusterRole `kubestash-operator-cleaner`|storage.kubestash.com/*|delete|{{< risk High >}}|{{< tag "ClusterWideAccess" >}} {{< tag "WildcardPermission" >}}|
|ClusterRole `kubestash-operator-cleaner`|batch/jobs|delete|{{< risk Low >}}||
|ClusterRole `kubestash-operator-cleaner`|admissionregistration.k8s.io/mutatingwebhookconfigurations|delete|{{< risk Low >}}||
|ClusterRole `kubestash-operator-cleaner`|admissionregistration.k8s.io/validatingwebhookconfigurations|delete|{{< risk Low >}}||

#### âš ï¸ Potential Abuse (2)
The following security risks were found based on the above permissions:


#### ğŸ“¦ Workloads (1)
|Kind|Name|Container|Image|
|---|---|---|---|
|Job|kubestash-operator-cleaner|busybox|ghcr.io/appscode/kubectl-nonroot:1.34|

---

